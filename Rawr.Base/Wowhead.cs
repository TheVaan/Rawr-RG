using System;
using System.Collections.Generic;
using System.Text;
using System.Xml;
using System.Text.RegularExpressions;
using Newtonsoft.Json.Linq;

namespace Rawr
{
    public static class Wowhead
    {
        //32824,Tigole's Trashbringer,6,"id:32824,name:'1Tigole\'s Trashbringer',level:1,reqlevel:1,dps:9.0,speed:3.00,slot:17,classs:2,subclass:8","slotbak:17,displayid:23875,reqlevel:1,maxcount:1,dmgmin1:24,dmgmax1:30,dmgtype1:0,speed:3.00,dps:9.0"
        public static void ProcessFile()
        {
            if (System.IO.File.Exists("C:\\wotlkitems.csv"))
            {
                //if (false) //Break point here, step into it if you want to import the data
                {
                    string[] lines = System.IO.File.ReadAllLines("C:\\wotlkitems.csv");
                    List<Item> items = new List<Item>();
                    foreach (string line in lines)
                        if (line != lines[0])
                        {
                            Item item = GetItem(line.Split(',')[0], true);
                            //Item item = ProcessItem(line);
                            if (item != null)
                            {
                                items.Add(item);
                                ItemCache.AddItem(item, false);
                            }
                        }

                    ItemCache.OnItemsChanged();
                }
            }
        }

        public static void LoadKnownWotlkItems()
        {
            int[] knownIds = new int[] { /* Filtered Items: */
                /* Metagems: */ 41380, 41389, 41395, 41285, 41307, 41377, 41333, 41335, 44081, 41396, 41378, 44084, 41379, 44082, 41401, 41385, 44087, 41381, 44088, 41397, 41398, 41376, 41339, 44076, 41400, 41375, 44078, 44089, 41382,
                /* Gems: */ 36766, 36767, 42142, 42143, 42144, 42145, 42146, 42148, 42149, 42150, 42151, 42152, 42153, 42154, 42155, 42156, 42157, 42158, 40119, 40120, 40121, 40122, 40008, 40009, 40010, 40011, 40164, 40165, 40166, 40167, 40168, 40169, 40170, 40171, 40172, 40173, 40174, 40175, 40176, 40177, 40178, 40179, 40180, 40181, 40182, 40085, 40086, 40088, 40089, 40090, 40091, 40092, 40094, 40095, 40096, 40098, 40099, 40100, 40101, 40102, 40103, 40104, 40105, 40106, 40142, 40143, 40144, 40145, 40146, 40147, 40148, 40149, 40150, 40151, 40152, 40153, 40154, 40155, 40156, 40157, 40158, 40159, 40160, 40161, 40162, 40163, 40037, 40038, 40039, 40040, 40041, 40043, 40044, 40045, 40046, 40047, 40048, 40049, 40050, 40051, 40052, 40053, 40054, 40055, 40056, 40057, 40058, 40059, 34143, 42702, 40129, 40130, 40131, 40132, 40133, 40134, 40135, 40136, 40137, 40138, 40139, 40140, 40141, 40022, 40023, 40024, 40025, 40026, 40027, 40028, 40029, 40030, 40031, 40032, 40033, 40034, 40111, 40112, 40113, 40114, 40115, 40116, 40117, 40118, 39996, 39997, 39998, 39999, 40000, 40001, 40002, 40003, 40123, 40124, 40125, 40126, 40127, 40128, 44066, 40012, 40013, 40014, 40015, 40016, 40017,
                /* Gear: */ 32824, 34138, 34139, 34648, 34649, 34650, 34651, 34652, 34653, 34655, 34656, 34657, 34658, 34659, 34661, 35570, 35571, 35572, 35573, 35574, 35575, 35576, 35577, 35578, 35579, 35580, 35583, 35584, 35585, 35587, 35588, 35589, 35590, 35591, 35592, 35593, 35594, 35595, 35596, 35597, 35598, 35599, 35601, 35602, 35603, 35604, 35605, 35606, 35607, 35608, 35609, 35610, 35611, 35612, 35613, 35614, 35615, 35616, 35617, 35618, 35619, 35620, 35630, 35631, 35632, 35633, 35634, 35635, 35636, 35637, 35638, 35639, 35640, 35641, 35642, 35643, 35644, 35645, 35646, 35647, 35649, 35650, 35651, 35652, 35653, 35654, 35655, 35656, 35657, 35658, 35659, 35660, 35661, 35662, 35663, 35666, 35670, 35672, 35673, 35675, 35676, 35677, 35678, 35679, 35680, 35681, 35682, 35683, 35807, 35808, 35809, 35810, 35811, 35812, 35814, 35815, 35816, 35817, 35818, 35820, 35821, 35822, 35823, 35824, 35826, 35827, 35829, 35830, 35832, 35833, 35834, 35835, 35839, 35841, 35842, 35843, 35844, 35845, 35846, 35848, 35849, 35851, 35852, 35856, 35857, 35858, 35859, 35860, 35861, 35862, 35863, 35864, 35865, 35866, 35867, 35868, 35869, 35870, 35871, 35872, 35873, 35875, 35877, 35878, 35879, 35880, 35881, 35882, 35883, 35884, 35885, 35886, 35887, 35888, 35889, 35890, 35891, 35892, 35893, 35894, 35895, 35896, 35897, 35898, 35899, 35900, 35901, 35902, 35903, 35904, 35905, 35909, 35910, 35911, 35912, 35913, 35914, 35915, 35916, 35917, 35918, 35919, 35920, 35921, 35922, 35923, 35924, 35925, 35926, 35927, 35928, 35929, 35930, 35931, 35932, 35933, 35934, 35935, 35936, 35937, 35938, 36871, 36872, 36874, 36878, 36879, 36880, 36881, 36882, 36883, 36884, 36885, 36886, 36887, 36888, 36937, 36938, 36939, 36943, 36944, 36945, 36946, 36947, 36948, 36949, 36950, 36951, 36952, 36953, 36954, 36961, 36962, 36969, 36971, 36972, 36973, 36974, 36975, 36976, 36977, 36978, 36979, 36980, 36981, 36982, 36983, 36984, 36985, 36986, 36988, 36989, 36991, 36992, 36993, 36994, 36995, 36996, 36997, 36998, 36999, 37000, 37002, 37004, 37005, 37007, 37008, 37009, 37014, 37015, 37016, 37017, 37018, 37019, 37022, 37023, 37024, 37025, 37026, 37028, 37029, 37030, 37031, 37032, 37033, 37034, 37036, 37037, 37038, 37039, 37040, 37041, 37042, 37043, 37044, 37046, 37047, 37048, 37049, 37050, 37051, 37052, 37053, 37054, 37055, 37056, 37057, 37058, 37060, 37061, 37062, 37064, 37065, 37066, 37067, 37068, 37069, 37070, 37072, 37073, 37074, 37075, 37076, 37077, 37078, 37079, 37080, 37081, 37082, 37083, 37084, 37086, 37088, 37095, 37096, 37099, 37105, 37106, 37107, 37108, 37109, 37110, 37111, 37112, 37113, 37114, 37115, 37116, 37117, 37122, 37134, 37135, 37138, 37139, 37141, 37144, 37149, 37150, 37151, 37152, 37153, 37155, 37162, 37165, 37166, 37167, 37169, 37170, 37171, 37172, 37177, 37178, 37179, 37180, 37181, 37182, 37183, 37184, 37186, 37188, 37189, 37190, 37191, 37192, 37193, 37194, 37195, 37196, 37197, 37203, 37204, 37205, 37206, 37207, 37208, 37209, 37210, 37211, 37212, 37213, 37214, 37215, 37216, 37217, 37218, 37219, 37220, 37221, 37222, 37223, 37224, 37225, 37226, 37227, 37228, 37230, 37231, 37232, 37234, 37235, 37236, 37237, 37238, 37239, 37240, 37241, 37242, 37243, 37254, 37255, 37256, 37257, 37258, 37260, 37261, 37262, 37263, 37264, 37270, 37271, 37272, 37273, 37274, 37275, 37276, 37277, 37280, 37282, 37283, 37288, 37289, 37290, 37291, 37292, 37293, 37294, 37319, 37320, 37322, 37325, 37351, 37352, 37353, 37354, 37355, 37356, 37357, 37360, 37361, 37362, 37363, 37364, 37365, 37366, 37367, 37368, 37369, 37370, 37371, 37373, 37374, 37375, 37376, 37377, 37378, 37379, 37380, 37382, 37383, 37384, 37385, 37386, 37387, 37388, 37389, 37390, 37391, 37392, 37393, 37394, 37395, 37396, 37397, 37398, 37399, 37400, 37401, 37402, 37403, 37404, 37405, 37406, 37407, 37408, 37409, 37410, 37414, 37415, 37417, 37418, 37419, 37420, 37421, 37422, 37423, 37424, 37425, 37426, 37427, 37428, 37429, 37433, 37434, 37435, 37436, 37437, 37439, 37440, 37441, 37442, 37443, 37446, 37447, 37456, 37458, 37461, 37462, 37463, 37471, 37475, 37476, 37478, 37479, 37480, 37481, 37482, 37483, 37484, 37485, 37486, 37487, 37505, 37506, 37507, 37508, 37509, 37510, 37511, 37512, 37513, 37514, 37515, 37516, 37517, 37518, 37519, 37520, 37521, 37522, 37523, 37524, 37525, 37526, 37527, 37528, 37529, 37530, 37535, 37537, 37541, 37543, 37544, 37545, 37546, 37547, 37548, 37555, 37556, 37557, 37558, 37559, 37562, 37564, 37566, 37573, 37587, 37590, 37591, 37592, 37593, 37594, 37595, 37612, 37613, 37614, 37615, 37616, 37617, 37618, 37619, 37620, 37622, 37623, 37624, 37625, 37626, 37627, 37628, 37629, 37630, 37631, 37632, 37633, 37634, 37635, 37636, 37637, 37638, 37639, 37640, 37641, 37642, 37643, 37644, 37645, 37646, 37647, 37648, 37650, 37651, 37652, 37653, 37654, 37655, 37656, 37657, 37658, 37660, 37666, 37667, 37668, 37669, 37670, 37671, 37672, 37673, 37675, 37678, 37679, 37680, 37681, 37682, 37683, 37684, 37685, 37686, 37687, 37688, 37689, 37690, 37691, 37692, 37693, 37694, 37695, 37696, 37712, 37714, 37715, 37717, 37718, 37721, 37722, 37723, 37724, 37725, 37726, 37728, 37729, 37730, 37731, 37732, 37733, 37734, 37735, 37743, 37744, 37745, 37746, 37747, 37748, 37749, 37751, 37752, 37753, 37754, 37755, 37756, 37757, 37758, 37759, 37760, 37761, 37762, 37763, 37764, 37765, 37766, 37767, 37768, 37769, 37770, 37771, 37772, 37773, 37774, 37775, 37776, 37777, 37778, 37779, 37780, 37781, 37782, 37783, 37784, 37785, 37786, 37787, 37788, 37789, 37790, 37791, 37792, 37793, 37794, 37795, 37796, 37797, 37798, 37799, 37800, 37801, 37802, 37803, 37804, 37805, 37806, 37807, 37808, 37809, 37810, 37811, 37812, 37813, 37814, 37817, 37818, 37819, 37820, 37821, 37822, 37823, 37824, 37825, 37826, 37835, 37840, 37841, 37842, 37843, 37844, 37845, 37846, 37847, 37848, 37849, 37850, 37851, 37852, 37853, 37854, 37855, 37856, 37857, 37858, 37861, 37862, 37867, 37868, 37869, 37870, 37871, 37872, 37873, 37874, 37875, 37876, 37883, 37884, 37886, 37889, 37890, 37891, 37936, 37937, 37938, 37939, 37940, 37941, 37942, 37943, 37944, 37945, 37947, 37948, 37949, 37950, 37953, 37954, 37955, 37956, 37957, 37958, 37959, 37960, 37961, 37962, 37963, 37964, 37965, 37966, 37967, 37968, 37969, 37970, 37971, 37976, 37980, 37981, 37982, 37983, 37984, 37985, 37986, 37987, 37988, 37989, 37990, 37991, 37992, 37993, 37995, 37996, 37998, 37999, 38000, 38001, 38002, 38003, 38004, 38005, 38006, 38007, 38008, 38010, 38011, 38012, 38013, 38014, 38023, 38024, 38025, 38026, 38027, 38028, 38029, 38030, 38031, 38032, 38033, 38034, 38035, 38036, 38037, 38039, 38040, 38041, 38042, 38043, 38044, 38045, 38046, 38047, 38048, 38049, 38051, 38053, 38054, 38055, 38056, 38057, 38068, 38070, 38071, 38073, 38080, 38084, 38085, 38086, 38087, 38088, 38092, 38093, 38094, 38095, 38096, 38097, 38100, 38101, 38102, 38103, 38104, 38105, 38106, 38107, 38108, 38109, 38110, 38111, 38112, 38114, 38115, 38116, 38117, 38118, 38126, 38127, 38128, 38129, 38130, 38131, 38132, 38133, 38134, 38135, 38137, 38138, 38140, 38141, 38142, 38143, 38146, 38147, 38148, 38150, 38151, 38152, 38153, 38154, 38155, 38156, 38157, 38169, 38170, 38171, 38173, 38174, 38176, 38177, 38178, 38181, 38187, 38188, 38189, 38190, 38191, 38194, 38195, 38196, 38197, 38198, 38202, 38204, 38206, 38207, 38208, 38212, 38213, 38214, 38217, 38218, 38219, 38220, 38221, 38222, 38223, 38224, 38226, 38227, 38228, 38230, 38231, 38232, 38237, 38238, 38239, 38240, 38241, 38242, 38250, 38251, 38252, 38257, 38258, 38259, 38284, 38293, 38322, 38347, 38353, 38354, 38355, 38356, 38357, 38358, 38359, 38360, 38361, 38362, 38363, 38364, 38365, 38366, 38367, 38368, 38399, 38400, 38401, 38402, 38403, 38404, 38405, 38406, 38407, 38408, 38409, 38410, 38411, 38412, 38413, 38414, 38415, 38416, 38417, 38418, 38419, 38420, 38421, 38422, 38424, 38433, 38434, 38435, 38436, 38437, 38438, 38439, 38440, 38441, 38452, 38453, 38454, 38455, 38456, 38457, 38458, 38459, 38460, 38461, 38462, 38463, 38464, 38465, 38513, 38528, 38529, 38530, 38531, 38532, 38533, 38534, 38535, 38536, 38537, 38540, 38541, 38542, 38543, 38588, 38589, 38590, 38591, 38592, 38611, 38613, 38614, 38615, 38616, 38617, 38618, 38632, 38633, 38661, 38662, 38663, 38664, 38665, 38666, 38667, 38668, 38669, 38670, 38671, 38672, 38674, 38675, 38707, 38710, 38711, 38712, 38713, 38714, 38715, 38716, 38717, 38718, 38719, 38726, 38727, 38728, 38729, 38730, 38732, 38733, 38734, 38735, 38736, 38737, 38739, 38741, 38743, 38744, 38745, 38746, 38747, 38748, 38749, 38750, 38751, 38752, 38753, 38754, 38755, 38756, 38757, 38758, 38759, 38760, 38761, 38762, 38764, 38765, 39010, 39011, 39013, 39015, 39016, 39017, 39018, 39019, 39020, 39021, 39022, 39023, 39025, 39026, 39027, 39028, 39029, 39030, 39031, 39033, 39034, 39035, 39036, 39038, 39040, 39043, 39044, 39045, 39046, 39047, 39048, 39049, 39050, 39051, 39052, 39053, 39054, 39055, 39056, 39057, 39058, 39059, 39060, 39062, 39064, 39065, 39066, 39068, 39070, 39072, 39073, 39074, 39075, 39076, 39077, 39078, 39079, 39080, 39081, 39082, 39083, 39084, 39085, 39086, 39087, 39088, 39089, 39090, 39091, 39092, 39093, 39094, 39095, 39096, 39097, 39098, 39099, 39100, 39102, 39104, 39105, 39108, 39109, 39110, 39112, 39113, 39114, 39115, 39116, 39117, 39118, 39119, 39120, 39121, 39124, 39125, 39127, 39128, 39129, 39130, 39131, 39132, 39133, 39134, 39135, 39136, 39138, 39139, 39140, 39141, 39142, 39143, 39144, 39146, 39168, 39169, 39170, 39171, 39172, 39173, 39174, 39175, 39176, 39177, 39178, 39179, 39180, 39181, 39182, 39183, 39188, 39189, 39190, 39191, 39192, 39193, 39194, 39195, 39196, 39197, 39198, 39199, 39200, 39208, 39215, 39216, 39217, 39221, 39224, 39225, 39226, 39228, 39229, 39230, 39231, 39232, 39233, 39234, 39235, 39236, 39237, 39239, 39240, 39241, 39242, 39243, 39244, 39245, 39246, 39247, 39248, 39249, 39250, 39251, 39252, 39254, 39255, 39256, 39257, 39258, 39259, 39260, 39261, 39262, 39267, 39270, 39271, 39272, 39273, 39274, 39275, 39276, 39277, 39278, 39279, 39280, 39281, 39282, 39283, 39284, 39285, 39291, 39292, 39293, 39294, 39295, 39296, 39297, 39298, 39299, 39306, 39307, 39308, 39309, 39310, 39311, 39320, 39322, 39323, 39330, 39331, 39332, 39333, 39335, 39336, 39337, 39344, 39345, 39346, 39347, 39348, 39363, 39365, 39366, 39367, 39368, 39369, 39372, 39373, 39374, 39375, 39376, 39377, 39378, 39379, 39380, 39383, 39385, 39386, 39387, 39388, 39389, 39390, 39391, 39392, 39393, 39394, 39395, 39396, 39397, 39398, 39399, 39400, 39401, 39402, 39403, 39404, 39405, 39406, 39407, 39408, 39409, 39411, 39412, 39413, 39414, 39415, 39416, 39417, 39419, 39420, 39421, 39422, 39423, 39424, 39425, 39426, 39427, 39428, 39429, 39430, 39431, 39432, 39433, 39435, 39436, 39437, 39438, 39439, 39441, 39442, 39443, 39444, 39445, 39446, 39448, 39449, 39450, 39451, 39452, 39453, 39454, 39455, 39457, 39458, 39459, 39461, 39462, 39463, 39464, 39465, 39466, 39467, 39468, 39470, 39471, 39472, 39473, 39474, 39475, 39478, 39479, 39480, 39481, 39482, 39483, 39484, 39485, 39486, 39487, 39488, 39490, 39491, 39492, 39493, 39494, 39495, 39496, 39497, 39498, 39499, 39500, 39503, 39508, 39514, 39515, 39517, 39518, 39519, 39521, 39523, 39528, 39529, 39530, 39531, 39534, 39535, 39536, 39538, 39539, 39542, 39543, 39544, 39545, 39546, 39547, 39548, 39553, 39554, 39555, 39556, 39557, 39558, 39560, 39561, 39564, 39565, 39578, 39579, 39580, 39581, 39582, 39583, 39588, 39589, 39590, 39591, 39592, 39593, 39594, 39595, 39596, 39597, 39601, 39602, 39603, 39604, 39605, 39606, 39607, 39608, 39609, 39610, 39611, 39612, 39613, 39617, 39618, 39619, 39620, 39621, 39622, 39623, 39624, 39625, 39626, 39627, 39628, 39629, 39630, 39631, 39632, 39633, 39634, 39635, 39636, 39637, 39638, 39639, 39640, 39641, 39642, 39648, 39649, 39650, 39652, 39653, 39655, 39657, 39672, 39673, 39674, 39675, 39676, 39678, 39679, 39680, 39688, 39701, 39702, 39703, 39704, 39706, 39707, 39708, 39709, 39710, 39711, 39712, 39714, 39715, 39716, 39717, 39718, 39719, 39720, 39721, 39722, 39723, 39724, 39725, 39726, 39727, 39728, 39729, 39730, 39731, 39732, 39733, 39734, 39735, 39756, 39757, 39758, 39759, 39760, 39761, 39762, 39763, 39764, 39765, 39766, 39767, 39768, 39770, 39771, 39772, 39773, 39775, 39776, 39777, 39778, 39779, 39780, 39781, 39782, 39783, 39784, 39785, 39786, 39787, 39788, 39789, 39790, 39791, 39792, 39793, 39794, 39795, 39796, 39797, 39798, 39799, 39800, 39801, 39803, 39804, 39805, 39806, 39807, 39808, 39809, 39810, 39811, 39812, 39814, 39815, 39816, 39817, 39818, 39820, 39821, 39822, 39823, 39824, 39825, 39826, 39827, 39829, 39830, 39831, 39833, 39834, 39835, 39836, 39837, 39838, 39839, 39840, 39841, 39842, 39843, 39844, 39845, 39846, 39847, 39848, 39849, 39850, 39851, 39852, 39853, 39854, 39855, 39856, 39857, 39858, 39859, 39860, 39861, 39862, 39863, 39864, 39865, 39866, 39867, 39868, 39869, 39870, 39871, 39872, 39873, 39874, 39875, 39876, 39877, 39880, 39881, 39882, 39886, 39887, 39888, 39890, 39891, 39893, 39894, 39895, 39897, 40060, 40061, 40062, 40063, 40064, 40065, 40069, 40071, 40074, 40075, 40080, 40107, 40108, 40184, 40185, 40186, 40187, 40188, 40189, 40190, 40191, 40192, 40193, 40194, 40196, 40197, 40198, 40200, 40201, 40203, 40204, 40205, 40206, 40207, 40208, 40209, 40210, 40233, 40234, 40235, 40236, 40237, 40238, 40239, 40240, 40241, 40242, 40243, 40244, 40245, 40246, 40247, 40249, 40250, 40251, 40252, 40253, 40254, 40255, 40256, 40257, 40258, 40259, 40260, 40261, 40262, 40263, 40264, 40265, 40266, 40267, 40268, 40269, 40270, 40271, 40272, 40273, 40274, 40275, 40277, 40278, 40279, 40280, 40281, 40282, 40283, 40284, 40285, 40286, 40287, 40288, 40289, 40290, 40291, 40292, 40293, 40294, 40295, 40296, 40297, 40298, 40299, 40300, 40301, 40302, 40303, 40304, 40305, 40306, 40315, 40316, 40317, 40318, 40319, 40320, 40321, 40322, 40323, 40324, 40325, 40326, 40327, 40328, 40329, 40330, 40331, 40332, 40333, 40334, 40335, 40336, 40337, 40338, 40339, 40340, 40341, 40342, 40343, 40344, 40345, 40346, 40347, 40348, 40349, 40350, 40351, 40352, 40353, 40362, 40363, 40365, 40366, 40367, 40368, 40369, 40370, 40371, 40372, 40373, 40374, 40375, 40376, 40377, 40378, 40379, 40380, 40381, 40382, 40383, 40384, 40385, 40386, 40387, 40388, 40395, 40396, 40398, 40399, 40400, 40401, 40402, 40403, 40405, 40406, 40407, 40408, 40409, 40410, 40412, 40414, 40415, 40416, 40417, 40418, 40419, 40420, 40421, 40422, 40423, 40424, 40426, 40427, 40428, 40429, 40430, 40431, 40432, 40433, 40437, 40438, 40439, 40445, 40446, 40447, 40448, 40449, 40450, 40451, 40453, 40454, 40455, 40456, 40457, 40458, 40459, 40460, 40461, 40462, 40463, 40465, 40466, 40467, 40468, 40469, 40470, 40471, 40472, 40473, 40474, 40475, 40476, 40477, 40483, 40486, 40488, 40489, 40490, 40491, 40493, 40494, 40495, 40496, 40497, 40499, 40500, 40502, 40503, 40504, 40505, 40506, 40507, 40508, 40509, 40510, 40511, 40512, 40513, 40514, 40515, 40516, 40517, 40518, 40519, 40520, 40521, 40522, 40523, 40524, 40525, 40526, 40527, 40528, 40529, 40530, 40531, 40532, 40539, 40541, 40543, 40544, 40545, 40546, 40547, 40548, 40549, 40550, 40552, 40554, 40555, 40556, 40557, 40558, 40559, 40560, 40561, 40562, 40563, 40564, 40565, 40566, 40567, 40568, 40569, 40570, 40571, 40572, 40573, 40574, 40575, 40576, 40577, 40578, 40579, 40580, 40581, 40583, 40584, 40585, 40586, 40588, 40589, 40590, 40591, 40592, 40594, 40602, 40643, 40668, 40669, 40670, 40671, 40672, 40673, 40674, 40675, 40678, 40679, 40680, 40681, 40682, 40683, 40684, 40685, 40688, 40689, 40691, 40692, 40693, 40694, 40695, 40696, 40697, 40698, 40699, 40700, 40701, 40702, 40703, 40704, 40705, 40706, 40707, 40708, 40709, 40710, 40711, 40712, 40713, 40714, 40715, 40716, 40717, 40718, 40719, 40720, 40721, 40722, 40723, 40724, 40733, 40734, 40735, 40736, 40737, 40738, 40739, 40740, 40741, 40742, 40743, 40745, 40746, 40747, 40748, 40749, 40750, 40751, 40755, 40756, 40757, 40758, 40767, 40778, 40779, 40780, 40781, 40782, 40783, 40784, 40785, 40786, 40797, 40798, 40799, 40801, 40802, 40803, 40804, 40805, 40806, 40816, 40817, 40818, 40819, 40820, 40821, 40823, 40824, 40825, 40836, 40837, 40838, 40840, 40841, 40842, 40844, 40845, 40846, 40856, 40857, 40858, 40859, 40860, 40861, 40862, 40863, 40864, 40865, 40877, 40878, 40879, 40880, 40887, 40888, 40895, 40898, 40904, 40905, 40918, 40925, 40926, 40930, 40931, 40932, 40936, 40937, 40938, 40942, 40943, 40949, 40950, 40951, 40952, 40953, 40954, 40955, 40956, 40957, 40958, 40959, 40960, 40961, 40962, 40966, 40972, 40973, 40974, 40975, 40982, 40986, 40987, 40988, 40989, 40990, 40991, 40998, 40999, 41000, 41004, 41005, 41006, 41010, 41011, 41012, 41016, 41017, 41018, 41023, 41024, 41025, 41026, 41030, 41031, 41032, 41036, 41037, 41041, 41042, 41043, 41047, 41048, 41049, 41050, 41054, 41059, 41063, 41064, 41068, 41069, 41073, 41074, 41078, 41079, 41080, 41084, 41085, 41086, 41112, 41113, 41114, 41116, 41117, 41121, 41126, 41127, 41128, 41129, 41134, 41135, 41136, 41140, 41141, 41142, 41148, 41149, 41150, 41154, 41155, 41156, 41160, 41162, 41164, 41165, 41168, 41181, 41182, 41183, 41184, 41185, 41186, 41187, 41188, 41189, 41190, 41198, 41202, 41203, 41204, 41208, 41209, 41210, 41214, 41215, 41216, 41223, 41224, 41228, 41229, 41233, 41234, 41238, 41239, 41240, 41241, 41242, 41243, 41245, 41257, 41264, 41268, 41269, 41270, 41271, 41272, 41273, 41274, 41278, 41279, 41280, 41284, 41286, 41290, 41291, 41292, 41296, 41297, 41301, 41302, 41303, 41308, 41309, 41313, 41314, 41315, 41319, 41320, 41324, 41325, 41326, 41330, 41331, 41332, 41344, 41345, 41346, 41347, 41348, 41349, 41350, 41351, 41352, 41353, 41354, 41355, 41356, 41357, 41383, 41384, 41386, 41387, 41388, 41391, 41392, 41394, 41512, 41513, 41515, 41516, 41519, 41520, 41521, 41522, 41523, 41525, 41528, 41543, 41544, 41545, 41546, 41548, 41549, 41550, 41551, 41553, 41554, 41555, 41587, 41588, 41589, 41590, 41591, 41592, 41597, 41598, 41600, 41607, 41608, 41609, 41610, 41616, 41620, 41624, 41628, 41629, 41633, 41634, 41638, 41639, 41643, 41644, 41645, 41646, 41647, 41648, 41649, 41653, 41654, 41658, 41659, 41660, 41664, 41665, 41666, 41670, 41671, 41675, 41676, 41677, 41681, 41682, 41712, 41713, 41714, 41755, 41756, 41757, 41758, 41759, 41760, 41761, 41762, 41763, 41765, 41766, 41770, 41771, 41772, 41815, 41816, 41821, 41822, 41824, 41825, 41826, 41827, 41828, 41829, 41830, 41831, 41835, 41839, 41844, 41845, 41846, 41847, 41848, 41849, 41850, 41851, 41852, 41853, 41857, 41858, 41862, 41863, 41867, 41868, 41872, 41873, 41877, 41878, 41879, 41880, 41884, 41890, 41891, 41892, 41896, 41897, 41900, 41901, 41902, 41905, 41907, 41908, 41911, 41912, 41913, 41914, 41918, 41919, 41920, 41924, 41925, 41926, 41930, 41931, 41932, 41933, 41937, 41938, 41939, 41943, 41944, 41945, 41949, 41950, 41951, 41956, 41957, 41958, 41962, 41963, 41964, 41968, 41969, 41970, 41974, 41975, 41984, 41985, 41986, 41987, 41990, 41991, 41992, 41995, 41996, 41997, 42000, 42001, 42002, 42003, 42004, 42007, 42008, 42009, 42010, 42013, 42014, 42015, 42016, 42019, 42020, 42021, 42022, 42023, 42024, 42025, 42026, 42027, 42028, 42029, 42030, 42031, 42032, 42033, 42055, 42056, 42057, 42058, 42059, 42060, 42061, 42062, 42063, 42064, 42065, 42066, 42067, 42068, 42083, 42093, 42095, 42096, 42100, 42101, 42102, 42103, 42110, 42111, 42112, 42113, 42114, 42115, 42122, 42123, 42128, 42129, 42130, 42131, 42132, 42206, 42207, 42208, 42212, 42213, 42214, 42215, 42216, 42217, 42218, 42219, 42220, 42221, 42222, 42223, 42224, 42226, 42227, 42231, 42232, 42236, 42237, 42241, 42242, 42247, 42248, 42254, 42255, 42259, 42260, 42264, 42265, 42269, 42270, 42274, 42275, 42279, 42280, 42284, 42285, 42289, 42290, 42294, 42295, 42296, 42297, 42316, 42317, 42321, 42322, 42326, 42327, 42331, 42332, 42336, 42337, 42338, 42339, 42340, 42341, 42343, 42344, 42345, 42346, 42351, 42352, 42356, 42359, 42362, 42382, 42383, 42384, 42388, 42389, 42390, 42395, 42413, 42418, 42435, 42443, 42444, 42445, 42446, 42447, 42448, 42449, 42450, 42484, 42485, 42489, 42490, 42494, 42495, 42501, 42502, 42508, 42511, 42512, 42513, 42517, 42518, 42519, 42523, 42524, 42525, 42529, 42530, 42531, 42535, 42536, 42537, 42549, 42550, 42551, 42552, 42553, 42554, 42555, 42556, 42557, 42558, 42559, 42563, 42564, 42568, 42569, 42570, 42574, 42575, 42576, 42577, 42578, 42582, 42583, 42587, 42588, 42593, 42594, 42595, 42596, 42597, 42601, 42602, 42606, 42607, 42611, 42612, 42613, 42614, 42618, 42619, 42620, 42642, 42643, 42644, 42645, 42646, 42647, 42723, 42724, 42725, 42726, 42727, 42728, 42729, 42730, 42731, 42758, 42760, 42761, 42762, 42763, 42765, 42766, 42767, 42768, 42785, 42786, 42787, 42788, 42789, 42790, 42791, 42792, 42793, 42794, 42795, 42796, 42798, 42799, 42800, 42801, 42802, 42803, 42804, 42805, 42806, 42807, 42808, 42809, 42810, 42811, 42812, 42813, 42814, 42815, 42816, 42817, 42818, 42819, 42820, 42821, 42822, 42823, 42824, 42825, 42826, 42827, 42828, 42829, 42830, 42831, 42832, 42833, 42834, 42835, 42836, 42841, 42842, 42843, 42844, 42845, 42846, 42847, 42848, 42849, 42850, 42851, 42852, 42857, 42858, 42859, 42860, 42861, 42862, 42863, 42864, 42865, 42866, 42867, 42868, 42869, 42870, 42871, 42872, 42874, 42876, 42877, 42878, 42879, 42880, 42881, 42882, 42883, 42884, 42887, 42888, 42889, 42890, 42891, 42892, 42893, 42895, 42896, 42943, 42944, 42945, 42946, 42947, 42948, 42949, 42950, 42951, 42952, 42984, 42985, 42988, 42991, 42992, 43085, 43129, 43130, 43131, 43132, 43133, 43160, 43161, 43162, 43163, 43164, 43165, 43167, 43168, 43171, 43172, 43173, 43174, 43176, 43177, 43178, 43179, 43180, 43181, 43182, 43183, 43184, 43185, 43186, 43187, 43188, 43189, 43190, 43191, 43192, 43193, 43194, 43195, 43197, 43198, 43200, 43201, 43202, 43203, 43204, 43207, 43208, 43209, 43210, 43211, 43212, 43213, 43244, 43245, 43246, 43247, 43248, 43249, 43250, 43251, 43252, 43253, 43255, 43256, 43257, 43258, 43260, 43261, 43262, 43263, 43264, 43265, 43266, 43271, 43273, 43277, 43278, 43279, 43280, 43281, 43282, 43283, 43284, 43285, 43286, 43287, 43300, 43305, 43306, 43309, 43310, 43311, 43312, 43313, 43345, 43348, 43353, 43358, 43363, 43375, 43382, 43387, 43401, 43402, 43403, 43404, 43405, 43406, 43407, 43408, 43409, 43410, 43433, 43434, 43435, 43436, 43437, 43438, 43439, 43442, 43443, 43444, 43445, 43446, 43447, 43448, 43449, 43450, 43451, 43452, 43453, 43454, 43455, 43456, 43457, 43458, 43459, 43461, 43469, 43481, 43482, 43484, 43495, 43498, 43500, 43502, 43515, 43565, 43566, 43582, 43583, 43584, 43585, 43586, 43587, 43588, 43590, 43591, 43592, 43593, 43594, 43595, 43611, 43654, 43655, 43656, 43657, 43660, 43661, 43663, 43664, 43666, 43667, 43828, 43830, 43831, 43832, 43833, 43834, 43835, 43836, 43837, 43839, 43840, 43841, 43842, 43843, 43844, 43845, 43846, 43847, 43849, 43855, 43856, 43857, 43858, 43859, 43860, 43861, 43862, 43863, 43864, 43865, 43866, 43870, 43871, 43872, 43873, 43874, 43875, 43877, 43879, 43880, 43881, 43882, 43883, 43884, 43885, 43888, 43889, 43890, 43891, 43892, 43893, 43894, 43896, 43897, 43898, 43899, 43900, 43903, 43904, 43905, 43906, 43907, 43908, 43909, 43910, 43911, 43912, 43913, 43914, 43915, 43916, 43917, 43918, 43919, 43920, 43921, 43923, 43924, 43925, 43926, 43927, 43928, 43929, 43930, 43931, 43932, 43933, 43934, 43935, 43937, 43939, 43940, 43941, 43942, 43943, 43944, 43945, 43946, 43947, 43948, 43969, 43970, 43971, 43972, 43973, 43974, 43975, 43976, 43977, 43978, 43979, 43980, 43981, 43982, 43988, 43989, 43990, 43991, 43992, 43993, 43994, 43995, 43996, 43998, 44000, 44002, 44003, 44004, 44005, 44006, 44007, 44008, 44011, 44013, 44014, 44015, 44016, 44017, 44018, 44019, 44020, 44021, 44022, 44023, 44024, 44025, 44026, 44027, 44028, 44029, 44030, 44031, 44032, 44033, 44034, 44035, 44036, 44037, 44038, 44039, 44040, 44041, 44042, 44043, 44044, 44045, 44046, 44050, 44051, 44052, 44053, 44054, 44055, 44057, 44058, 44059, 44060, 44061, 44062, 44063, 44073, 44074, 44091, 44092, 44093, 44094, 44095, 44096, 44097, 44098, 44099, 44100, 44101, 44102, 44103, 44104, 44105, 44106, 44107, 44108, 44109, 44110, 44111, 44112, 44116, 44117, 44118, 44120, 44121, 44122, 44123, 44166, 44167, 44170, 44171, 44173, 44174, 44176, 44179, 44180, 44181, 44182, 44183, 44187, 44188, 44189, 44190, 44192, 44193, 44194, 44195, 44196, 44197, 44198, 44199, 44200, 44201, 44202, 44203, 44204, 44205, 44210, 44211, 44213, 44214, 44215, 44216, 44217, 44218, 44219, 44239, 44240, 44241, 44242, 44243, 44244, 44245, 44247, 44248, 44249, 44250, 44253, 44256, 44257, 44258, 44283, 44295, 44296, 44297, 44302, 44303, 44305, 44306, 44308, 44309, 44310, 44311, 44312, 44313, 44322, 44323, 44324, 44334, 44335, 44336, 44337, 44338, 44339, 44340, 44341, 44342, 44343, 44344, 44345, 44346, 44347, 44348, 44349, 44350, 44351, 44352, 44353, 44354, 44355, 44356, 44357, 44358, 44359, 44360, 44361, 44362, 44363, 44364, 44365, 44366, 44367, 44368, 44369, 44370, 44371, 44372, 44373, 44374, 44375, 44376, 44377, 44378, 44379, 44380, 44381, 44382, 44383, 44384, 44385, 44386, 44387, 44388, 44391, 44392, 44393, 44394, 44395, 44396, 44397, 44398, 44399, 44400, 44401, 44402, 44403, 44404, 44405, 44406, 44407, 44408, 44409, 44410, 44411, 44412, 44415, 44416, 44417, 44418, 44419, 44420, 44429, 44431, 44436, 44437, 44438, 44440, 44441, 44442, 44443, 44444, 44445, 44446, 44447, 44448, 44504, 44579, 44583, 44590, 44591, 44592, 44593, 44594, 44595, 44596, 44597, 44649, 44657, 44658, 44659, 44660, 44661, 44662, 44664, 44665, 44666, 44667, 44668, 44669, 44670, 44671, 44672, 44673, 44674, 44675, 44676, 44677, 44681, 44682, 44683, 44685, 44686, 44687, 44688, 44691, 44695, 44696, 44697, 44708, 44732, 44734, 44735, 44736, 44740, 44741, 44742, 44745, 44746, 44747, 44748 
            };
                
            
                /*All Items: 21168, 32824, 33084, 33098, 33099, 33109, 33111, 33119, 33120, 33123, 33129, 33164, 33187, 33188, 33190, 33221, 33238, 33278, 33282, 33284, 33289, 33290, 33308, 33310, 33311, 33312, 33314, 33321, 33323, 33330, 33335, 33336, 33337, 33339, 33340, 33341, 33342, 33343, 33344, 33345, 33346, 33347, 33348, 33349, 33351, 33352, 33355, 33358, 33359, 33360, 33361, 33362, 33363, 33364, 33365, 33366, 33367, 33368, 33369, 33370, 33371, 33372, 33373, 33374, 33375, 33376, 33377, 33378, 33379, 33380, 33381, 33382, 33383, 33384, 33385, 33387, 33390, 33391, 33392, 33393, 33394, 33395, 33396, 33397, 33398, 33399, 33400, 33401, 33402, 33403, 33404, 33405, 33406, 33407, 33408, 33409, 33410, 33411, 33412, 33413, 33414, 33415, 33416, 33417, 33418, 33419, 33420, 33422, 33423, 33424, 33425, 33426, 33427, 33428, 33429, 33430, 33431, 33433, 33434, 33435, 33436, 33437, 33438, 33439, 33440, 33441, 33443, 33444, 33445, 33447, 33448, 33449, 33450, 33451, 33452, 33454, 33457, 33458, 33459, 33460, 33461, 33462, 33470, 33472, 33477, 33485, 33486, 33487, 33488, 33541, 33545, 33546, 33547, 33548, 33549, 33550, 33551, 33553, 33554, 33555, 33556, 33558, 33560, 33561, 33562, 33563, 33567, 33568, 33569, 33571, 33575, 33576, 33581, 33605, 33606, 33607, 33611, 33612, 33613, 33614, 33615, 33617, 33618, 33619, 33620, 33621, 33627, 33628, 33629, 33630, 33631, 33632, 33634, 33635, 33637, 33638, 33639, 33774, 33778, 33779, 33780, 33781, 33794, 33796, 33806, 33819, 33960, 33961, 33962, 34013, 34023, 34024, 34026, 34027, 34031, 34032, 34035, 34040, 34041, 34042, 34043, 34051, 34052, 34053, 34054, 34055, 34056, 34057, 34069, 34070, 34076, 34078, 34081, 34082, 34083, 34084, 34088, 34090, 34091, 34101, 34102, 34111, 34112, 34115, 34116, 34118, 34119, 34120, 34121, 34122, 34123, 34124, 34125, 34126, 34127, 34128, 34131, 34132, 34133, 34134, 34135, 34136, 34137, 34138, 34139, 34142, 34143, 34222, 34223, 34224, 34225, 34226, 34235, 34236, 34237, 34238, 34239, 34387, 34468, 34494, 34498, 34597, 34598, 34600, 34617, 34618, 34619, 34620, 34621, 34623, 34624, 34645, 34647, 34648, 34649, 34650, 34651, 34652, 34653, 34655, 34656, 34657, 34658, 34659, 34661, 34663, 34669, 34688, 34690, 34691, 34692, 34695, 34709, 34710, 34711, 34713, 34714, 34715, 34719, 34720, 34721, 34722, 34736, 34747, 34748, 34749, 34750, 34751, 34752, 34753, 34754, 34755, 34756, 34757, 34758, 34759, 34760, 34761, 34762, 34763, 34764, 34765, 34766, 34767, 34768, 34769, 34772, 34773, 34774, 34775, 34777, 34778, 34779, 34781, 34782, 34785, 34786, 34787, 34800, 34801, 34802, 34804, 34806, 34811, 34812, 34813, 34814, 34815, 34830, 34835, 34842, 34844, 34869, 34870, 34871, 34897, 34908, 34909, 34913, 34915, 34920, 34948, 34954, 34956, 34957, 34958, 34959, 34960, 34961, 34962, 34963, 34964, 34968, 34971, 34972, 34973, 34974, 34975, 34976, 34977, 34978, 34979, 34980, 34981, 34982, 34983, 34984, 35116, 35119, 35121, 35122, 35123, 35125, 35126, 35127, 35188, 35222, 35224, 35228, 35234, 35272, 35276, 35278, 35281, 35288, 35289, 35293, 35352, 35353, 35354, 35355, 35401, 35479, 35481, 35483, 35484, 35486, 35490, 35491, 35492, 35493, 35506, 35570, 35571, 35572, 35573, 35574, 35575, 35576, 35577, 35578, 35579, 35580, 35583, 35584, 35585, 35586, 35587, 35588, 35589, 35590, 35591, 35592, 35593, 35594, 35595, 35596, 35597, 35598, 35599, 35601, 35602, 35603, 35604, 35605, 35606, 35607, 35608, 35609, 35610, 35611, 35612, 35613, 35614, 35615, 35616, 35617, 35618, 35619, 35620, 35622, 35623, 35624, 35625, 35626, 35627, 35628, 35629, 35630, 35631, 35632, 35633, 35634, 35635, 35636, 35637, 35638, 35639, 35640, 35641, 35642, 35643, 35644, 35645, 35646, 35647, 35648, 35649, 35650, 35651, 35652, 35653, 35654, 35655, 35656, 35657, 35658, 35659, 35660, 35661, 35662, 35663, 35666, 35668, 35669, 35670, 35671, 35672, 35673, 35675, 35676, 35677, 35678, 35679, 35680, 35681, 35682, 35683, 35685, 35686, 35687, 35688, 35690, 35692, 35701, 35704, 35705, 35706, 35709, 35711, 35718, 35722, 35726, 35734, 35736, 35737, 35738, 35739, 35746, 35747, 35774, 35782, 35783, 35784, 35788, 35790, 35791, 35792, 35794, 35795, 35796, 35797, 35798, 35799, 35800, 35801, 35802, 35803, 35806, 35807, 35808, 35809, 35810, 35811, 35812, 35813, 35814, 35815, 35816, 35817, 35818, 35819, 35820, 35821, 35822, 35823, 35824, 35826, 35827, 35829, 35830, 35831, 35832, 35833, 35834, 35835, 35836, 35837, 35838, 35839, 35841, 35842, 35843, 35844, 35845, 35846, 35848, 35849, 35850, 35851, 35852, 35856, 35857, 35858, 35859, 35860, 35861, 35862, 35863, 35864, 35865, 35866, 35867, 35868, 35869, 35870, 35871, 35872, 35873, 35875, 35877, 35878, 35879, 35880, 35881, 35882, 35883, 35884, 35885, 35886, 35887, 35888, 35889, 35890, 35891, 35892, 35893, 35894, 35895, 35896, 35897, 35898, 35899, 35900, 35901, 35902, 35903, 35904, 35905, 35907, 35908, 35909, 35910, 35911, 35912, 35913, 35914, 35915, 35916, 35917, 35918, 35919, 35920, 35921, 35922, 35923, 35924, 35925, 35926, 35927, 35928, 35929, 35930, 35931, 35932, 35933, 35934, 35935, 35936, 35937, 35938, 35941, 35943, 35944, 35946, 35947, 35948, 35949, 35950, 35951, 35952, 35953, 35954, 35955, 35956, 35957, 35958, 35959, 35960, 35961, 35962, 35963, 35964, 35965, 35966, 35967, 35968, 35969, 35970, 35971, 35972, 35973, 35974, 35975, 35976, 35977, 35978, 35979, 35980, 35981, 35982, 35983, 35984, 35985, 35986, 35987, 35988, 35989, 35990, 35991, 35992, 35993, 35994, 35995, 35996, 35997, 35998, 35999, 36000, 36001, 36002, 36003, 36004, 36005, 36006, 36007, 36008, 36009, 36010, 36011, 36012, 36013, 36014, 36015, 36016, 36017, 36018, 36019, 36020, 36021, 36022, 36023, 36024, 36025, 36026, 36027, 36028, 36029, 36030, 36031, 36032, 36033, 36034, 36035, 36036, 36037, 36038, 36039, 36040, 36041, 36042, 36043, 36044, 36045, 36046, 36047, 36048, 36049, 36050, 36051, 36052, 36053, 36054, 36055, 36056, 36057, 36058, 36059, 36060, 36061, 36062, 36063, 36064, 36065, 36066, 36067, 36068, 36069, 36070, 36071, 36072, 36073, 36074, 36075, 36076, 36077, 36078, 36079, 36080, 36081, 36082, 36083, 36084, 36085, 36086, 36087, 36088, 36089, 36090, 36091, 36092, 36093, 36094, 36095, 36096, 36097, 36098, 36099, 36100, 36101, 36102, 36103, 36104, 36105, 36106, 36107, 36108, 36109, 36110, 36111, 36112, 36113, 36114, 36115, 36116, 36117, 36118, 36119, 36120, 36121, 36122, 36123, 36124, 36125, 36126, 36127, 36128, 36129, 36130, 36131, 36132, 36133, 36134, 36135, 36136, 36137, 36138, 36139, 36140, 36141, 36142, 36143, 36144, 36145, 36146, 36147, 36148, 36149, 36150, 36151, 36152, 36153, 36154, 36155, 36156, 36157, 36158, 36159, 36160, 36161, 36162, 36163, 36164, 36165, 36166, 36167, 36168, 36169, 36170, 36171, 36172, 36173, 36174, 36175, 36176, 36177, 36178, 36179, 36180, 36181, 36182, 36183, 36184, 36185, 36186, 36187, 36188, 36189, 36190, 36191, 36192, 36193, 36194, 36195, 36196, 36197, 36198, 36199, 36200, 36201, 36202, 36203, 36204, 36205, 36206, 36207, 36208, 36209, 36210, 36211, 36212, 36213, 36214, 36215, 36216, 36217, 36218, 36219, 36220, 36221, 36222, 36223, 36224, 36225, 36226, 36227, 36228, 36229, 36230, 36231, 36232, 36233, 36234, 36235, 36236, 36237, 36238, 36239, 36240, 36241, 36242, 36243, 36244, 36245, 36246, 36247, 36248, 36249, 36250, 36251, 36252, 36253, 36254, 36255, 36256, 36257, 36258, 36259, 36260, 36261, 36262, 36263, 36264, 36265, 36266, 36267, 36268, 36269, 36270, 36271, 36272, 36273, 36274, 36275, 36276, 36277, 36278, 36279, 36280, 36281, 36282, 36283, 36284, 36285, 36286, 36287, 36288, 36289, 36290, 36291, 36292, 36293, 36294, 36295, 36296, 36297, 36298, 36299, 36300, 36301, 36302, 36303, 36304, 36305, 36306, 36307, 36308, 36309, 36310, 36311, 36312, 36313, 36314, 36315, 36316, 36317, 36318, 36319, 36320, 36321, 36322, 36323, 36324, 36325, 36326, 36327, 36328, 36329, 36330, 36331, 36332, 36333, 36334, 36335, 36336, 36337, 36338, 36339, 36340, 36341, 36342, 36343, 36344, 36345, 36346, 36347, 36348, 36349, 36350, 36351, 36352, 36353, 36354, 36355, 36356, 36357, 36358, 36359, 36360, 36361, 36362, 36363, 36364, 36365, 36366, 36367, 36368, 36369, 36370, 36371, 36372, 36373, 36374, 36375, 36376, 36377, 36378, 36379, 36380, 36381, 36382, 36383, 36384, 36385, 36386, 36387, 36388, 36389, 36390, 36391, 36392, 36393, 36394, 36395, 36396, 36397, 36398, 36399, 36400, 36401, 36402, 36403, 36404, 36405, 36406, 36407, 36408, 36409, 36410, 36411, 36412, 36413, 36414, 36415, 36416, 36417, 36418, 36419, 36420, 36421, 36422, 36423, 36424, 36425, 36426, 36427, 36428, 36429, 36430, 36431, 36432, 36433, 36434, 36435, 36436, 36437, 36438, 36439, 36440, 36441, 36442, 36443, 36444, 36445, 36446, 36447, 36448, 36449, 36450, 36451, 36452, 36453, 36455, 36456, 36457, 36458, 36459, 36460, 36461, 36462, 36463, 36464, 36465, 36466, 36467, 36468, 36469, 36470, 36471, 36472, 36473, 36474, 36475, 36476, 36478, 36479, 36480, 36481, 36482, 36483, 36484, 36485, 36486, 36487, 36488, 36489, 36490, 36492, 36493, 36494, 36495, 36496, 36497, 36498, 36499, 36500, 36501, 36502, 36503, 36504, 36506, 36507, 36508, 36509, 36510, 36511, 36512, 36513, 36514, 36515, 36516, 36517, 36518, 36520, 36521, 36522, 36523, 36524, 36525, 36526, 36527, 36528, 36529, 36530, 36531, 36532, 36534, 36535, 36536, 36537, 36538, 36539, 36540, 36541, 36542, 36543, 36544, 36545, 36546, 36548, 36549, 36550, 36551, 36552, 36553, 36554, 36555, 36556, 36557, 36558, 36559, 36560, 36562, 36563, 36564, 36565, 36566, 36567, 36568, 36569, 36570, 36571, 36572, 36573, 36574, 36576, 36577, 36578, 36579, 36580, 36581, 36582, 36583, 36584, 36585, 36586, 36587, 36588, 36590, 36591, 36592, 36593, 36594, 36595, 36596, 36597, 36598, 36599, 36600, 36601, 36602, 36604, 36605, 36606, 36607, 36608, 36609, 36610, 36611, 36612, 36613, 36614, 36615, 36616, 36618, 36619, 36620, 36621, 36622, 36623, 36624, 36625, 36626, 36627, 36628, 36629, 36630, 36632, 36633, 36634, 36635, 36636, 36637, 36638, 36639, 36640, 36641, 36642, 36643, 36644, 36646, 36647, 36648, 36649, 36650, 36651, 36652, 36653, 36654, 36655, 36656, 36657, 36658, 36660, 36661, 36662, 36663, 36664, 36665, 36666, 36667, 36668, 36669, 36670, 36671, 36672, 36674, 36675, 36676, 36677, 36678, 36679, 36680, 36681, 36682, 36683, 36684, 36685, 36686, 36688, 36689, 36690, 36691, 36692, 36693, 36694, 36695, 36696, 36697, 36698, 36699, 36700, 36702, 36703, 36704, 36705, 36706, 36707, 36708, 36709, 36710, 36711, 36712, 36713, 36714, 36716, 36717, 36718, 36719, 36720, 36721, 36722, 36723, 36724, 36725, 36726, 36727, 36728, 36729, 36730, 36731, 36732, 36733, 36734, 36735, 36736, 36738, 36739, 36740, 36741, 36742, 36743, 36744, 36746, 36747, 36751, 36752, 36753, 36754, 36756, 36757, 36758, 36759, 36760, 36764, 36765, 36766, 36767, 36768, 36769, 36770, 36771, 36772, 36774, 36775, 36776, 36777, 36779, 36780, 36781, 36782, 36783, 36784, 36786, 36787, 36788, 36789, 36793, 36796, 36797, 36798, 36800, 36801, 36802, 36803, 36804, 36805, 36806, 36807, 36808, 36809, 36810, 36811, 36812, 36813, 36814, 36815, 36816, 36817, 36818, 36819, 36820, 36821, 36822, 36823, 36824, 36825, 36826, 36827, 36828, 36829, 36830, 36832, 36833, 36834, 36835, 36836, 36846, 36847, 36848, 36849, 36850, 36851, 36852, 36853, 36854, 36855, 36856, 36857, 36858, 36859, 36860, 36861, 36862, 36863, 36864, 36865, 36868, 36870, 36871, 36872, 36873, 36874, 36875, 36878, 36879, 36880, 36881, 36882, 36883, 36884, 36885, 36886, 36887, 36888, 36889, 36890, 36891, 36892, 36893, 36894, 36895, 36896, 36897, 36899, 36900, 36901, 36902, 36903, 36904, 36905, 36906, 36907, 36908, 36909, 36910, 36912, 36913, 36914, 36915, 36916, 36917, 36918, 36920, 36921, 36923, 36924, 36926, 36927, 36929, 36930, 36932, 36933, 36935, 36936, 36937, 36938, 36939, 36940, 36943, 36944, 36945, 36946, 36947, 36948, 36949, 36950, 36951, 36952, 36953, 36954, 36955, 36956, 36957, 36958, 36959, 36960, 36961, 36962, 36964, 36965, 36966, 36967, 36968, 36969, 36970, 36971, 36972, 36973, 36974, 36975, 36976, 36977, 36978, 36979, 36980, 36981, 36982, 36983, 36984, 36985, 36986, 36988, 36989, 36991, 36992, 36993, 36994, 36995, 36996, 36997, 36998, 36999, 37000, 37002, 37003, 37004, 37005, 37006, 37007, 37008, 37009, 37010, 37013, 37014, 37015, 37016, 37017, 37018, 37019, 37020, 37021, 37022, 37023, 37024, 37025, 37026, 37027, 37028, 37029, 37030, 37031, 37032, 37033, 37034, 37035, 37036, 37037, 37038, 37039, 37040, 37041, 37042, 37043, 37044, 37045, 37046, 37047, 37048, 37049, 37050, 37051, 37052, 37053, 37054, 37055, 37056, 37057, 37058, 37060, 37061, 37062, 37063, 37064, 37065, 37066, 37067, 37068, 37069, 37070, 37071, 37072, 37073, 37074, 37075, 37076, 37077, 37078, 37079, 37080, 37081, 37082, 37083, 37084, 37085, 37086, 37087, 37088, 37089, 37090, 37091, 37092, 37093, 37094, 37095, 37096, 37097, 37098, 37099, 37100, 37101, 37104, 37105, 37106, 37107, 37108, 37109, 37110, 37111, 37112, 37113, 37114, 37115, 37116, 37117, 37118, 37121, 37122, 37124, 37125, 37129, 37134, 37135, 37136, 37137, 37138, 37139, 37140, 37141, 37143, 37144, 37145, 37147, 37149, 37150, 37151, 37152, 37153, 37155, 37156, 37157, 37158, 37159, 37160, 37161, 37162, 37163, 37164, 37165, 37166, 37167, 37168, 37169, 37170, 37171, 37172, 37173, 37177, 37178, 37179, 37180, 37181, 37182, 37183, 37184, 37185, 37186, 37187, 37188, 37189, 37190, 37191, 37192, 37193, 37194, 37195, 37196, 37197, 37198, 37199, 37200, 37201, 37202, 37203, 37204, 37205, 37206, 37207, 37208, 37209, 37210, 37211, 37212, 37213, 37214, 37215, 37216, 37217, 37218, 37219, 37220, 37221, 37222, 37223, 37224, 37225, 37226, 37227, 37228, 37229, 37230, 37231, 37232, 37233, 37234, 37235, 37236, 37237, 37238, 37239, 37240, 37241, 37242, 37243, 37246, 37247, 37248, 37250, 37251, 37252, 37253, 37254, 37255, 37256, 37257, 37258, 37259, 37260, 37261, 37262, 37263, 37264, 37265, 37267, 37268, 37269, 37270, 37271, 37272, 37273, 37274, 37275, 37276, 37277, 37280, 37282, 37283, 37287, 37288, 37289, 37290, 37291, 37292, 37293, 37294, 37299, 37300, 37302, 37303, 37304, 37305, 37306, 37307, 37311, 37312, 37313, 37314, 37319, 37320, 37322, 37325, 37331, 37332, 37333, 37339, 37344, 37347, 37349, 37350, 37351, 37352, 37353, 37354, 37355, 37356, 37357, 37358, 37359, 37360, 37361, 37362, 37363, 37364, 37365, 37366, 37367, 37368, 37369, 37370, 37371, 37372, 37373, 37374, 37375, 37376, 37377, 37378, 37379, 37380, 37381, 37382, 37383, 37384, 37385, 37386, 37387, 37388, 37389, 37390, 37391, 37392, 37393, 37394, 37395, 37396, 37397, 37398, 37399, 37400, 37401, 37402, 37403, 37404, 37405, 37406, 37407, 37408, 37409, 37410, 37411, 37412, 37413, 37414, 37415, 37416, 37417, 37418, 37419, 37420, 37421, 37422, 37423, 37424, 37425, 37426, 37427, 37428, 37429, 37430, 37431, 37432, 37433, 37434, 37435, 37436, 37437, 37438, 37439, 37440, 37441, 37442, 37443, 37445, 37446, 37447, 37449, 37452, 37456, 37458, 37459, 37460, 37461, 37462, 37463, 37464, 37465, 37467, 37471, 37475, 37476, 37478, 37479, 37480, 37481, 37482, 37483, 37484, 37485, 37486, 37487, 37500, 37501, 37502, 37505, 37506, 37507, 37508, 37509, 37510, 37511, 37512, 37513, 37514, 37515, 37516, 37517, 37518, 37519, 37520, 37521, 37522, 37523, 37524, 37525, 37526, 37527, 37528, 37529, 37530, 37535, 37537, 37538, 37539, 37540, 37541, 37542, 37543, 37544, 37545, 37546, 37547, 37548, 37555, 37556, 37557, 37558, 37559, 37560, 37562, 37564, 37565, 37566, 37567, 37568, 37569, 37570, 37572, 37573, 37574, 37575, 37576, 37577, 37580, 37581, 37587, 37590, 37591, 37592, 37593, 37594, 37595, 37601, 37602, 37603, 37607, 37612, 37613, 37614, 37615, 37616, 37617, 37618, 37619, 37620, 37621, 37622, 37623, 37624, 37625, 37626, 37627, 37628, 37629, 37630, 37631, 37632, 37633, 37634, 37635, 37636, 37637, 37638, 37639, 37640, 37641, 37642, 37643, 37644, 37645, 37646, 37647, 37648, 37650, 37651, 37652, 37653, 37654, 37655, 37656, 37657, 37658, 37659, 37660, 37661, 37662, 37663, 37664, 37665, 37666, 37667, 37668, 37669, 37670, 37671, 37672, 37673, 37674, 37675, 37677, 37678, 37679, 37680, 37681, 37682, 37683, 37684, 37685, 37686, 37687, 37688, 37689, 37690, 37691, 37692, 37693, 37694, 37695, 37696, 37700, 37701, 37702, 37703, 37704, 37705, 37706, 37707, 37708, 37712, 37713, 37714, 37715, 37716, 37717, 37718, 37721, 37722, 37723, 37724, 37725, 37726, 37727, 37728, 37729, 37730, 37731, 37732, 37733, 37734, 37735, 37736, 37737, 37741, 37743, 37744, 37745, 37746, 37747, 37748, 37749, 37751, 37752, 37753, 37754, 37755, 37756, 37757, 37758, 37759, 37760, 37761, 37762, 37763, 37764, 37765, 37766, 37767, 37768, 37769, 37770, 37771, 37772, 37773, 37774, 37775, 37776, 37777, 37778, 37779, 37780, 37781, 37782, 37783, 37784, 37785, 37786, 37787, 37788, 37789, 37790, 37791, 37792, 37793, 37794, 37795, 37796, 37797, 37798, 37799, 37800, 37801, 37802, 37803, 37804, 37805, 37806, 37807, 37808, 37809, 37810, 37811, 37812, 37813, 37814, 37815, 37817, 37818, 37819, 37820, 37821, 37822, 37823, 37824, 37825, 37826, 37830, 37831, 37833, 37835, 37836, 37837, 37840, 37841, 37842, 37843, 37844, 37845, 37846, 37847, 37848, 37849, 37850, 37851, 37852, 37853, 37854, 37855, 37856, 37857, 37858, 37859, 37860, 37861, 37862, 37867, 37868, 37869, 37870, 37871, 37872, 37873, 37874, 37875, 37876, 37877, 37878, 37879, 37880, 37881, 37882, 37883, 37884, 37886, 37887, 37888, 37889, 37890, 37891, 37910, 37911, 37912, 37913, 37920, 37921, 37922, 37923, 37925, 37930, 37931, 37932, 37933, 37936, 37937, 37938, 37939, 37940, 37941, 37942, 37943, 37944, 37945, 37947, 37948, 37949, 37950, 37953, 37954, 37955, 37956, 37957, 37958, 37959, 37960, 37961, 37962, 37963, 37964, 37965, 37966, 37967, 37968, 37969, 37970, 37971, 37976, 37980, 37981, 37982, 37983, 37984, 37985, 37986, 37987, 37988, 37989, 37990, 37991, 37992, 37993, 37995, 37996, 37998, 37999, 38000, 38001, 38002, 38003, 38004, 38005, 38006, 38007, 38008, 38010, 38011, 38012, 38013, 38014, 38023, 38024, 38025, 38026, 38027, 38028, 38029, 38030, 38031, 38032, 38033, 38034, 38035, 38036, 38037, 38039, 38040, 38041, 38042, 38043, 38044, 38045, 38046, 38047, 38048, 38049, 38051, 38053, 38054, 38055, 38056, 38057, 38068, 38070, 38071, 38072, 38073, 38080, 38081, 38083, 38084, 38085, 38086, 38087, 38088, 38092, 38093, 38094, 38095, 38096, 38097, 38098, 38100, 38101, 38102, 38103, 38104, 38105, 38106, 38107, 38108, 38109, 38110, 38111, 38112, 38114, 38115, 38116, 38117, 38118, 38126, 38127, 38128, 38129, 38130, 38131, 38132, 38133, 38134, 38135, 38137, 38138, 38140, 38141, 38142, 38143, 38144, 38145, 38146, 38147, 38148, 38149, 38150, 38151, 38152, 38153, 38154, 38155, 38156, 38157, 38169, 38170, 38171, 38172, 38173, 38174, 38176, 38177, 38178, 38181, 38187, 38188, 38189, 38190, 38191, 38194, 38195, 38196, 38197, 38198, 38202, 38204, 38206, 38207, 38208, 38212, 38213, 38214, 38217, 38218, 38219, 38220, 38221, 38222, 38223, 38224, 38226, 38227, 38228, 38230, 38231, 38232, 38237, 38238, 38239, 38240, 38241, 38242, 38250, 38251, 38252, 38257, 38258, 38259, 38260, 38261, 38262, 38263, 38264, 38266, 38267, 38268, 38269, 38273, 38274, 38281, 38284, 38292, 38293, 38295, 38302, 38303, 38305, 38318, 38319, 38321, 38322, 38323, 38324, 38325, 38326, 38330, 38332, 38333, 38334, 38335, 38336, 38337, 38338, 38339, 38340, 38341, 38342, 38343, 38344, 38345, 38346, 38347, 38348, 38349, 38350, 38351, 38353, 38354, 38355, 38356, 38357, 38358, 38359, 38360, 38361, 38362, 38363, 38364, 38365, 38366, 38367, 38368, 38369, 38370, 38371, 38372, 38373, 38374, 38375, 38376, 38379, 38380, 38381, 38382, 38383, 38384, 38386, 38393, 38396, 38397, 38398, 38399, 38400, 38401, 38402, 38403, 38404, 38405, 38406, 38407, 38408, 38409, 38410, 38411, 38412, 38413, 38414, 38415, 38416, 38417, 38418, 38419, 38420, 38421, 38422, 38424, 38425, 38426, 38433, 38434, 38435, 38436, 38437, 38438, 38439, 38440, 38441, 38452, 38453, 38454, 38455, 38456, 38457, 38458, 38459, 38460, 38461, 38462, 38463, 38464, 38465, 38467, 38473, 38477, 38483, 38498, 38504, 38505, 38510, 38512, 38513, 38514, 38515, 38516, 38517, 38519, 38520, 38521, 38522, 38523, 38528, 38529, 38530, 38531, 38532, 38533, 38534, 38535, 38536, 38537, 38538, 38540, 38541, 38542, 38543, 38544, 38551, 38552, 38553, 38555, 38556, 38557, 38558, 38559, 38560, 38561, 38562, 38563, 38564, 38566, 38573, 38574, 38575, 38579, 38581, 38583, 38584, 38585, 38586, 38588, 38589, 38590, 38591, 38592, 38600, 38601, 38607, 38610, 38611, 38613, 38614, 38615, 38616, 38617, 38618, 38619, 38620, 38621, 38622, 38623, 38624, 38627, 38631, 38632, 38633, 38637, 38638, 38639, 38640, 38642, 38643, 38645, 38646, 38647, 38648, 38649, 38650, 38651, 38653, 38654, 38655, 38656, 38657, 38659, 38660, 38661, 38662, 38663, 38664, 38665, 38666, 38667, 38668, 38669, 38670, 38671, 38672, 38673, 38674, 38675, 38676, 38677, 38678, 38679, 38680, 38681, 38682, 38684, 38686, 38687, 38688, 38689, 38695, 38696, 38697, 38698, 38699, 38700, 38701, 38703, 38705, 38706, 38707, 38708, 38709, 38710, 38711, 38712, 38713, 38714, 38715, 38716, 38717, 38718, 38719, 38726, 38727, 38728, 38729, 38730, 38731, 38732, 38733, 38734, 38735, 38736, 38737, 38739, 38741, 38743, 38744, 38745, 38746, 38747, 38748, 38749, 38750, 38751, 38752, 38753, 38754, 38755, 38756, 38757, 38758, 38759, 38760, 38761, 38762, 38763, 38764, 38765, 38766, 38767, 38768, 38769, 38770, 38771, 38772, 38773, 38774, 38775, 38776, 38777, 38778, 38779, 38780, 38781, 38782, 38783, 38784, 38785, 38786, 38787, 38788, 38789, 38790, 38791, 38792, 38793, 38794, 38795, 38796, 38797, 38798, 38799, 38800, 38801, 38802, 38803, 38804, 38805, 38806, 38807, 38808, 38809, 38810, 38811, 38812, 38813, 38814, 38815, 38816, 38817, 38818, 38819, 38820, 38821, 38822, 38823, 38824, 38825, 38826, 38827, 38828, 38829, 38830, 38831, 38832, 38833, 38834, 38835, 38836, 38837, 38838, 38839, 38840, 38841, 38842, 38843, 38844, 38845, 38846, 38847, 38848, 38849, 38850, 38851, 38852, 38853, 38854, 38855, 38856, 38857, 38858, 38859, 38860, 38861, 38862, 38863, 38864, 38865, 38866, 38867, 38868, 38869, 38870, 38871, 38872, 38873, 38874, 38875, 38876, 38877, 38878, 38879, 38880, 38881, 38882, 38883, 38884, 38885, 38886, 38887, 38888, 38889, 38890, 38891, 38892, 38893, 38894, 38895, 38896, 38897, 38898, 38899, 38900, 38901, 38902, 38903, 38904, 38905, 38906, 38907, 38908, 38909, 38910, 38911, 38912, 38913, 38914, 38915, 38917, 38918, 38919, 38920, 38921, 38922, 38923, 38924, 38925, 38926, 38927, 38928, 38929, 38930, 38931, 38932, 38933, 38934, 38935, 38936, 38937, 38938, 38939, 38940, 38941, 38942, 38943, 38944, 38945, 38946, 38947, 38948, 38949, 38950, 38951, 38953, 38954, 38955, 38956, 38957, 38958, 38959, 38960, 38961, 38962, 38963, 38964, 38965, 38966, 38967, 38968, 38969, 38970, 38971, 38972, 38973, 38974, 38975, 38976, 38977, 38978, 38979, 38980, 38981, 38982, 38983, 38984, 38985, 38986, 38987, 38988, 38989, 38990, 38991, 38992, 38993, 38994, 38995, 38996, 38997, 38998, 38999, 39000, 39001, 39002, 39003, 39004, 39005, 39006, 39010, 39011, 39013, 39015, 39016, 39017, 39018, 39019, 39020, 39021, 39022, 39023, 39025, 39026, 39027, 39028, 39029, 39030, 39031, 39033, 39034, 39035, 39036, 39038, 39040, 39041, 39043, 39044, 39045, 39046, 39047, 39048, 39049, 39050, 39051, 39052, 39053, 39054, 39055, 39056, 39057, 39058, 39059, 39060, 39062, 39063, 39064, 39065, 39066, 39068, 39070, 39072, 39073, 39074, 39075, 39076, 39077, 39078, 39079, 39080, 39081, 39082, 39083, 39084, 39085, 39086, 39087, 39088, 39089, 39090, 39091, 39092, 39093, 39094, 39095, 39096, 39097, 39098, 39099, 39100, 39102, 39104, 39105, 39108, 39109, 39110, 39112, 39113, 39114, 39115, 39116, 39117, 39118, 39119, 39120, 39121, 39124, 39125, 39127, 39128, 39129, 39130, 39131, 39132, 39133, 39134, 39135, 39136, 39138, 39139, 39140, 39141, 39142, 39143, 39144, 39146, 39150, 39151, 39152, 39153, 39154, 39156, 39157, 39158, 39159, 39160, 39161, 39162, 39164, 39165, 39166, 39167, 39168, 39169, 39170, 39171, 39172, 39173, 39174, 39175, 39176, 39177, 39178, 39179, 39180, 39181, 39182, 39183, 39187, 39188, 39189, 39190, 39191, 39192, 39193, 39194, 39195, 39196, 39197, 39198, 39199, 39200, 39201, 39202, 39203, 39204, 39205, 39206, 39207, 39208, 39209, 39210, 39211, 39212, 39213, 39215, 39216, 39217, 39218, 39219, 39220, 39221, 39222, 39223, 39224, 39225, 39226, 39227, 39228, 39229, 39230, 39231, 39232, 39233, 39234, 39235, 39236, 39237, 39238, 39239, 39240, 39241, 39242, 39243, 39244, 39245, 39246, 39247, 39248, 39249, 39250, 39251, 39252, 39253, 39254, 39255, 39256, 39257, 39258, 39259, 39260, 39261, 39262, 39264, 39265, 39266, 39267, 39268, 39269, 39270, 39271, 39272, 39273, 39274, 39275, 39276, 39277, 39278, 39279, 39280, 39281, 39282, 39283, 39284, 39285, 39291, 39292, 39293, 39294, 39295, 39296, 39297, 39298, 39299, 39301, 39303, 39305, 39306, 39307, 39308, 39309, 39310, 39311, 39313, 39314, 39315, 39316, 39317, 39318, 39319, 39320, 39322, 39323, 39324, 39326, 39327, 39328, 39329, 39330, 39331, 39332, 39333, 39334, 39335, 39336, 39337, 39338, 39339, 39340, 39341, 39342, 39343, 39344, 39345, 39346, 39347, 39348, 39349, 39350, 39351, 39353, 39354, 39355, 39356, 39357, 39358, 39360, 39361, 39362, 39363, 39365, 39366, 39367, 39368, 39369, 39371, 39372, 39373, 39374, 39375, 39376, 39377, 39378, 39379, 39380, 39383, 39385, 39386, 39387, 39388, 39389, 39390, 39391, 39392, 39393, 39394, 39395, 39396, 39397, 39398, 39399, 39400, 39401, 39402, 39403, 39404, 39405, 39406, 39407, 39408, 39409, 39411, 39412, 39413, 39414, 39415, 39416, 39417, 39418, 39419, 39420, 39421, 39422, 39423, 39424, 39425, 39426, 39427, 39428, 39429, 39430, 39431, 39432, 39433, 39434, 39435, 39436, 39437, 39438, 39439, 39441, 39442, 39443, 39444, 39445, 39446, 39448, 39449, 39450, 39451, 39452, 39453, 39454, 39455, 39457, 39458, 39459, 39461, 39462, 39463, 39464, 39465, 39466, 39467, 39468, 39469, 39470, 39471, 39472, 39473, 39474, 39475, 39478, 39479, 39480, 39481, 39482, 39483, 39484, 39485, 39486, 39487, 39488, 39489, 39490, 39491, 39492, 39493, 39494, 39495, 39496, 39497, 39498, 39499, 39500, 39501, 39502, 39503, 39504, 39505, 39506, 39507, 39508, 39509, 39510, 39512, 39513, 39514, 39515, 39516, 39517, 39518, 39519, 39520, 39521, 39522, 39523, 39524, 39525, 39528, 39529, 39530, 39531, 39532, 39533, 39534, 39535, 39536, 39538, 39539, 39540, 39541, 39542, 39543, 39544, 39545, 39546, 39547, 39548, 39549, 39550, 39551, 39552, 39553, 39554, 39555, 39556, 39557, 39558, 39559, 39560, 39561, 39562, 39563, 39564, 39565, 39566, 39567, 39568, 39569, 39570, 39571, 39572, 39573, 39574, 39575, 39576, 39577, 39578, 39579, 39580, 39581, 39582, 39583, 39588, 39589, 39590, 39591, 39592, 39593, 39594, 39595, 39596, 39597, 39598, 39599, 39601, 39602, 39603, 39604, 39605, 39606, 39607, 39608, 39609, 39610, 39611, 39612, 39613, 39614, 39615, 39616, 39617, 39618, 39619, 39620, 39621, 39622, 39623, 39624, 39625, 39626, 39627, 39628, 39629, 39630, 39631, 39632, 39633, 39634, 39635, 39636, 39637, 39638, 39639, 39640, 39641, 39642, 39643, 39644, 39645, 39646, 39647, 39648, 39649, 39650, 39651, 39652, 39653, 39654, 39655, 39657, 39664, 39665, 39666, 39667, 39668, 39669, 39670, 39671, 39672, 39673, 39674, 39675, 39676, 39678, 39679, 39680, 39681, 39682, 39683, 39684, 39685, 39686, 39688, 39689, 39690, 39691, 39692, 39693, 39694, 39695, 39696, 39697, 39700, 39701, 39702, 39703, 39704, 39706, 39707, 39708, 39709, 39710, 39711, 39712, 39713, 39714, 39715, 39716, 39717, 39718, 39719, 39720, 39721, 39722, 39723, 39724, 39725, 39726, 39727, 39728, 39729, 39730, 39731, 39732, 39733, 39734, 39735, 39737, 39738, 39739, 39740, 39747, 39748, 39756, 39757, 39758, 39759, 39760, 39761, 39762, 39763, 39764, 39765, 39766, 39767, 39768, 39770, 39771, 39772, 39773, 39774, 39775, 39776, 39777, 39778, 39779, 39780, 39781, 39782, 39783, 39784, 39785, 39786, 39787, 39788, 39789, 39790, 39791, 39792, 39793, 39794, 39795, 39796, 39797, 39798, 39799, 39800, 39801, 39802, 39803, 39804, 39805, 39806, 39807, 39808, 39809, 39810, 39811, 39812, 39814, 39815, 39816, 39817, 39818, 39820, 39821, 39822, 39823, 39824, 39825, 39826, 39827, 39829, 39830, 39831, 39833, 39834, 39835, 39836, 39837, 39838, 39839, 39840, 39841, 39842, 39843, 39844, 39845, 39846, 39847, 39848, 39849, 39850, 39851, 39852, 39853, 39854, 39855, 39856, 39857, 39858, 39859, 39860, 39861, 39862, 39863, 39864, 39865, 39866, 39867, 39868, 39869, 39870, 39871, 39872, 39873, 39874, 39875, 39876, 39877, 39878, 39880, 39881, 39882, 39883, 39886, 39887, 39888, 39889, 39890, 39891, 39893, 39894, 39895, 39896, 39897, 39899, 39900, 39903, 39904, 39905, 39906, 39907, 39908, 39909, 39910, 39911, 39912, 39914, 39915, 39916, 39917, 39918, 39919, 39920, 39927, 39932, 39933, 39934, 39935, 39936, 39937, 39938, 39939, 39940, 39941, 39942, 39943, 39944, 39945, 39946, 39947, 39948, 39949, 39950, 39951, 39952, 39953, 39954, 39955, 39956, 39957, 39958, 39959, 39960, 39961, 39962, 39963, 39964, 39965, 39966, 39967, 39968, 39969, 39970, 39973, 39974, 39975, 39976, 39977, 39978, 39979, 39980, 39981, 39982, 39983, 39984, 39985, 39986, 39987, 39988, 39989, 39990, 39991, 39992, 39995, 39996, 39997, 39998, 39999, 40000, 40001, 40002, 40003, 40004, 40005, 40006, 40007, 40008, 40009, 40010, 40011, 40012, 40013, 40014, 40015, 40016, 40017, 40018, 40019, 40020, 40021, 40022, 40023, 40024, 40025, 40026, 40027, 40028, 40029, 40030, 40031, 40032, 40033, 40034, 40035, 40036, 40037, 40038, 40039, 40040, 40041, 40042, 40043, 40044, 40045, 40046, 40047, 40048, 40049, 40050, 40051, 40052, 40053, 40054, 40055, 40056, 40057, 40058, 40059, 40060, 40061, 40062, 40063, 40064, 40065, 40066, 40067, 40068, 40069, 40070, 40071, 40072, 40073, 40074, 40075, 40076, 40077, 40078, 40079, 40080, 40081, 40082, 40083, 40084, 40085, 40086, 40087, 40088, 40089, 40090, 40091, 40092, 40093, 40094, 40095, 40096, 40097, 40098, 40099, 40100, 40101, 40102, 40103, 40104, 40105, 40106, 40107, 40108, 40109, 40111, 40112, 40113, 40114, 40115, 40116, 40117, 40118, 40119, 40120, 40121, 40122, 40123, 40124, 40125, 40126, 40127, 40128, 40129, 40130, 40131, 40132, 40133, 40134, 40135, 40136, 40137, 40138, 40139, 40140, 40141, 40142, 40143, 40144, 40145, 40146, 40147, 40148, 40149, 40150, 40151, 40152, 40153, 40154, 40155, 40156, 40157, 40158, 40159, 40160, 40161, 40162, 40163, 40164, 40165, 40166, 40167, 40168, 40169, 40170, 40171, 40172, 40173, 40174, 40175, 40176, 40177, 40178, 40179, 40180, 40181, 40182, 40184, 40185, 40186, 40187, 40188, 40189, 40190, 40191, 40192, 40193, 40194, 40195, 40196, 40197, 40198, 40199, 40200, 40201, 40202, 40203, 40204, 40205, 40206, 40207, 40208, 40209, 40210, 40211, 40212, 40213, 40214, 40215, 40216, 40217, 40232, 40233, 40234, 40235, 40236, 40237, 40238, 40239, 40240, 40241, 40242, 40243, 40244, 40245, 40246, 40247, 40248, 40249, 40250, 40251, 40252, 40253, 40254, 40255, 40256, 40257, 40258, 40259, 40260, 40261, 40262, 40263, 40264, 40265, 40266, 40267, 40268, 40269, 40270, 40271, 40272, 40273, 40274, 40275, 40277, 40278, 40279, 40280, 40281, 40282, 40283, 40284, 40285, 40286, 40287, 40288, 40289, 40290, 40291, 40292, 40293, 40294, 40295, 40296, 40297, 40298, 40299, 40300, 40301, 40302, 40303, 40304, 40305, 40306, 40315, 40316, 40317, 40318, 40319, 40320, 40321, 40322, 40323, 40324, 40325, 40326, 40327, 40328, 40329, 40330, 40331, 40332, 40333, 40334, 40335, 40336, 40337, 40338, 40339, 40340, 40341, 40342, 40343, 40344, 40345, 40346, 40347, 40348, 40349, 40350, 40351, 40352, 40353, 40356, 40357, 40358, 40359, 40360, 40361, 40362, 40363, 40364, 40365, 40366, 40367, 40368, 40369, 40370, 40371, 40372, 40373, 40374, 40375, 40376, 40377, 40378, 40379, 40380, 40381, 40382, 40383, 40384, 40385, 40386, 40387, 40388, 40390, 40391, 40392, 40393, 40394, 40395, 40396, 40397, 40398, 40399, 40400, 40401, 40402, 40403, 40404, 40405, 40406, 40407, 40408, 40409, 40410, 40411, 40412, 40414, 40415, 40416, 40417, 40418, 40419, 40420, 40421, 40422, 40423, 40424, 40425, 40426, 40427, 40428, 40429, 40430, 40431, 40432, 40433, 40437, 40438, 40439, 40445, 40446, 40447, 40448, 40449, 40450, 40451, 40453, 40454, 40455, 40456, 40457, 40458, 40459, 40460, 40461, 40462, 40463, 40465, 40466, 40467, 40468, 40469, 40470, 40471, 40472, 40473, 40474, 40475, 40476, 40477, 40483, 40484, 40486, 40488, 40489, 40490, 40491, 40493, 40494, 40495, 40496, 40497, 40499, 40500, 40502, 40503, 40504, 40505, 40506, 40507, 40508, 40509, 40510, 40511, 40512, 40513, 40514, 40515, 40516, 40517, 40518, 40519, 40520, 40521, 40522, 40523, 40524, 40525, 40526, 40527, 40528, 40529, 40530, 40531, 40532, 40533, 40536, 40539, 40541, 40543, 40544, 40545, 40546, 40547, 40548, 40549, 40550, 40551, 40552, 40554, 40555, 40556, 40557, 40558, 40559, 40560, 40561, 40562, 40563, 40564, 40565, 40566, 40567, 40568, 40569, 40570, 40571, 40572, 40573, 40574, 40575, 40576, 40577, 40578, 40579, 40580, 40581, 40582, 40583, 40584, 40585, 40586, 40587, 40588, 40589, 40590, 40591, 40592, 40594, 40600, 40602, 40603, 40610, 40611, 40612, 40613, 40614, 40615, 40616, 40617, 40618, 40619, 40620, 40621, 40622, 40623, 40624, 40625, 40626, 40627, 40628, 40629, 40630, 40631, 40632, 40633, 40634, 40635, 40636, 40637, 40638, 40639, 40640, 40641, 40642, 40643, 40645, 40652, 40653, 40666, 40668, 40669, 40670, 40671, 40672, 40673, 40674, 40675, 40676, 40678, 40679, 40680, 40681, 40682, 40683, 40684, 40685, 40686, 40687, 40688, 40689, 40690, 40691, 40692, 40693, 40694, 40695, 40696, 40697, 40698, 40699, 40700, 40701, 40702, 40703, 40704, 40705, 40706, 40707, 40708, 40709, 40710, 40711, 40712, 40713, 40714, 40715, 40716, 40717, 40718, 40719, 40720, 40721, 40722, 40723, 40724, 40726, 40728, 40730, 40731, 40732, 40733, 40734, 40735, 40736, 40737, 40738, 40739, 40740, 40741, 40742, 40743, 40744, 40745, 40746, 40747, 40748, 40749, 40750, 40751, 40752, 40753, 40755, 40756, 40757, 40758, 40767, 40768, 40769, 40771, 40772, 40773, 40775, 40778, 40779, 40780, 40781, 40782, 40783, 40784, 40785, 40786, 40797, 40798, 40799, 40801, 40802, 40803, 40804, 40805, 40806, 40816, 40817, 40818, 40819, 40820, 40821, 40823, 40824, 40825, 40836, 40837, 40838, 40840, 40841, 40842, 40844, 40845, 40846, 40856, 40857, 40858, 40859, 40860, 40861, 40862, 40863, 40864, 40865, 40877, 40878, 40879, 40880, 40887, 40888, 40892, 40893, 40895, 40896, 40897, 40898, 40899, 40900, 40901, 40902, 40903, 40904, 40905, 40906, 40908, 40909, 40912, 40913, 40914, 40915, 40916, 40917, 40918, 40919, 40920, 40921, 40922, 40923, 40924, 40925, 40926, 40930, 40931, 40932, 40936, 40937, 40938, 40942, 40943, 40944, 40946, 40947, 40948, 40949, 40950, 40951, 40952, 40953, 40954, 40955, 40956, 40957, 40958, 40959, 40960, 40961, 40962, 40966, 40969, 40970, 40971, 40972, 40973, 40974, 40975, 40982, 40986, 40987, 40988, 40989, 40990, 40991, 40998, 40999, 41000, 41004, 41005, 41006, 41010, 41011, 41012, 41016, 41017, 41018, 41023, 41024, 41025, 41026, 41030, 41031, 41032, 41036, 41037, 41041, 41042, 41043, 41047, 41048, 41049, 41050, 41054, 41058, 41059, 41063, 41064, 41068, 41069, 41073, 41074, 41078, 41079, 41080, 41084, 41085, 41086, 41092, 41094, 41095, 41096, 41097, 41098, 41099, 41100, 41101, 41102, 41103, 41104, 41105, 41106, 41107, 41108, 41109, 41110, 41112, 41113, 41114, 41115, 41116, 41117, 41119, 41120, 41121, 41122, 41123, 41124, 41126, 41127, 41128, 41129, 41130, 41131, 41132, 41134, 41135, 41136, 41140, 41141, 41142, 41146, 41148, 41149, 41150, 41154, 41155, 41156, 41160, 41161, 41162, 41163, 41164, 41165, 41166, 41167, 41168, 41169, 41170, 41171, 41172, 41173, 41174, 41179, 41181, 41182, 41183, 41184, 41185, 41186, 41187, 41188, 41189, 41190, 41191, 41192, 41193, 41194, 41195, 41196, 41197, 41198, 41202, 41203, 41204, 41208, 41209, 41210, 41214, 41215, 41216, 41223, 41224, 41228, 41229, 41233, 41234, 41238, 41239, 41240, 41241, 41242, 41243, 41245, 41248, 41249, 41250, 41251, 41252, 41253, 41254, 41255, 41257, 41258, 41260, 41262, 41264, 41265, 41266, 41267, 41268, 41269, 41270, 41271, 41272, 41273, 41274, 41278, 41279, 41280, 41284, 41285, 41286, 41290, 41291, 41292, 41296, 41297, 41301, 41302, 41303, 41307, 41308, 41309, 41313, 41314, 41315, 41319, 41320, 41324, 41325, 41326, 41330, 41331, 41332, 41333, 41334, 41335, 41336, 41337, 41338, 41339, 41340, 41341, 41344, 41345, 41346, 41347, 41348, 41349, 41350, 41351, 41352, 41353, 41354, 41355, 41356, 41357, 41359, 41361, 41362, 41363, 41366, 41367, 41368, 41369, 41372, 41373, 41375, 41376, 41377, 41378, 41379, 41380, 41381, 41382, 41383, 41384, 41385, 41386, 41387, 41388, 41389, 41390, 41391, 41392, 41393, 41394, 41395, 41396, 41397, 41398, 41399, 41400, 41401, 41424, 41426, 41427, 41428, 41429, 41430, 41431, 41432, 41433, 41434, 41435, 41436, 41437, 41438, 41439, 41440, 41441, 41442, 41443, 41444, 41445, 41446, 41447, 41448, 41449, 41450, 41451, 41452, 41453, 41454, 41455, 41456, 41457, 41458, 41459, 41460, 41461, 41462, 41463, 41464, 41465, 41466, 41467, 41468, 41469, 41470, 41471, 41472, 41473, 41474, 41475, 41476, 41477, 41478, 41479, 41480, 41481, 41482, 41483, 41484, 41485, 41486, 41487, 41488, 41489, 41490, 41491, 41492, 41493, 41494, 41495, 41496, 41497, 41498, 41499, 41500, 41501, 41502, 41503, 41504, 41505, 41506, 41507, 41508, 41509, 41510, 41511, 41512, 41513, 41514, 41515, 41516, 41517, 41518, 41519, 41520, 41521, 41522, 41523, 41524, 41525, 41526, 41527, 41528, 41529, 41530, 41531, 41532, 41533, 41534, 41535, 41536, 41537, 41538, 41539, 41540, 41541, 41542, 41543, 41544, 41545, 41546, 41547, 41548, 41549, 41550, 41551, 41552, 41553, 41554, 41555, 41556, 41557, 41558, 41559, 41560, 41561, 41562, 41563, 41564, 41565, 41566, 41567, 41568, 41569, 41570, 41571, 41572, 41573, 41574, 41575, 41576, 41577, 41578, 41579, 41580, 41581, 41582, 41584, 41585, 41586, 41587, 41588, 41589, 41590, 41591, 41592, 41593, 41594, 41595, 41596, 41597, 41598, 41599, 41600, 41601, 41602, 41603, 41604, 41607, 41608, 41609, 41610, 41611, 41612, 41614, 41615, 41616, 41620, 41624, 41628, 41629, 41633, 41634, 41638, 41639, 41643, 41644, 41645, 41646, 41647, 41648, 41649, 41653, 41654, 41658, 41659, 41660, 41664, 41665, 41666, 41670, 41671, 41675, 41676, 41677, 41681, 41682, 41686, 41687, 41688, 41689, 41690, 41692, 41693, 41694, 41696, 41697, 41698, 41699, 41701, 41702, 41703, 41704, 41705, 41706, 41707, 41708, 41709, 41710, 41711, 41712, 41713, 41714, 41718, 41720, 41721, 41722, 41723, 41724, 41725, 41726, 41727, 41728, 41729, 41730, 41731, 41732, 41733, 41734, 41735, 41736, 41737, 41738, 41739, 41740, 41741, 41742, 41743, 41744, 41745, 41746, 41750, 41751, 41752, 41753, 41754, 41755, 41756, 41757, 41758, 41759, 41760, 41761, 41762, 41763, 41765, 41766, 41770, 41771, 41772, 41776, 41790, 41791, 41792, 41793, 41794, 41795, 41796, 41797, 41798, 41799, 41800, 41801, 41802, 41803, 41805, 41806, 41807, 41808, 41809, 41810, 41812, 41813, 41814, 41815, 41816, 41817, 41818, 41819, 41820, 41821, 41822, 41824, 41825, 41826, 41827, 41828, 41829, 41830, 41831, 41835, 41839, 41843, 41844, 41845, 41846, 41847, 41848, 41849, 41850, 41851, 41852, 41853, 41857, 41858, 41862, 41863, 41867, 41868, 41872, 41873, 41877, 41878, 41879, 41880, 41884, 41888, 41890, 41891, 41892, 41896, 41897, 41900, 41901, 41902, 41905, 41907, 41908, 41911, 41912, 41913, 41914, 41918, 41919, 41920, 41924, 41925, 41926, 41930, 41931, 41932, 41933, 41937, 41938, 41939, 41943, 41944, 41945, 41949, 41950, 41951, 41956, 41957, 41958, 41962, 41963, 41964, 41968, 41969, 41970, 41974, 41975, 41976, 41984, 41985, 41986, 41987, 41988, 41989, 41990, 41991, 41992, 41995, 41996, 41997, 42000, 42001, 42002, 42003, 42004, 42007, 42008, 42009, 42010, 42013, 42014, 42015, 42016, 42019, 42020, 42021, 42022, 42023, 42024, 42025, 42026, 42027, 42028, 42029, 42030, 42031, 42032, 42033, 42055, 42056, 42057, 42058, 42059, 42060, 42061, 42062, 42063, 42064, 42065, 42066, 42067, 42068, 42083, 42084, 42088, 42092, 42093, 42094, 42095, 42096, 42097, 42098, 42099, 42100, 42101, 42102, 42103, 42104, 42105, 42106, 42107, 42108, 42109, 42110, 42111, 42112, 42113, 42114, 42115, 42122, 42123, 42128, 42129, 42130, 42131, 42132, 42138, 42142, 42143, 42144, 42145, 42146, 42148, 42149, 42150, 42151, 42152, 42153, 42154, 42155, 42156, 42157, 42158, 42159, 42160, 42162, 42163, 42164, 42170, 42171, 42172, 42173, 42175, 42176, 42177, 42178, 42183, 42184, 42185, 42187, 42188, 42203, 42204, 42206, 42207, 42208, 42212, 42213, 42214, 42215, 42216, 42217, 42218, 42219, 42220, 42221, 42222, 42223, 42224, 42225, 42226, 42227, 42231, 42232, 42236, 42237, 42241, 42242, 42246, 42247, 42248, 42252, 42253, 42254, 42255, 42259, 42260, 42264, 42265, 42269, 42270, 42274, 42275, 42279, 42280, 42284, 42285, 42289, 42290, 42294, 42295, 42296, 42297, 42298, 42299, 42300, 42301, 42302, 42303, 42304, 42305, 42306, 42307, 42308, 42309, 42310, 42311, 42312, 42313, 42314, 42315, 42316, 42317, 42321, 42322, 42326, 42327, 42331, 42332, 42336, 42337, 42338, 42339, 42340, 42341, 42343, 42344, 42345, 42346, 42351, 42352, 42356, 42359, 42360, 42361, 42362, 42363, 42365, 42368, 42369, 42370, 42371, 42372, 42373, 42374, 42375, 42376, 42377, 42378, 42382, 42383, 42384, 42388, 42389, 42390, 42394, 42395, 42396, 42397, 42398, 42399, 42400, 42401, 42402, 42403, 42404, 42405, 42406, 42407, 42408, 42409, 42410, 42411, 42412, 42413, 42414, 42415, 42416, 42417, 42418, 42419, 42420, 42421, 42422, 42423, 42424, 42425, 42428, 42429, 42430, 42431, 42432, 42433, 42434, 42435, 42436, 42438, 42439, 42440, 42441, 42442, 42443, 42444, 42445, 42446, 42447, 42448, 42449, 42450, 42453, 42454, 42455, 42456, 42457, 42458, 42459, 42460, 42461, 42462, 42463, 42464, 42465, 42466, 42467, 42468, 42469, 42470, 42471, 42472, 42473, 42475, 42476, 42479, 42480, 42481, 42482, 42484, 42485, 42489, 42490, 42494, 42495, 42499, 42500, 42501, 42502, 42508, 42510, 42511, 42512, 42513, 42517, 42518, 42519, 42523, 42524, 42525, 42529, 42530, 42531, 42535, 42536, 42537, 42541, 42542, 42545, 42546, 42549, 42550, 42551, 42552, 42553, 42554, 42555, 42556, 42557, 42558, 42559, 42563, 42564, 42568, 42569, 42570, 42574, 42575, 42576, 42577, 42578, 42582, 42583, 42587, 42588, 42593, 42594, 42595, 42596, 42597, 42601, 42602, 42606, 42607, 42611, 42612, 42613, 42614, 42618, 42619, 42620, 42624, 42640, 42641, 42642, 42643, 42644, 42645, 42646, 42647, 42648, 42649, 42650, 42651, 42652, 42653, 42679, 42700, 42701, 42702, 42723, 42724, 42725, 42726, 42727, 42728, 42729, 42730, 42731, 42732, 42733, 42734, 42735, 42736, 42737, 42738, 42739, 42740, 42741, 42742, 42743, 42744, 42745, 42746, 42747, 42748, 42749, 42750, 42751, 42752, 42753, 42754, 42758, 42760, 42761, 42762, 42763, 42765, 42766, 42767, 42768, 42769, 42770, 42772, 42774, 42777, 42778, 42779, 42780, 42781, 42782, 42783, 42784, 42785, 42786, 42787, 42788, 42789, 42790, 42791, 42792, 42793, 42794, 42795, 42796, 42797, 42798, 42799, 42800, 42801, 42802, 42803, 42804, 42805, 42806, 42807, 42808, 42809, 42810, 42811, 42812, 42813, 42814, 42815, 42816, 42817, 42818, 42819, 42820, 42821, 42822, 42823, 42824, 42825, 42826, 42827, 42828, 42829, 42830, 42831, 42832, 42833, 42834, 42835, 42836, 42837, 42838, 42839, 42840, 42841, 42842, 42843, 42844, 42845, 42846, 42847, 42848, 42849, 42850, 42851, 42852, 42857, 42858, 42859, 42860, 42861, 42862, 42863, 42864, 42865, 42866, 42867, 42868, 42869, 42870, 42871, 42872, 42874, 42876, 42877, 42878, 42879, 42880, 42881, 42882, 42883, 42884, 42887, 42888, 42889, 42890, 42891, 42892, 42893, 42894, 42895, 42896, 42897, 42898, 42899, 42900, 42901, 42902, 42903, 42904, 42905, 42906, 42907, 42908, 42909, 42910, 42911, 42912, 42913, 42914, 42915, 42916, 42917, 42918, 42922, 42926, 42927, 42928, 42930, 42931, 42942, 42943, 42944, 42945, 42946, 42947, 42948, 42949, 42950, 42951, 42952, 42954, 42955, 42956, 42957, 42958, 42959, 42960, 42961, 42962, 42963, 42964, 42965, 42966, 42967, 42968, 42969, 42970, 42971, 42972, 42973, 42974, 42984, 42985, 42986, 42988, 42991, 42992, 42993, 42994, 42995, 42996, 42997, 42998, 42999, 43000, 43001, 43002, 43004, 43005, 43006, 43007, 43009, 43010, 43011, 43012, 43013, 43015, 43016, 43018, 43019, 43020, 43021, 43022, 43023, 43024, 43025, 43026, 43027, 43028, 43029, 43030, 43031, 43032, 43033, 43034, 43035, 43036, 43037, 43039, 43059, 43084, 43085, 43086, 43087, 43088, 43089, 43090, 43094, 43095, 43096, 43099, 43100, 43101, 43102, 43103, 43104, 43105, 43106, 43107, 43108, 43109, 43115, 43116, 43117, 43118, 43119, 43120, 43121, 43122, 43123, 43124, 43125, 43126, 43127, 43128, 43129, 43130, 43131, 43132, 43133, 43134, 43135, 43136, 43137, 43138, 43139, 43140, 43141, 43142, 43143, 43144, 43145, 43146, 43147, 43148, 43149, 43150, 43151, 43153, 43154, 43155, 43156, 43157, 43158, 43159, 43160, 43161, 43162, 43163, 43164, 43165, 43166, 43167, 43168, 43169, 43171, 43172, 43173, 43174, 43176, 43177, 43178, 43179, 43180, 43181, 43182, 43183, 43184, 43185, 43186, 43187, 43188, 43189, 43190, 43191, 43192, 43193, 43194, 43195, 43197, 43198, 43200, 43201, 43202, 43203, 43204, 43206, 43207, 43208, 43209, 43210, 43211, 43212, 43213, 43214, 43215, 43217, 43218, 43225, 43228, 43229, 43230, 43231, 43232, 43233, 43234, 43235, 43236, 43237, 43238, 43239, 43240, 43241, 43242, 43243, 43244, 43245, 43246, 43247, 43248, 43249, 43250, 43251, 43252, 43253, 43255, 43256, 43257, 43258, 43259, 43260, 43261, 43262, 43263, 43264, 43265, 43266, 43268, 43269, 43270, 43271, 43272, 43273, 43274, 43275, 43276, 43277, 43278, 43279, 43280, 43281, 43282, 43283, 43284, 43285, 43286, 43287, 43288, 43289, 43290, 43291, 43297, 43298, 43299, 43300, 43305, 43306, 43307, 43308, 43309, 43310, 43311, 43312, 43313, 43314, 43315, 43316, 43317, 43318, 43319, 43320, 43322, 43323, 43324, 43327, 43331, 43332, 43334, 43335, 43336, 43338, 43339, 43340, 43342, 43343, 43344, 43345, 43346, 43347, 43348, 43350, 43351, 43352, 43353, 43354, 43355, 43356, 43357, 43358, 43359, 43360, 43361, 43362, 43363, 43364, 43365, 43366, 43367, 43368, 43369, 43370, 43371, 43372, 43373, 43374, 43375, 43376, 43377, 43378, 43379, 43380, 43381, 43382, 43385, 43386, 43387, 43388, 43389, 43390, 43391, 43392, 43393, 43394, 43395, 43396, 43397, 43398, 43399, 43400, 43401, 43402, 43403, 43404, 43405, 43406, 43407, 43408, 43409, 43410, 43411, 43412, 43413, 43414, 43415, 43416, 43417, 43418, 43419, 43420, 43421, 43422, 43423, 43424, 43425, 43426, 43427, 43428, 43429, 43430, 43431, 43432, 43433, 43434, 43435, 43436, 43437, 43438, 43439, 43440, 43441, 43442, 43443, 43444, 43445, 43446, 43447, 43448, 43449, 43450, 43451, 43452, 43453, 43454, 43455, 43456, 43457, 43458, 43459, 43461, 43462, 43463, 43464, 43465, 43466, 43467, 43469, 43470, 43471, 43472, 43473, 43478, 43480, 43481, 43482, 43484, 43485, 43488, 43490, 43491, 43492, 43493, 43494, 43495, 43497, 43498, 43499, 43500, 43501, 43502, 43505, 43506, 43507, 43508, 43509, 43510, 43511, 43512, 43513, 43515, 43517, 43518, 43519, 43520, 43521, 43522, 43523, 43524, 43526, 43527, 43528, 43529, 43533, 43534, 43535, 43536, 43537, 43538, 43539, 43541, 43542, 43543, 43544, 43545, 43546, 43547, 43548, 43549, 43550, 43551, 43552, 43553, 43554, 43556, 43557, 43558, 43559, 43560, 43561, 43562, 43563, 43564, 43565, 43566, 43567, 43568, 43569, 43570, 43571, 43572, 43574, 43575, 43576, 43577, 43582, 43583, 43584, 43585, 43586, 43587, 43588, 43589, 43590, 43591, 43592, 43593, 43594, 43595, 43597, 43600, 43601, 43608, 43609, 43610, 43611, 43615, 43616, 43622, 43624, 43626, 43627, 43628, 43629, 43630, 43631, 43632, 43633, 43634, 43635, 43636, 43637, 43638, 43639, 43640, 43641, 43643, 43644, 43645, 43646, 43647, 43650, 43652, 43653, 43654, 43655, 43656, 43657, 43658, 43659, 43660, 43661, 43662, 43663, 43664, 43665, 43666, 43667, 43668, 43669, 43670, 43671, 43672, 43673, 43674, 43675, 43676, 43677, 43678, 43679, 43680, 43681, 43682, 43683, 43684, 43685, 43686, 43687, 43688, 43689, 43690, 43691, 43693, 43694, 43695, 43696, 43697, 43698, 43699, 43701, 43702, 43703, 43704, 43705, 43706, 43707, 43708, 43709, 43710, 43711, 43712, 43713, 43714, 43715, 43716, 43717, 43718, 43719, 43720, 43721, 43722, 43723, 43724, 43725, 43726, 43821, 43823, 43824, 43825, 43826, 43827, 43828, 43829, 43830, 43831, 43832, 43833, 43834, 43835, 43836, 43837, 43838, 43839, 43840, 43841, 43842, 43843, 43844, 43845, 43846, 43847, 43849, 43850, 43851, 43852, 43853, 43854, 43855, 43856, 43857, 43858, 43859, 43860, 43861, 43862, 43863, 43864, 43865, 43866, 43867, 43868, 43869, 43870, 43871, 43872, 43873, 43874, 43875, 43876, 43877, 43879, 43880, 43881, 43882, 43883, 43884, 43885, 43888, 43889, 43890, 43891, 43892, 43893, 43894, 43896, 43897, 43898, 43899, 43900, 43903, 43904, 43905, 43906, 43907, 43908, 43909, 43910, 43911, 43912, 43913, 43914, 43915, 43916, 43917, 43918, 43919, 43920, 43921, 43923, 43924, 43925, 43926, 43927, 43928, 43929, 43930, 43931, 43932, 43933, 43934, 43935, 43937, 43939, 43940, 43941, 43942, 43943, 43944, 43945, 43946, 43947, 43948, 43950, 43951, 43952, 43953, 43954, 43955, 43956, 43958, 43961, 43962, 43966, 43968, 43969, 43970, 43971, 43972, 43973, 43974, 43975, 43976, 43977, 43978, 43979, 43980, 43981, 43982, 43983, 43984, 43986, 43987, 43988, 43989, 43990, 43991, 43992, 43993, 43994, 43995, 43996, 43997, 43998, 44000, 44001, 44002, 44003, 44004, 44005, 44006, 44007, 44008, 44009, 44010, 44011, 44012, 44013, 44014, 44015, 44016, 44017, 44018, 44019, 44020, 44021, 44022, 44023, 44024, 44025, 44026, 44027, 44028, 44029, 44030, 44031, 44032, 44033, 44034, 44035, 44036, 44037, 44038, 44039, 44040, 44041, 44042, 44043, 44044, 44045, 44046, 44047, 44048, 44049, 44050, 44051, 44052, 44053, 44054, 44055, 44057, 44058, 44059, 44060, 44061, 44062, 44063, 44064, 44065, 44066, 44067, 44068, 44069, 44071, 44072, 44073, 44074, 44075, 44076, 44077, 44078, 44080, 44081, 44082, 44084, 44086, 44087, 44088, 44089, 44091, 44092, 44093, 44094, 44095, 44096, 44097, 44098, 44099, 44100, 44101, 44102, 44103, 44104, 44105, 44106, 44107, 44108, 44109, 44110, 44111, 44112, 44113, 44114, 44115, 44116, 44117, 44118, 44120, 44121, 44122, 44123, 44127, 44128, 44129, 44130, 44131, 44132, 44133, 44134, 44135, 44136, 44137, 44138, 44139, 44140, 44141, 44142, 44143, 44144, 44145, 44146, 44147, 44148, 44149, 44150, 44151, 44152, 44153, 44154, 44155, 44156, 44157, 44158, 44159, 44161, 44163, 44165, 44166, 44167, 44168, 44170, 44171, 44173, 44174, 44176, 44178, 44179, 44180, 44181, 44182, 44183, 44184, 44185, 44186, 44187, 44188, 44189, 44190, 44192, 44193, 44194, 44195, 44196, 44197, 44198, 44199, 44200, 44201, 44202, 44203, 44204, 44205, 44206, 44207, 44208, 44210, 44211, 44212, 44213, 44214, 44215, 44216, 44217, 44218, 44219, 44220, 44221, 44222, 44223, 44224, 44225, 44226, 44228, 44229, 44230, 44231, 44234, 44235, 44239, 44240, 44241, 44242, 44243, 44244, 44245, 44246, 44247, 44248, 44249, 44250, 44251, 44253, 44256, 44257, 44258, 44259, 44260, 44261, 44262, 44263, 44264, 44265, 44266, 44267, 44268, 44269, 44270, 44271, 44272, 44273, 44274, 44275, 44276, 44277, 44278, 44279, 44280, 44281, 44282, 44283, 44284, 44285, 44286, 44287, 44288, 44289, 44290, 44291, 44292, 44293, 44294, 44295, 44296, 44297, 44301, 44302, 44303, 44304, 44305, 44306, 44307, 44308, 44309, 44310, 44311, 44312, 44313, 44314, 44315, 44316, 44317, 44318, 44319, 44320, 44321, 44322, 44323, 44324, 44325, 44326, 44327, 44328, 44329, 44330, 44331, 44332, 44334, 44335, 44336, 44337, 44338, 44339, 44340, 44341, 44342, 44343, 44344, 44345, 44346, 44347, 44348, 44349, 44350, 44351, 44352, 44353, 44354, 44355, 44356, 44357, 44358, 44359, 44360, 44361, 44362, 44363, 44364, 44365, 44366, 44367, 44368, 44369, 44370, 44371, 44372, 44373, 44374, 44375, 44376, 44377, 44378, 44379, 44380, 44381, 44382, 44383, 44384, 44385, 44386, 44387, 44388, 44391, 44392, 44393, 44394, 44395, 44396, 44397, 44398, 44399, 44400, 44401, 44402, 44403, 44404, 44405, 44406, 44407, 44408, 44409, 44410, 44411, 44412, 44413, 44415, 44416, 44417, 44418, 44419, 44420, 44429, 44430, 44431, 44432, 44433, 44434, 44435, 44436, 44437, 44438, 44440, 44441, 44442, 44443, 44444, 44445, 44446, 44447, 44448, 44449, 44450, 44451, 44452, 44453, 44455, 44456, 44457, 44458, 44459, 44460, 44461, 44462, 44463, 44464, 44465, 44466, 44467, 44468, 44469, 44470, 44471, 44472, 44473, 44474, 44475, 44476, 44477, 44478, 44479, 44480, 44481, 44482, 44483, 44484, 44485, 44486, 44487, 44488, 44489, 44490, 44491, 44492, 44493, 44494, 44495, 44496, 44497, 44498, 44499, 44500, 44501, 44502, 44503, 44504, 44506, 44507, 44508, 44509, 44510, 44511, 44512, 44513, 44514, 44515, 44516, 44517, 44518, 44519, 44520, 44521, 44522, 44523, 44524, 44525, 44526, 44527, 44528, 44529, 44530, 44531, 44532, 44533, 44534, 44535, 44536, 44537, 44538, 44539, 44540, 44541, 44542, 44543, 44544, 44545, 44546, 44547, 44548, 44549, 44550, 44551, 44552, 44553, 44554, 44555, 44556, 44557, 44558, 44559, 44560, 44561, 44562, 44565, 44566, 44567, 44569, 44570, 44571, 44573, 44574, 44575, 44576, 44577, 44579, 44581, 44582, 44583, 44584, 44585, 44586, 44587, 44588, 44589, 44590, 44591, 44592, 44593, 44594, 44595, 44596, 44597, 44600, 44602, 44605, 44606, 44607, 44608, 44609, 44610, 44612, 44613, 44614, 44615, 44616, 44617, 44618, 44621, 44622, 44623, 44625, 44626, 44631, 44632, 44635, 44636, 44637, 44638, 44639, 44640, 44641, 44642, 44643, 44644, 44645, 44647, 44648, 44649, 44650, 44651, 44652, 44653, 44654, 44655, 44656, 44657, 44658, 44659, 44660, 44661, 44662, 44663, 44664, 44665, 44666, 44667, 44668, 44669, 44670, 44671, 44672, 44673, 44674, 44675, 44676, 44677, 44678, 44679, 44680, 44681, 44682, 44683, 44684, 44685, 44686, 44687, 44688, 44689, 44690, 44691, 44692, 44693, 44694, 44695, 44696, 44697, 44698, 44700, 44701, 44702, 44704, 44708, 44709, 44710, 44711, 44713, 44714, 44716, 44717, 44718, 44719, 44721, 44723, 44724, 44725, 44728, 44729, 44732, 44734, 44735, 44736, 44737, 44738, 44739, 44740, 44741, 44742, 44743, 44745, 44746, 44747, 44748, 44749, 44750, 44751, 44752, 44753, 44754, 44756, 44757, 44758, 44759, 44762, 44763, 44764, 44765, 44766, 44767, 44768, 44769, 44770, 44771, 44772, 44773, 44774, 44775, 44776, 44777, 44778, 44779, 44780, 44781, 44782, 44783, 44784, 44789, 44790, 44808 };*/
            StringBuilder strIDs = new StringBuilder();
            int count = 0;
            DateTime start = DateTime.Now;
            foreach (int id in knownIds)
            {
                Item item = GetItem(id);
                //Item item = ProcessItem(line);
                if (item != null)
                {
                    ItemCache.DeleteItem(ItemCache.FindItemById(item.Id));
                    ItemCache.AddItem(item, false);
                    strIDs.Append(id.ToString() + ", ");
                }
                count++;
                TimeSpan time = DateTime.Now.Subtract(start);
                double perSec = (double)count / time.TotalSeconds;
                System.Diagnostics.Debugger.Log(1, "", count.ToString() + "/" + knownIds.Length.ToString()+ " " + ((double)(knownIds.Length - count) / perSec).ToString() +"\r\n");
            }			
            ItemCache.OnItemsChanged();
        }

        public static Item ProcessItem(string itemData)
        {
            string data = itemData.Replace("[,{","[{");
            string id = data.Substring(0, data.IndexOf(','));
            data = data.Substring(data.IndexOf(',') + 1);
            string name = string.Empty;
            if (data.StartsWith("\""))
            {
                name = data.Substring(1, data.IndexOf("\",") - 1);
            }
            else
            {
                name = data.Substring(0, data.IndexOf(','));
            }
            data = data.Replace(name, "").TrimStart('"').TrimStart(',');
            string quality = data.Substring(0, data.IndexOf(','));
            data = data.Substring(data.IndexOf(',') + 2);

            string json1 = data.Substring(0, data.IndexOf("\",")).Replace(",subclass:",".").Replace(",armor:",",armorDUPE:");
            data = data.Substring(data.IndexOf("\",") + 2);
            string json2 = data.Trim('"');//string.IsNullOrEmpty(data) ? string.Empty : data.Substring(1, data.IndexOf('"'));

            string source = string.Empty;
            if (json1.Contains("source:["))
            {
                source = json1.Substring(json1.IndexOf("source:[") + "source:[".Length);
                source = source.Substring(0, source.IndexOf("]"));
                json1 = json1.Replace(string.Format("source:[{0}]", source), "source:[SOURCE]");
            }

            string sourcemore = string.Empty;
            if (json1.Contains("sourcemore:[{"))
            {
                sourcemore = json1.Substring(json1.IndexOf("sourcemore:[{") + "sourcemore:[{".Length);
                sourcemore = sourcemore.Substring(0, sourcemore.IndexOf("}]"));
                json1 = json1.Replace(sourcemore, "SOURCEMORE");
            }

            Item item = new Item() { 
                Id = int.Parse(id),
                Name = name, 
                Quality = (ItemQuality)int.Parse(quality),
                IconPath = string.Empty,
                Stats = new Stats()
            };
            //item.Stats += GetAdditionalItemEffect(item._id);

            if ((int)item.Quality < 2) return null;

            foreach (string keyval in (json1 + "," + json2).Split(','))
            {
                if (!string.IsNullOrEmpty(keyval))
                {
                    string[] keyvalsplit = keyval.Split(':');
                    string key = keyvalsplit[0];
                    string val = keyvalsplit[1];
                    if (ProcessKeyValue(item, key, val) && !json1.Contains("classs:3.")) 
                        return null;
                }
            }
            if (item.Slot == ItemSlot.None) return null;
            if (!string.IsNullOrEmpty(source)) ProcessKeyValue(item, "source", source);
            if (!string.IsNullOrEmpty(sourcemore))
            {
                string n = string.Empty;
                if (sourcemore.Contains("n:'"))
                {
                    n = sourcemore.Substring(sourcemore.IndexOf("n:'") + "n:'".Length);
                    n = n.Substring(0, n.IndexOf("'"));
                    if (!string.IsNullOrEmpty(n))
                        sourcemore = sourcemore.Replace(n, "N");
                }

                foreach (string keyval in sourcemore.Replace("},", ",").Replace(",{", ",").Split(','))
                {
                    if (!string.IsNullOrEmpty(keyval))
                    {
                        string[] keyvalsplit = keyval.Split(':');
                        string key = keyvalsplit[0];
                        string val = keyvalsplit[1];
                        ProcessKeyValue(item, key, val);
                    }
                }
                if (!string.IsNullOrEmpty(n)) ProcessKeyValue(item, "n", n);
            }
            if (item.Quality == ItemQuality.Uncommon && item.Stats <= new Stats() { Armor = 99999, AttackPower = 99999, SpellPower = 99999, BlockValue = 99999 }) return null; //Filter out random suffix greens
            return item;
        }

        private class TokenDropInfo
        {
            public string Boss;
            public string Area;
            public bool Heroic;
            public bool Container;
            public string Name;
        }
        /*private class UnkDropInfo
        {
            public string Boss;
            public string Area;
            public bool Heroic;
            public bool Container;
            public string Name;
        }*/

        static Dictionary<string, TokenDropInfo> _tokenDropMap = new Dictionary<string, TokenDropInfo>();
        //static Dictionary<string, UnkDropInfo> _UnkDropMap = new Dictionary<string, UnkDropInfo>();
        static Dictionary<string, string> _pvpTokenMap = new Dictionary<string, string>();
        static Dictionary<string, string> _vendorTokenMap = new Dictionary<string, string>();

        static Wowhead()
        {
            switch (Properties.GeneralSettings.Default.Locale)
            {
                /* Deutsche Übersetzungen noch einfügen */
                case "de":
                    _pvpTokenMap["20560"] = "Marque d'honneur de la vallée d'Alterac";
                    _pvpTokenMap["20559"] = "Marque d'honneur du bassin d'Arathi";
                    _pvpTokenMap["20558"] = "Marque d'honneur du goulet des Chanteguerres";
                    _pvpTokenMap["29024"] = "Marque d'honneur de l'Oeil du cyclone";
                    _pvpTokenMap["37836"] = "Pièce de la KapitalRisk";
                    _pvpTokenMap["42425"] = "Marque d'honneur du rivage des Anciens";
                    _pvpTokenMap["43589"] = "Marque d'honneur de Joug-d'hiver";

                    _vendorTokenMap["44990"] = "Sceau de champion";
                    _vendorTokenMap["40752"] = "Emblème d'héroïsme";
                    _vendorTokenMap["40753"] = "Emblème de vaillance";
                    _vendorTokenMap["45624"] = "Emblème de conquête";
                    break;

                default:
                    _pvpTokenMap["20560"] = "Alterac Valley Mark of Honor";
                    _pvpTokenMap["20559"] = "Arathi Basin Mark of Honor";
                    _pvpTokenMap["20558"] = "Warsong Gulch Mark of Honor";
                    _pvpTokenMap["29024"] = "Eye of the Storm Mark of Honor";
                    _pvpTokenMap["37836"] = "Venture Coin";
                    _pvpTokenMap["42425"] = "Strand of the Ancients Mark of Honor";
                    _pvpTokenMap["43589"] = "Wintergrasp Mark of Honor";

                    _vendorTokenMap["44990"] = "Champion's Seal";
                    _vendorTokenMap["40752"] = "Emblem of Heroism";
                    _vendorTokenMap["40753"] = "Emblem of Valor";
                    _vendorTokenMap["45624"] = "Emblem of Conquest";
                    _vendorTokenMap["47241"] = "Emblem of Triumph";
                    _vendorTokenMap["47242"] = "Trophy of the Crusade";
                    _vendorTokenMap["49426"] = "Emblem of Frost";
                    break;
            }
        }

        public static Item GetItem(int id) { return GetItem("www", id.ToString(), true); }
        public static Item GetItem(int id, bool filter) { return GetItem("www", id.ToString(), filter); }
        public static Item GetItem(int id, bool filter, string locale) { return GetItem(locale, id.ToString(), filter); }
        public static Item GetItem(string query, bool filter) { return GetItem("www", query, filter); }
        public static Item GetItem(string site, string query, bool filter)
        {
            if (site.Equals("en")) site = "www";
            WebRequestWrapper wrw = new WebRequestWrapper();
            XmlDocument docItem = wrw.DownloadItemWowhead(query);
            if (docItem == null || docItem.InnerXml.Contains("Item not found!")) return null;
            // the id from above can now be a name as well as the item number, so we regrab it from the data wowhead returned
            int id = 0;
            foreach (XmlNode node in docItem.SelectNodes("wowhead/item")) { id = int.Parse(node.Attributes["id"].Value); }
            Item item = new Item() { Id = id, Stats = new Stats() };
            string htmlTooltip = string.Empty;
            string json1s = string.Empty;
            string json2s = string.Empty;
            string repSource = string.Empty;
            string repLevel = string.Empty;

            #region Set Initial Data (Name, Quality, Unique, etc) and record the Tooltip, json & jsonequip sections
            foreach (XmlNode node in docItem.SelectNodes("wowhead/item/name")) { item.Name = node.InnerText; }
            foreach (XmlNode node in docItem.SelectNodes("wowhead/item/quality")) { item.Quality = (ItemQuality)int.Parse(node.Attributes["id"].Value); }
            foreach (XmlNode node in docItem.SelectNodes("wowhead/item/icon")) { item.IconPath = node.InnerText; }
            foreach (XmlNode node in docItem.SelectNodes("wowhead/item/htmlTooltip")) { htmlTooltip = node.InnerText; }
            foreach (XmlNode node in docItem.SelectNodes("wowhead/item/json")) { json1s = node.InnerText; }
            foreach (XmlNode node in docItem.SelectNodes("wowhead/item/jsonEquip")) { json2s = node.InnerText; }
            if (htmlTooltip.Contains("Unique")) item.Unique = true;

            #endregion

            // On Load items from Wowhead Filter, we don't want any
            // items that aren't at least Epic quality
            if (filter && (int)item.Quality < 2) { return null; }

            #region Item Binding

            // 06.jan.2010: Bind status check
            if (htmlTooltip.Contains("Binds when picked up"))
                item.Bind = BindsOn.BoP;
            else
                if (htmlTooltip.Contains("Binds when equipped"))
                    item.Bind = BindsOn.BoE;
                else
                    if (htmlTooltip.Contains("Binds to account"))
                        item.Bind = BindsOn.BoA;
                    else
                        if (htmlTooltip.Contains("Binds when used"))
                            item.Bind = BindsOn.BoU;


            #endregion

            Dictionary<string, object> json;

            try
            {
                json = JsonParser.Merge(JsonParser.Parse(json1s), JsonParser.Parse(json2s));
            }
            catch
            {
                return null;
            }

            #region Process json & jsonequip
            object tmp;
            // Pull Faction Info
            //,reqfaction:1073,reqrep:6
            if (json.TryGetValue("reqfaction", out tmp))
            {
                repSource = tmp.ToString();
            }
            if (json.TryGetValue("reqrep", out tmp))
            {
                repLevel = tmp.ToString();
            }
            if (json.TryGetValue("displayid", out tmp)) //A 3d display ID# for each icon
            {
                item.DisplayId = (int)tmp;
            }
            if (json.TryGetValue("slotbak", out tmp)) //A couple slots actually have two possible slots... ie vests and robes both fit in chest. slotbak distinguishes vests from robes. We don't care for Rawr, so ignored.
            {
                item.DisplaySlot = (int)tmp; // it is also used for the 3d display slot id
            }
            if (json.TryGetValue("level", out tmp)) //Rawr now handles item levels
            {
                item.ItemLevel = (int)tmp;
            }
            if (json.TryGetValue("slot", out tmp))
            {
                int slot = (int)tmp;
                if (slot != 0)
                {
                    item.Slot = GetItemSlot(slot);
                }
            }
            if (json.TryGetValue("classs", out tmp))
            {
                string c = tmp.ToString();
                if (json.TryGetValue("subclass", out tmp))
                {
                    c = c + "." + tmp.ToString();
                }
                if (c.StartsWith("1.") || c.StartsWith("12."))
                {
                }
                else if (c.StartsWith("3."))
                {
                    item.Type = ItemType.None;
                    switch (c)
                    {
                        case "3.0": item.Slot = ItemSlot.Red; break;
                        case "3.1": item.Slot = ItemSlot.Blue; break;
                        case "3.2": item.Slot = ItemSlot.Yellow; break;
                        case "3.3": item.Slot = ItemSlot.Purple; break;
                        case "3.4": item.Slot = ItemSlot.Green; break;
                        case "3.5": item.Slot = ItemSlot.Orange; break;
                        case "3.6": item.Slot = ItemSlot.Meta; break;
                        case "3.8": item.Slot = ItemSlot.Prismatic; break;
                    }
                }
                else
                {
                    item.Type = GetItemType(c);
                }
            }
            if (json.TryGetValue("speed", out tmp))
            {
                item.Speed = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("dmgmin1", out tmp))
            {
                item.MinDamage = (int)Math.Floor(Convert.ToSingle(tmp));
            }
            if (json.TryGetValue("dmgmax1", out tmp))
            {
                item.MaxDamage = (int)Math.Ceiling(Convert.ToSingle(tmp));
            }
            if (json.TryGetValue("dmgtype1", out tmp))
            {
                item.DamageType = (ItemDamageType)(int)tmp;
            }
            if (json.TryGetValue("armor", out tmp))
            {
                item.Stats.Armor = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("armorbonus", out tmp))
            {
                item.Stats.Armor -= Convert.ToSingle(tmp);
                item.Stats.BonusArmor = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("healthrgn", out tmp))
            {
                item.Stats.Hp5 += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("manargn", out tmp))
            {
                item.Stats.Mp5 += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("health", out tmp))
            {
                item.Stats.Health += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("agi", out tmp))
            {
                item.Stats.Agility += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("int", out tmp))
            {
                item.Stats.Intellect += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("spi", out tmp))
            {
                item.Stats.Spirit += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("sta", out tmp))
            {
                item.Stats.Stamina += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("str", out tmp))
            {
                item.Stats.Strength += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("hastertng", out tmp) || json.TryGetValue("mlehastertng", out tmp) || json.TryGetValue("rgdhastertng", out tmp) || json.TryGetValue("splhastertng", out tmp))
            {
                item.Stats.HasteRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("splpwr", out tmp) || json.TryGetValue("splheal", out tmp) || json.TryGetValue("spldmg", out tmp))
            {
                item.Stats.SpellPower += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("critstrkrtng", out tmp) || json.TryGetValue("mlecritstrkrtng", out tmp) || json.TryGetValue("rgdcritstrkrtng", out tmp) || json.TryGetValue("splcritstrkrtng", out tmp))
            {
                item.Stats.CritRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("firres", out tmp))
            {
                item.Stats.FireResistance += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("natres", out tmp))
            {
                item.Stats.NatureResistance += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("frores", out tmp))
            {
                item.Stats.FrostResistance += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("shares", out tmp))
            {
                item.Stats.ShadowResistance += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("arcres", out tmp))
            {
                item.Stats.ArcaneResistance += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("hitrtng", out tmp) || json.TryGetValue("mlehitrtng", out tmp) || json.TryGetValue("rgdhitrtng", out tmp) || json.TryGetValue("splhitrtng", out tmp))
            {
                item.Stats.HitRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("atkpwr", out tmp) || json.TryGetValue("mleatkpwr", out tmp))
            {
                item.Stats.AttackPower += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("rgdatkpwr", out tmp))
            {
                if (item.Stats.AttackPower != Convert.ToSingle(tmp))
                {
                    item.Stats.RangedAttackPower = Convert.ToSingle(tmp);
                }
            }
            if (json.TryGetValue("block", out tmp))
            {
                item.Stats.BlockValue += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("exprtng", out tmp))
            {
                item.Stats.ExpertiseRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("defrtng", out tmp))
            {
                item.Stats.DefenseRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("dodgertng", out tmp))
            {
                item.Stats.DodgeRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("blockrtng", out tmp))
            {
                item.Stats.BlockRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("socket1", out tmp))
            {
                item.SocketColor1 = GetSocketType(tmp.ToString());
            }
            if (json.TryGetValue("socket2", out tmp))
            {
                item.SocketColor2 = GetSocketType(tmp.ToString());
            }
            if (json.TryGetValue("socket3", out tmp))
            {
                item.SocketColor3 = GetSocketType(tmp.ToString());
            }
            if (json.TryGetValue("socketbonus", out tmp))
            {
                item.SocketBonus = GetSocketBonus(tmp.ToString());
            }
            if (json.TryGetValue("parryrtng", out tmp))
            {
                item.Stats.ParryRating += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("classes", out tmp))
            {
                    List<string> requiredClasses = new List<string>();
                    int classbitfield = (int)tmp;
                    if ((classbitfield & 1) > 0)
                        requiredClasses.Add("Warrior");
                    if ((classbitfield & 2) > 0)
                        requiredClasses.Add("Paladin");
                    if ((classbitfield & 4) > 0)
                        requiredClasses.Add("Hunter");
                    if ((classbitfield & 8) > 0)
                        requiredClasses.Add("Rogue");
                    if ((classbitfield & 16) > 0)
                        requiredClasses.Add("Priest");
                    if ((classbitfield & 32) > 0)
                        requiredClasses.Add("Death Knight");
                    if ((classbitfield & 64) > 0)
                        requiredClasses.Add("Shaman");
                    if ((classbitfield & 128) > 0)
                        requiredClasses.Add("Mage");
                    if ((classbitfield & 256) > 0)
                        requiredClasses.Add("Warlock");
                    //if ((classbitfield & 512) > 0) ; // Only seems to occur in PvP gear, along with another huge value
                    //    requiredClasses.Add("");
                    if ((classbitfield & 1024) > 0)
                        requiredClasses.Add("Druid");
                    item.RequiredClasses = string.Join("|", requiredClasses.ToArray());
            }
            if (json.TryGetValue("resirtng", out tmp))
            {
                item.Stats.Resilience += Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("armorpen", out tmp) || json.TryGetValue("armorpenrtng", out tmp))
            {
                item.Stats.ArmorPenetrationRating = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("splpen", out tmp))
            {
                item.Stats.SpellPenetration = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("mana", out tmp))
            {
                item.Stats.Mana = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("dmg", out tmp))
            {
                item.Stats.WeaponDamage = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("frospldmg", out tmp))
            {
                item.Stats.SpellFrostDamageRating = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("shaspldmg", out tmp))
            {
                item.Stats.SpellShadowDamageRating = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("firspldmg", out tmp))
            {
                item.Stats.SpellFireDamageRating = Convert.ToSingle(tmp);
            }
            if (json.TryGetValue("arcspldmg", out tmp))
            {
                item.Stats.SpellArcaneDamageRating = Convert.ToSingle(tmp);
            }
            #endregion

            // We don't need to process any more data if it's not a slottable item (eg not Gear/Gem)
            if (item.Slot == ItemSlot.None) return null;

            #region Item Source
            if (json.TryGetValue("source", out tmp))
            {
                object[] sourceArr = (object[])tmp;
                object[] sourcemoreArr = null;
                if (json.TryGetValue("sourcemore", out tmp))
                {
                    sourcemoreArr = (object[])tmp;
                }

                #region We have Source Data

                // most mobs that have a vendor bought alternative will give more information through the vendor than the mob
                // this is specially case for vault of archavon drops
                int source = (int)sourceArr[0];
                Dictionary<string, object> sourcemore = null;
                if (sourcemoreArr != null && sourcemoreArr.Length > 0)
                {
                    sourcemore = (Dictionary<string, object>)sourcemoreArr[0];
                }

                int vendorIndex = Array.IndexOf(sourceArr, 5);
                if (vendorIndex >= 0)
                {
                    source = (int)sourceArr[vendorIndex];
                    if (sourcemoreArr != null && sourcemoreArr.Length > vendorIndex)
                    {
                        sourcemore = (Dictionary<string, object>)sourcemoreArr[vendorIndex];
                    }
                }

                string n = string.Empty;
                if (sourcemore != null && sourcemore.TryGetValue("n", out tmp))
                {
                    n = tmp.ToString();
                }

                string itemId = item.Id.ToString();
                if (source == 2 && sourcemore == null)
                {
                    #region Didn't work
                    /*// We don't have SourceMore data so let's see if the web page has what we need
                    // If not, call it a World Drop
                    string name = null;
                    string boss = null;
                    string area = null;
                    bool heroic = false;
                    bool container = false;
                    try {
                        //if (!_UnkDropMap.ContainsKey(itemId)) {
                            XmlDocument docToken = wrw.DownloadItemHtmlWowhead(itemId);

                            string tokenJson = docToken.SelectSingleNode("wowhead/item/json").InnerText;

                            string tokenSource = string.Empty;
                            if (tokenJson.Contains("source:[")) {
                                tokenSource = tokenJson.Substring(tokenJson.IndexOf("source:[") + "source:[".Length);
                                tokenSource = tokenSource.Substring(0, tokenSource.IndexOf("]"));
                            }

                            string tokenSourcemore = string.Empty;
                            if (tokenJson.Contains("sourcemore:[{")) {
                                tokenSourcemore = tokenJson.Substring(tokenJson.IndexOf("sourcemore:[{") + "sourcemore:[{".Length);
                                tokenSourcemore = tokenSourcemore.Substring(0, tokenSourcemore.IndexOf("}]"));
                            }

                            if (!string.IsNullOrEmpty(tokenSource) && !string.IsNullOrEmpty(tokenSourcemore)) {
                                string[] tokenSourceKeys = tokenSource.Split(',');
                                string[] tokenSourcemoreKeys = tokenSourcemore.Split(new string[] { "},{" }, StringSplitOptions.RemoveEmptyEntries);

                                // for tokens we prefer loot info, we don't care if it can be bought with badges
                                tokenSource = tokenSourceKeys[0];
                                tokenSourcemore = tokenSourcemoreKeys[0];

                                int dropIndex = Array.IndexOf(tokenSourceKeys, "2");
                                if (dropIndex >= 0) {
                                    tokenSource = tokenSourceKeys[dropIndex];
                                    tokenSourcemore = tokenSourcemoreKeys[dropIndex];
                                }

                                if (tokenSource == "2") {
                                    foreach (string kv in tokenSourcemore.Split(',')) {
                                        if (!string.IsNullOrEmpty(kv)) {
                                            string[] keyvalsplit = kv.Split(':');
                                            string key = keyvalsplit[0];
                                            string val = keyvalsplit[1];
                                            switch (key) {
                                                case "t":
                                                    container = val == "2" || val == "3";
                                                    break;
                                                case "n":       // NPC 'Name'
                                                    boss = val.Replace("\\'", "'").Trim('\'');
                                                    break;
                                                case "z":       // Zone
                                                    area = GetZoneName(val);
                                                    break;
                                                case "dd":      // Dungeon Difficulty (1 = Normal, 2 = Heroic)
                                                    heroic = val == "2";
                                                    break;
                                            }
                                        }
                                    }
                                }
                            }
                            if (boss == null) { boss = "Unknown Boss (Wowhead lacks data)"; }
                            _UnkDropMap[itemId] = new UnkDropInfo() { Boss = boss, Area = area, Heroic = heroic, Name = itemId, Container = container };
                            if (area != null) {
                                #region This is a Dropped Item, so assign it to where it drops from
                                if (container) {
                                    ItemLocation locInfo = new ContainerItem()
                                    {
                                        Area = area,
                                        Container = boss,
                                        Heroic = heroic
                                    };
                                    LocationFactory.Add(item.Id.ToString(), locInfo);
                                } else {
                                    ItemLocation locInfo = new StaticDrop()
                                    {
                                        Area = area,
                                        Boss = boss,
                                        Heroic = heroic
                                    };
                                    LocationFactory.Add(item.Id.ToString(), locInfo);
                                }
                                #endregion
                            } else {
                                // World Drop dat crap, until we can find a better solution
                                WorldDrop locInfo = new WorldDrop();
                                LocationFactory.Add(item.Id.ToString(), locInfo);
                            }
                        /*} else {
                            UnkDropInfo info = _UnkDropMap[itemId];
                            boss = info.Boss;
                            area = info.Area;
                            heroic = info.Heroic;
                            name = info.Name;
                            container = info.Container;
                            if (area != null) {
                                #region This is a Dropped Item, so assign it to where it drops from
                                if (container) {
                                    ItemLocation locInfo = new ContainerItem()
                                    {
                                        Area = area,
                                        Container = boss,
                                        Heroic = heroic
                                    };
                                    LocationFactory.Add(item.Id.ToString(), locInfo);
                                } else {
                                    ItemLocation locInfo = new StaticDrop()
                                    {
                                        Area = area,
                                        Boss = boss,
                                        Heroic = heroic
                                    };
                                    LocationFactory.Add(item.Id.ToString(), locInfo);
                                }
                                #endregion
                            } else {
                                // World Drop dat crap, until we can find a better solution
                                WorldDrop locInfo = new WorldDrop();
                                LocationFactory.Add(item.Id.ToString(), locInfo);
                            }
                        }*/
                    #endregion
                    /*} catch (Exception ex) {
                        Rawr.Base.ErrorBox eb = new Rawr.Base.ErrorBox("Error getting drop data from wowhead",
                            ex.Message, "GetItem(...)", "", ex.StackTrace);*/
                    // World Drop dat crap, until we can find a better solution
                    WorldDrop locInfo = new WorldDrop();
                    LocationFactory.Add(item.Id.ToString(), locInfo);
                    /*}*/
                }
                else if (source == 5)
                {
                    // if we only have vendor information then we will want to download
                    // the normal html page and scrape the currency information
                    // and in case it is a token, link it to the boss/zone where the token drops
                    #region Vendor Related
                    string[] tokenIds = { null, null };
                    int[] tokenCounts = { 0, 0 };
                    string[] tokenNames = { null, null };
                    int cost = 0;
                    #region Try to get the Token Names and individual costs
                    try
                    {
                        XmlDocument rawHtmlDoc = wrw.DownloadItemHtmlWowhead(query);
                        if (rawHtmlDoc != null)
                        {
                            int startpos = rawHtmlDoc.InnerXml.IndexOf("new Listview({template: 'npc', id: 'sold-by'");
                            if (startpos > 1)
                            {
                                int endpos = rawHtmlDoc.InnerXml.IndexOf(";", startpos);
                                string text = rawHtmlDoc.InnerXml.Substring(startpos, endpos - startpos);
                                // we are looking for something like cost:[0,0,0,[[40633,1]]]

                                int costIndex = text.IndexOf("cost:[");
                                if (costIndex >= 0)
                                {
                                    string costtext = text.Substring(costIndex + 6);
                                    // get the monetary cost
                                    cost = int.Parse(costtext.Substring(0, costtext.IndexOfAny(new char[] { ',', ']' }, 0)));
                                    // get the token and count out
                                    int tokenIndex = costtext.IndexOf("[[", 0);
                                    if (tokenIndex >= 0)
                                    {
                                        int tokenEnd = costtext.IndexOf("]]", tokenIndex);
                                        string tokentext = costtext.Substring(tokenIndex + 1, tokenEnd - tokenIndex);
                                        if (tokentext.Contains("],["))
                                        {
                                            string[] tokens = tokentext.Split(',');
                                            tokenIds[0] = tokens[0].Trim('[');
                                            tokenCounts[0] = int.Parse(tokens[1].Trim(']'));

                                            tokenIds[1] = tokens[2].Trim('[');
                                            tokenCounts[1] = int.Parse(tokens[3].Trim(']'));
                                            /*string[] token1 = tokentext.Substring(1, 8).Split(',');
                                            string[] token2 = tokentext.Substring(12, 8).Split(',');
                                            tokenIds[0] = token1[0]; tokenCounts[0] = int.Parse(token1[1].Trim('[').Trim(']'));
                                            tokenIds[1] = token2[0]; tokenCounts[1] = int.Parse(token2[1].Trim('[').Trim(']'));*/
                                        }
                                        else
                                        {
                                            string[] token = costtext.Substring(tokenIndex + 2, tokenEnd - tokenIndex - 2).Split(',');
                                            tokenIds[0] = token[0];
                                            tokenCounts[0] = int.Parse(token[1]);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    catch { }
                    #endregion
                    VendorItem vendorItem = new VendorItem()
                    {
                        Cost = cost,
                    };
                    for (int i = 0; i < 2; i++)
                    {
                        if (i == 1 && tokenIds[i] == null) { continue; } // break out if we're one 2 and there's only 1 or for some reason there's 0
                        if (tokenIds[i] != null && _pvpTokenMap.TryGetValue(tokenIds[i], out tokenNames[i]))
                        {
                            #region It's a PvP Token: Mark of Honor/Venture Coin
                            ItemLocation locInfo = new PvpItem()
                            {
                                TokenCount = tokenCounts[i],
                                TokenType = tokenNames[i]
                            };
                            LocationFactory.Add(item.Id.ToString(), locInfo);
                            vendorItem = null;
                            break;
                            #endregion
                        }
                        else if (tokenIds[i] != null && _vendorTokenMap.TryGetValue(tokenIds[i], out tokenNames[i]))
                        {
                            #region It's a PvE Token that we've seen before and it's from a Vendor
                            vendorItem.TokenMap[tokenNames[i]] = tokenCounts[i];
                            #endregion
                        }
                        else if (tokenIds[i] != null)
                        {
                            #region It's a PvE Token that is not from a Vendor
                            // ok now let's see what info we can get about this token
                            string boss = null;
                            string area = null;
                            bool heroic = false;
                            bool container = false;
                            if (!_tokenDropMap.ContainsKey(tokenIds[i]))
                            {
                                #region We *really* haven't seen this before so we need to pull the data
                                XmlDocument docToken = wrw.DownloadItemWowhead(tokenIds[i]);
                                if (docToken != null)
                                {
                                    tokenNames[i] = docToken.SelectSingleNode("wowhead/item/name").InnerText;

                                    // we don't want token => boss propagation anymore, otherwise you get weird stuff like 277 gloves dropping from Toravon
                                    /*string tokenJson = docToken.SelectSingleNode("wowhead/item/json").InnerText;

                                    string tokenSource = string.Empty;
                                    if (tokenJson.Contains("\"source\":["))
                                    {
                                        tokenSource = tokenJson.Substring(tokenJson.IndexOf("\"source\":[") + "\"source\":[".Length);
                                        tokenSource = tokenSource.Substring(0, tokenSource.IndexOf("]"));
                                    }

                                    string tokenSourcemore = string.Empty;
                                    if (tokenJson.Contains("\"sourcemore\":[{"))
                                    {
                                        tokenSourcemore = tokenJson.Substring(tokenJson.IndexOf("\"sourcemore\":[{") + "\"sourcemore\":[{".Length);
                                        tokenSourcemore = tokenSourcemore.Substring(0, tokenSourcemore.IndexOf("}]"));
                                    }

                                    if (!string.IsNullOrEmpty(tokenSource) && !string.IsNullOrEmpty(tokenSourcemore))
                                    {
                                        string[] tokenSourceKeys = tokenSource.Split(',');
                                        string[] tokenSourcemoreKeys = tokenSourcemore.Split(new string[] { "},{" }, StringSplitOptions.RemoveEmptyEntries);

                                        // for tokens we prefer loot info, we don't care if it can be bought with badges
                                        tokenSource = tokenSourceKeys[0];
                                        tokenSourcemore = tokenSourcemoreKeys[0];

                                        int dropIndex = Array.IndexOf(tokenSourceKeys, "2");
                                        if (dropIndex >= 0)
                                        {
                                            tokenSource = tokenSourceKeys[dropIndex];
                                            tokenSourcemore = tokenSourcemoreKeys[dropIndex];
                                        }

                                        if (tokenSource == "2")
                                        {
                                            foreach (string kv in tokenSourcemore.Split(','))
                                            {
                                                if (!string.IsNullOrEmpty(kv))
                                                {
                                                    string[] keyvalsplit = kv.Split(':');
                                                    string key = keyvalsplit[0];
                                                    string val = keyvalsplit[1];
                                                    switch (key.Trim('"'))
                                                    {
                                                        case "t":
                                                            container = val == "2" || val == "3";
                                                            break;
                                                        case "n":       // NPC 'Name'
                                                            boss = val.Replace("\\'", "'").Trim('"');
                                                            break;
                                                        case "z":       // Zone
                                                            area = GetZoneName(val);
                                                            break;
                                                        case "dd":      // Dungeon Difficulty (1 = Normal, 2 = Heroic)
                                                            heroic = val == "2";
                                                            break;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    if (boss == null) 
                                    { 
                                        //boss = "Unknown Boss (Wowhead lacks data)";
                                        area = null; // if boss is null prefer treating this as pve token
                                    }*/
                                    if (tokenNames[i] != null)
                                    {
                                        _tokenDropMap[tokenIds[i]] = new TokenDropInfo() { Boss = boss, Area = area, Heroic = heroic, Name = tokenNames[i], Container = container };
                                    }
                                }
                                #endregion
                            }
                            else
                            {
                                #region We've seen this before so just use that data
                                TokenDropInfo info = _tokenDropMap[tokenIds[i]];
                                boss = info.Boss;
                                area = info.Area;
                                heroic = info.Heroic;
                                tokenNames[i] = info.Name;
                                container = info.Container;
                                #endregion
                            }
                            if (area != null)
                            {
                                #region This is a Dropped Token, so assign it to where it drops from
                                if (container)
                                {
                                    ItemLocation locInfo = new ContainerItem()
                                    {
                                        Area = area,
                                        Container = boss,
                                        Heroic = heroic
                                    };
                                    LocationFactory.Add(item.Id.ToString(), locInfo);
                                    vendorItem = null;
                                    break;
                                }
                                else
                                {
                                    ItemLocation locInfo = new StaticDrop()
                                    {
                                        Area = area,
                                        Boss = boss,
                                        Heroic = heroic
                                    };
                                    LocationFactory.Add(item.Id.ToString(), locInfo);
                                    vendorItem = null;
                                    break;
                                }
                                #endregion
                            }
                            else if (tokenNames[i] != null)
                            {
                                #region This is NOT a Dropped Token, so treat it as a normal vendor item and include token info
                                vendorItem.TokenMap[tokenNames[i]] = tokenCounts[i];
                                #endregion
                            }
                            else /*if (tokenNames[i] == null)*/
                            {
                                // there was an error pulling token data from web
                                // ignore source information 
                                vendorItem = null;
                                break;
                            }
                            #endregion
                        }
                        else
                        {
                            #region There is no token so this is a normal vendor item
                            if (!string.IsNullOrEmpty(repSource) && !string.IsNullOrEmpty(repLevel))
                            {
                                string[] repInfo = GetItemFactionVendorInfo(repSource, repLevel);
                                FactionItem locInfo = new FactionItem()
                                {
                                    FactionName = repInfo[0],
                                    Level = (ReputationLevel)int.Parse(repLevel), // repInfo[3]
                                    Cost = cost,
                                };
                                LocationFactory.Add(item.Id.ToString(), locInfo);
                                vendorItem = null;
                                break;
                            }
                            else
                            {
                                VendorItem locInfo = new VendorItem()
                                {
                                    Cost = cost,
                                };
                                if (!string.IsNullOrEmpty(n)) locInfo.VendorName = n;
                                if (sourcemore != null && sourcemore.TryGetValue("z", out tmp))
                                {
                                    locInfo.VendorArea = GetZoneName(tmp.ToString());
                                }
                                LocationFactory.Add(item.Id.ToString(), locInfo);
                                vendorItem = null;
                                break;
                            }
                            #endregion
                        }
                    }
                    if (vendorItem != null)
                    {
                        if (!string.IsNullOrEmpty(n)) vendorItem.VendorName = n;
                        if (sourcemore != null && sourcemore.TryGetValue("z", out tmp))
                        {
                            vendorItem.VendorArea = GetZoneName(tmp.ToString());
                        }
                        LocationFactory.Add(item.Id.ToString(), vendorItem);
                    }
                    #endregion
                }
                else
                {
                    #region Process any other Sources
                    if (sourcemore != null)
                    {
                        if (sourcemore.TryGetValue("t", out tmp))
                        {
                            /*
                            #define CTYPE_NPC            1
                            #define CTYPE_OBJECT         2
                            #define CTYPE_ITEM           3
                            #define CTYPE_ITEMSET        4
                            #define CTYPE_QUEST          5
                            #define CTYPE_SPELL          6
                            #define CTYPE_ZONE           7
                            #define CTYPE_FACTION        8
                            #define CTYPE_PET            9
                            #define CTYPE_ACHIEVEMENT    10
                            */
                            switch ((int)tmp)
                            {
                                case 1: //Dropped by a mob...
                                    StaticDrop staticDrop = StaticDrop.Construct() as StaticDrop;
                                    if (sourcemore.TryGetValue("n", out tmp))
                                    {
                                        staticDrop.Boss = tmp.ToString();
                                    }
                                    if (sourcemore.TryGetValue("z", out tmp) || sourcemore.TryGetValue("c", out tmp))
                                    {
                                        staticDrop.Area = GetZoneName(tmp.ToString());
                                    }
                                    if (sourcemore.TryGetValue("dd", out tmp))
                                    {
                                        string value = tmp.ToString();
                                        staticDrop.Heroic = (value == "-2" || value == "3" || value == "4");
                                        staticDrop.Area += (value == "1" || value == "3" ) ? " (10)" : ( (value == "2" || value == "4") ? " (25)" : string.Empty  );
                                    }
                                    LocationFactory.Add(item.Id.ToString(), staticDrop);
                                    break;

                                case 2: //Found in a container object
                                    ContainerItem containerItem = ContainerItem.Construct() as ContainerItem;
                                    if (sourcemore.TryGetValue("n", out tmp))
                                    {
                                        containerItem.Container = tmp.ToString();
                                    }
                                    if (sourcemore.TryGetValue("z", out tmp) || sourcemore.TryGetValue("c", out tmp))
                                    {
                                        containerItem.Area = GetZoneName(tmp.ToString());
                                    }
                                    if (sourcemore.TryGetValue("dd", out tmp))
                                    {
                                        string value = tmp.ToString();
                                        containerItem.Heroic = (value == "-2" || value == "3" || value == "4");
                                        containerItem.Area += (value == "1" || value == "3" ) ? " (10)" : ( (value == "2" || value == "4") ? " (25)" : string.Empty  );
                                    }
                                    LocationFactory.Add(item.Id.ToString(), containerItem);
                                    break;
                                
                                case 5: //Rewarded from a quest...
                                    QuestItem questName = QuestItem.Construct() as QuestItem;
                                    if (sourcemore.TryGetValue("ti", out tmp))
                                    {
                                        WebRequestWrapper wrwti = new WebRequestWrapper();
                                        string questItem = wrwti.DownloadQuestWowhead(tmp.ToString());
                                        if (questItem != null && !questItem.Contains("This quest doesn't exist or is not yet in the database."))
                                        {
                                            int levelStart = questItem.IndexOf("<div>Required level: ") + 21;
                                            if (levelStart == 20)
                                            {
                                                levelStart = questItem.IndexOf("<div>Requires level ") + 20;
                                            }
                                            if (levelStart > 19)
                                            {
                                                int levelEnd = questItem.IndexOf("</div>", levelStart);
                                                string level = questItem.Substring(levelStart, levelEnd - levelStart);
                                                if (level == "??")
                                                {
                                                    levelStart = questItem.IndexOf("<div>Level: ") + 12;
                                                    levelEnd = questItem.IndexOf("</div>", levelStart);
                                                    questName.MinLevel = int.Parse(questItem.Substring(levelStart, levelEnd - levelStart));
                                                }
                                                else
                                                {
                                                    questName.MinLevel = int.Parse(level);
                                                }
                                            }

                                            int typeStart = questItem.IndexOf("<div>Type: ") + 11;
                                            if (typeStart > 10)
                                            {
                                                int typeEnd = questItem.IndexOf("</div>", typeStart);
                                                switch (questItem.Substring(typeStart, typeEnd - typeStart))
                                                {
                                                    case "Group":
                                                        int partyStart = questItem.IndexOf("Suggested Players [") + 19;
                                                        if (partyStart > 18)
                                                        {
                                                            int partyEnd = questItem.IndexOf("]", partyStart);
                                                            questName.Party = int.Parse(questItem.Substring(partyStart, partyEnd - partyStart));
                                                        }
                                                        break;

                                                    case "Dungeon": questName.Type = "d"; break;
                                                    case "Raid": questName.Type = "r"; break;
                                                    default: questName.Type = ""; break;
                                                }
                                            }
                                        }
                                    }
                                    if (sourcemore.TryGetValue("n", out tmp))
                                    {
                                        questName.Quest = tmp.ToString();
                                    }
                                    if (sourcemore.TryGetValue("z", out tmp) || sourcemore.TryGetValue("c", out tmp))
                                    {
                                        questName.Area = GetZoneName(tmp.ToString());
                                    }
                                    LocationFactory.Add(item.Id.ToString(), questName);
                                    break;

                                case 6: //Crafted by a profession...
                                    CraftedItem craftedItem = CraftedItem.Construct() as CraftedItem;
                                    if (sourcemore.TryGetValue("n", out tmp))
                                    {
                                        craftedItem.SpellName = tmp.ToString();
                                    }
                                    if (sourcemore.TryGetValue("z", out tmp))
                                    {
                                        craftedItem.Skill = GetZoneName(tmp.ToString());
                                    }
                                    if (sourcemore.TryGetValue("s", out tmp))
                                    {
                                        string profession = "";
                                        switch (Properties.GeneralSettings.Default.Locale)
                                        {
                                            case "fr":
                                                switch (tmp.ToString())
                                                {
                                                    case "171": profession = "Alchimie"; break;
                                                    case "164": profession = "Forge"; break;
                                                    case "333": profession = "Enchantement"; break;
                                                    case "202": profession = "Ingénierie"; break;
                                                    case "182": profession = "Herboristerie"; break;
                                                    case "773": profession = "Calligraphie"; break;
                                                    case "755": profession = "Joaillerie"; break;
                                                    case "165": profession = "Travail du cuir"; break;
                                                    case "186": profession = "Minage"; break;
                                                    case "393": profession = "Dépeçage"; break;
                                                    case "197": profession = "Couture"; break;

                                                    default:
                                                        "".ToString();
                                                        break;
                                                }
                                                break;

                                            default:
                                        switch (tmp.ToString())
                                        {
                                            case "171": profession = "Alchemy"; break;
                                            case "164": profession = "Blacksmithing"; break;
                                            case "333": profession = "Enchanting"; break;
                                            case "202": profession = "Engineering"; break;
                                            case "182": profession = "Herbalism"; break;
                                            case "773": profession = "Inscription"; break;
                                            case "755": profession = "Jewelcrafting"; break;
                                            case "165": profession = "Leatherworking"; break;
                                            case "186": profession = "Mining"; break;
                                            case "393": profession = "Skinning"; break;
                                            case "197": profession = "Tailoring"; break;

                                            default:
                                                "".ToString();
                                                break;
                                        }
                                                break;
                                        }
                                        if (!string.IsNullOrEmpty(profession)) craftedItem.Skill = profession;
                                    }
                                    LocationFactory.Add(item.Id.ToString(), craftedItem);
                                    break;

                                default:
                                    break;
                            }
                        }
                        if (sourcemore.TryGetValue("p", out tmp))
                        {
                            LocationFactory.Add(item.Id.ToString(), PvpItem.Construct());
                            (item.LocationInfo[0] as PvpItem).Points = 0;
                            (item.LocationInfo[0] as PvpItem).PointType = "PvP";
                        }
                    }
                    #endregion
                }
                #endregion
            }
            else if (item.Stats.Resilience > 0)
            {
                // We DON'T have Source Data, BUT the item has resilience on it, so it's a pvp item
                PvpItem locInfo = new PvpItem();
                //locInfo.
                LocationFactory.Add(item.Id.ToString(), locInfo);
            }
            else
            {
                // We DON'T have Source Data
                // Since we are doing nothing, the ItemSource cache doesn't change
                // Therefore the original ItemSource persists, if it's there
            }
            #endregion

            #region Meta Gem Effects
            if (item.Slot == ItemSlot.Meta)
            {
                if (htmlTooltip.Contains("<span class=\"q1\">") && htmlTooltip.Contains("</span>"))
                {
                    string line = htmlTooltip.Substring(htmlTooltip.IndexOf("<span class=\"q1\">") + "<span class=\"q1\">".Length);
                    line = line.Substring(0, line.IndexOf("</span>"));
                    if (line.Contains("<a"))
                    {
                        {
                            int start = line.IndexOf("<a");
                            int end = line.IndexOf(">", start + 1);
                            line = line.Remove(start, end - start + 1);
                        }
                        {
                            int start = line.IndexOf("</a>");
                            line = line.Remove(start, 4);
                        }
                    }
                    SpecialEffects.ProcessMetaGem(line, item.Stats, false);
                }
                else throw (new Exception("Unhandled Metagem:\r\n" + item.Name));
            }
            #endregion

            // If it's Craftable and Bings on Pickup, mark it as such
            if (item.LocationInfo[0] is CraftedItem && (item.Bind == BindsOn.BoP))
            {
                (item.LocationInfo[0] as CraftedItem).Bind = BindsOn.BoP;
            }

            #region Special Effects
            List<string> useLines = new List<string>();
            List<string> equipLines = new List<string>();
            while (htmlTooltip.Contains("<span class=\"q2\">") && htmlTooltip.Contains("</span>"))
            {
                htmlTooltip = htmlTooltip.Substring(htmlTooltip.IndexOf("<span class=\"q2\">") + "<span class=\"q2\">".Length);
                string line = htmlTooltip.Substring(0, htmlTooltip.IndexOf("</span>"));

                // Remove Comments
                while (line.Contains("<!--"))
                {
                    int start = line.IndexOf("<!--");
                    int end = line.IndexOf("-->");
                    string toRemove = line.Substring(start, end - start + 3);
                    line = line.Replace(toRemove, "");
                }
                // Swap out to real spaces
                while (line.Contains("&nbsp;")) { line = line.Replace("&nbsp;", " "); }
                // Remove the Spell Links
                // Later we will instead USE the spell links but we aren't set up for that right now
                while (line.Contains("<a"))
                {
                    int start = line.IndexOf("<a");
                    int end = line.IndexOf(">");
                    string toRemove = line.Substring(start, end - start + 1);
                    line = line.Replace(toRemove, "");
                }
                while (line.Contains("</a>")) { line = line.Replace("</a>", ""); }
                // Remove the Small tags, we don't use those
                while (line.Contains("<small"))
                {
                    int start = line.IndexOf("<small>");
                    int end = line.IndexOf("</small>");
                    string toRemove = line.Substring(start, end - start + "</small>".Length);
                    line = line.Replace(toRemove, "");
                }
                // Remove double spaces
                while (line.Contains("  ")) { line = line.Replace("  ", " "); }
                // Swap out "sec." with "sec" as sometimes they
                // do and sometimes they don't, regex for both is annoying
                while (line.Contains("sec.")) { line = line.Replace("sec.", "sec"); }

                // Now Process it
                if (line.StartsWith("Equip: "))
                {
                    string equipLine = line.Substring("Equip: ".Length);
                    equipLines.Add(equipLine);
                }
                else if (line.StartsWith("Chance on hit: "))
                {
                    string chanceLine = line.Substring("Chance on hit: ".Length);
                    equipLines.Add(chanceLine);
                }
                else if (line.StartsWith("Use: "))
                {
                    string useLine = line.Substring("Use: ".Length);
                    useLines.Add(useLine);
                }
                htmlTooltip = htmlTooltip.Substring(line.Length + "</span>".Length);
            }
            foreach (string useLine in useLines) SpecialEffects.ProcessUseLine(useLine, item.Stats, false, item.Id);
            foreach (string equipLine in equipLines) SpecialEffects.ProcessEquipLine(equipLine, item.Stats, false, item.ItemLevel, item.Id);
            #endregion

            #region Armor vs Bonus Armor Fixes
            if (item.Slot == ItemSlot.Finger ||
                item.Slot == ItemSlot.MainHand ||
                item.Slot == ItemSlot.Neck ||
                (item.Slot == ItemSlot.OffHand && item.Type != ItemType.Shield) ||
                item.Slot == ItemSlot.OneHand ||
                item.Slot == ItemSlot.Trinket ||
                item.Slot == ItemSlot.TwoHand)
            {
                item.Stats.BonusArmor += item.Stats.Armor;
                item.Stats.Armor = 0f;
            }
            else if (item.Stats.Armor + item.Stats.BonusArmor == 0f)
            { //Fix for wowhead bug where guns/bows/crossbows show up with 0 total armor, but 24.5 (or some such) bonus armor (they really have no armor at all)
                item.Stats.Armor = 0;
                item.Stats.BonusArmor = 0;
            }
            #endregion

            #region Belongs to a Set
            if (htmlTooltip.Contains(" (0/"))
            {
                htmlTooltip = htmlTooltip.Substring(0, htmlTooltip.IndexOf("</a> (0/"));
                htmlTooltip = htmlTooltip.Substring(htmlTooltip.LastIndexOf(">") + 1);
                htmlTooltip = htmlTooltip.Replace("Wrathful ", "").Replace("Relentless ", "").Replace("Furious ", "").Replace("Deadly ", "").Replace("Hateful ", "").Replace("Savage ", "")
                    .Replace("Brutal ", "").Replace("Vengeful ", "").Replace("Merciless ", "").Replace("Valorous ", "")
                    .Replace("Heroes' ", "").Replace("Conqueror's ", "").Replace("Totally ", "").Replace("Triumphant ", "").Replace("Kirin'dor", "Kirin Tor").Replace("Regaila", "Regalia").Replace("Sanctified ", "");

                if (htmlTooltip.Contains("Sunstrider's") || htmlTooltip.Contains("Zabra's") ||
                    htmlTooltip.Contains("Gul'dan's") || htmlTooltip.Contains("Garona's") ||
                    htmlTooltip.Contains("Runetotem's") || htmlTooltip.Contains("Windrunner's Pursuit") ||
                    htmlTooltip.Contains("Thrall's") || htmlTooltip.Contains("Liadrin's") ||
                    htmlTooltip.Contains("Hellscream's") || htmlTooltip.Contains("Kolitra's") || htmlTooltip.Contains("Koltira's"))
                {
                    item.Faction = ItemFaction.Horde;
                }
                else if (htmlTooltip.Contains("Khadgar's") || htmlTooltip.Contains("Velen's") ||
                    htmlTooltip.Contains("Kel'Thuzad's") || htmlTooltip.Contains("VanCleef's") ||
                    htmlTooltip.Contains("Malfurion's") || htmlTooltip.Contains("Windrunner's Battlegear") ||
                    htmlTooltip.Contains("Nobundo's") || htmlTooltip.Contains("Turalyon's") ||
                    htmlTooltip.Contains("Wrynn's") || htmlTooltip.Contains("Thassarian's"))
                {
                    item.Faction = ItemFaction.Alliance;
                }

                // normalize alliance/horde set names
                htmlTooltip = htmlTooltip.Replace("Sunstrider's", "Khadgar's")   // Mage T9
                                         .Replace("Zabra's", "Velen's") // Priest T9
                                         .Replace("Gul'dan's", "Kel'Thuzad's") // Warlock T9
                                         .Replace("Garona's", "VanCleef's") // Rogue T9
                                         .Replace("Runetotem's", "Malfurion's") // Druid T9
                                         .Replace("Windrunner's Pursuit", "Windrunner's Battlegear") // Hunter T9
                                         .Replace("Thrall's", "Nobundo's") // Shaman T9
                                         .Replace("Liadrin's", "Turalyon's") // Paladin T9
                                         .Replace("Hellscream's", "Wrynn's") // Warrior T9
                                         .Replace("Koltira's", "Thassarian's")  // Death Knight T9
                                         .Replace("Kolitra's", "Thassarian's"); // Death Knight T9
                item.SetName = htmlTooltip.Trim();
            }
            #endregion

            // Filter out random suffix greens
            if (filter
                && item.Quality == ItemQuality.Uncommon
                && item.Stats <= new Stats() { Armor = 99999, AttackPower = 99999, SpellPower = 99999, BlockValue = 99999 })
            { return null; }

            return item;
        }

        private static List<string> _unhandledKeys = new List<string>();
        private static List<string> _unhandledSocketBonus = new List<string>();
        private static bool ProcessKeyValue(Item item, string key, string value)
        {
            switch (key.Trim('"'))
            {
                #region Item Info/Stat Keys
                case "id": //ID's are parsed out of the main data, not the json
                case "name": //Item names are parsed out of the main data, not the json
                case "subclass": //subclass is combined with class
                case "subsubclass": //Only used for Battle vs Guardian Elixirs
                case "buyprice": //Rawr doesn't care about buy...
                case "sellprice": //...and sell prices
                case "reqlevel": //Rawr assumes that you meet all level requirements
                case "dps": //Rawr calculates weapon dps based on min/max and speed
                case "maxcount": //Rawr doesn't deal with stack sizes
                case "dura": //durability isn't handled
                case "nsockets": //Rawr figures this out itself, Smart program.
                case "races": //Not worried about race restrictions
                case "source": //Handled below by individual keyvals
                case "sourcemore": //Handled below by individual keyvals
                case "nslots": //Don't care about bag sizes...
                case "avgmoney": //For containers, average amount of money inside
                case "glyph": //1=Major, 2=Minor
                    break;
                case "displayid": //A 3d display ID# for each icon
                    item.DisplayId = int.Parse(value);
                    break;
                case "slotbak": //A couple slots actually have two possible slots... ie vests and robes both fit in chest. slotbak distinguishes vests from robes. We don't care for Rawr, so ignored.
                    item.DisplaySlot = int.Parse(value); // it is also used for the 3d display slot id
                    break;
                case "level": //Rawr now handles item levels
                    item.ItemLevel = int.Parse(value);
                    break;
                    //TODO:
                case "cooldown": //Not handled yet
                case "skill": //Related to skill requirements
                case "reqskill": //Related to skill requirements
                case "reqskillrank": //Related to skill requirements
                case "reqrep": //reqrep=6: heroic 5 man, reqrep=1: heroic raid, reqrep=5: Arena, reqrep=4: Faction Friendly, reqrep=5: Faction Honored, etc
                case "reqfaction": //Currently faction & reputation is not handled.
                case "itemset": //Contains the itemset id... May want to parse this,
                case "reqspell": //Profession specialization requirements, like weaponcrafting, armorsmithing, etc
                    break;

                case "slot":
                    int slot = int.Parse(value);
                    if (slot == 0) return true; //Not Equippable
                    item.Slot = GetItemSlot(slot);
                    break;

                case "classs":
                    if (value.StartsWith("1.") || value.StartsWith("12.")) return true; //Container and Quest
                    if (value.StartsWith("3.")) {
                        item.Type = ItemType.None;
                        switch (value) {
                            case "3.0": item.Slot = ItemSlot.Red; break;
                            case "3.1": item.Slot = ItemSlot.Blue; break;
                            case "3.2": item.Slot = ItemSlot.Yellow; break;
                            case "3.3": item.Slot = ItemSlot.Purple; break;
                            case "3.4": item.Slot = ItemSlot.Green; break;
                            case "3.5": item.Slot = ItemSlot.Orange; break;
                            case "3.6": item.Slot = ItemSlot.Meta; break;
                            case "3.8": item.Slot = ItemSlot.Prismatic; break;
                        }
                    } else {
                        item.Type = GetItemType(value);
                    }
                    break;

                case "speed":
                    item.Speed = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "dmgmin1":
                    item.MinDamage += (int)float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "dmgmax1":
                    item.MaxDamage += (int)float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "dmgtype1":
                    item.DamageType = (ItemDamageType)int.Parse(value);
                    break;

                case "armor":
                    item.Stats.Armor = int.Parse(value);
                    break;

                case "armorbonus":
                    item.Stats.Armor -= float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    item.Stats.BonusArmor = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;
                
                case "healthrgn":
                    item.Stats.Hp5 += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "manargn":
                    item.Stats.Mp5 += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "health":
                    item.Stats.Health += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "agi":
                    item.Stats.Agility += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "int":
                    item.Stats.Intellect += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "spi":
                    item.Stats.Spirit += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "sta":
                    item.Stats.Stamina += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "str":
                    item.Stats.Strength += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "hastertng":
                case "mlehastertng":
                case "rgdhastertng":
                case "splhastertng":
                    item.Stats.HasteRating = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "splpwr":
                case "splheal":
                case "spldmg":
                    item.Stats.SpellPower = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "critstrkrtng":
                case "mlecritstrkrtng":
                case "rgdcritstrkrtng":
                case "splcritstrkrtng":
                    item.Stats.CritRating = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "holres":
                    break;

                case "firres":
                    item.Stats.FireResistance = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "natres":
                    item.Stats.NatureResistance = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "frores":
                    item.Stats.FrostResistance = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "shares":
                    item.Stats.ShadowResistance = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "arcres":
                    item.Stats.ArcaneResistance = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "hitrtng":
                case "mlehitrtng":
                case "rgdhitrtng":
                case "splhitrtng":
                    item.Stats.HitRating = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "atkpwr":
                case "mleatkpwr":
                //case "feratkpwr":
                    item.Stats.AttackPower += float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "rgdatkpwr":
                    if (item.Stats.AttackPower != float.Parse(value, System.Globalization.CultureInfo.InvariantCulture))
                        item.Stats.RangedAttackPower = float.Parse(value, System.Globalization.CultureInfo.InvariantCulture);
                    break;

                case "block":
                    item.Stats.BlockValue += int.Parse(value);
                    break;

                case "exprtng":
                    item.Stats.ExpertiseRating += int.Parse(value);
                    break;

                case "defrtng":
                    item.Stats.DefenseRating += int.Parse(value);
                    break;

                case "dodgertng":
                    item.Stats.DodgeRating += int.Parse(value);
                    break;

                case "blockrtng":
                    item.Stats.BlockRating += int.Parse(value);
                    break;

                case "socket1":
                    item.SocketColor1 = GetSocketType(value);
                    break;

                case "socket2":
                    item.SocketColor2 = GetSocketType(value);
                    break;

                case "socket3":
                    item.SocketColor3 = GetSocketType(value);
                    break;

                case "socketbonus":
                    item.SocketBonus = GetSocketBonus(value);
                    break;

                case "parryrtng":
                    item.Stats.ParryRating += int.Parse(value);
                    break;

                case "classes":
                    List<string> requiredClasses = new List<string>();
                    int classbitfield = int.Parse(value);
                    if ((classbitfield & 1) > 0)
                        requiredClasses.Add("Warrior");
                    if ((classbitfield & 2) > 0)
                        requiredClasses.Add("Paladin");
                    if ((classbitfield & 4) > 0)
                        requiredClasses.Add("Hunter");
                    if ((classbitfield & 8) > 0)
                        requiredClasses.Add("Rogue");
                    if ((classbitfield & 16) > 0)
                        requiredClasses.Add("Priest");
                    if ((classbitfield & 32) > 0)
                        requiredClasses.Add("Death Knight");
                    if ((classbitfield & 64) > 0)
                        requiredClasses.Add("Shaman");
                    if ((classbitfield & 128) > 0)
                        requiredClasses.Add("Mage");
                    if ((classbitfield & 256) > 0)
                        requiredClasses.Add("Warlock");
                    //if ((classbitfield & 512) > 0) ; // Only seems to occur in PvP gear, along with another huge value
                    //    requiredClasses.Add("");
                    if ((classbitfield & 1024) > 0)
                        requiredClasses.Add("Druid");
                    item.RequiredClasses = string.Join("|", requiredClasses.ToArray());
                    break;

                case "resirtng":
                    item.Stats.Resilience += int.Parse(value);
                    break;

                case "armorpen":
                case "armorpenrtng":
                    item.Stats.ArmorPenetrationRating = int.Parse(value);
                    break;
                
                case "splpen":
                    item.Stats.SpellPenetration = int.Parse(value);
                    break;

                case "mana":
                    item.Stats.Mana = int.Parse(value);
                    break;

                case "dmg":
                    item.Stats.WeaponDamage = int.Parse(value);
                    break;

                case "frospldmg":
                    item.Stats.SpellFrostDamageRating = int.Parse(value);
                    break;

                case "shaspldmg":
                    item.Stats.SpellShadowDamageRating = int.Parse(value);
                    break;

                case "firspldmg":
                    item.Stats.SpellFireDamageRating = int.Parse(value);
                    break;

                case "arcspldmg":
                    item.Stats.SpellArcaneDamageRating = int.Parse(value);
                    break;
                #endregion
                #region Source Keys
                case "t":   //Source Type
                    /*
                    #define CTYPE_NPC            1
                    #define CTYPE_OBJECT         2
                    #define CTYPE_ITEM           3
                    #define CTYPE_ITEMSET        4
                    #define CTYPE_QUEST          5
                    #define CTYPE_SPELL          6
                    #define CTYPE_ZONE           7
                    #define CTYPE_FACTION        8
                    #define CTYPE_PET            9
                    #define CTYPE_ACHIEVEMENT    10
                    */
                    switch (value)
                    {
                        case "1": //Dropped by a mob...
                            LocationFactory.Add(item.Id.ToString(), StaticDrop.Construct());
                            break;

                        case "2": //Found in a container object
                            LocationFactory.Add(item.Id.ToString(), ContainerItem.Construct());
                            break;

                        case "3": //Found in a container item
                            LocationFactory.Add(item.Id.ToString(), ContainerItem.Construct());
                            break;
                        
                        case "5": //Rewarded from a quest...
                            LocationFactory.Add(item.Id.ToString(), QuestItem.Construct());
                            break;

                        case "6": //Crafted by a profession...
                            LocationFactory.Add(item.Id.ToString(), CraftedItem.Construct());
                            break;

                        default:
                            "".ToString();
                            break;
                    }
                    break;

                case "ti":      // NPC ID that drops/gives... We use the name, so ignoring this
                    ItemLocation questName = item.LocationInfo[0];
                    if (questName is QuestItem)
                    {
                        WebRequestWrapper wrw = new WebRequestWrapper();
                        string questItem = wrw.DownloadQuestWowhead(value);
                        if (questItem != null && !questItem.Contains("This quest doesn't exist or is not yet in the database."))
                        {
                            int levelStart = questItem.IndexOf("<div>Required level: ") + 21;
                            if (levelStart == 20)
                            {
                                levelStart = questItem.IndexOf("<div>Requires level ") + 20;
                            }
                            if (levelStart > 19)
                            {
                                int levelEnd = questItem.IndexOf("</div>", levelStart);
                                string level = questItem.Substring(levelStart, levelEnd - levelStart);
                                if (level == "??")
                                {
                                    levelStart = questItem.IndexOf("<div>Level: ") + 12;
                                    levelEnd = questItem.IndexOf("</div>", levelStart);
                                    (questName as QuestItem).MinLevel = int.Parse(questItem.Substring(levelStart, levelEnd - levelStart));
                                }
                                else
                                {
                                    (questName as QuestItem).MinLevel = int.Parse(level);
                                }
                            }

                            int typeStart = questItem.IndexOf("<div>Type: ") + 11;
                            if (typeStart > 10)
                            {
                                int typeEnd = questItem.IndexOf("</div>", typeStart);
                                switch (questItem.Substring(typeStart, typeEnd - typeStart))
                                {
                                    case "Group":
                                        int partyStart = questItem.IndexOf("Suggested Players [") + 19;
                                        if (partyStart > 18)
                                        {
                                            int partyEnd = questItem.IndexOf("]", partyStart);
                                            (questName as QuestItem).Party = int.Parse(questItem.Substring(partyStart, partyEnd - partyStart));
                                        }
                                        break;

                                    case "Dungeon": (questName as QuestItem).Type = "d"; break;
                                    case "Raid": (questName as QuestItem).Type = "r"; break;
                                    default: (questName as QuestItem).Type = ""; break;
                                }
                            }
                        }
                    }
                    break;

                case "n":       // NPC 'Name'
                    ItemLocation locationName = item.LocationInfo[0];
                    if (locationName is StaticDrop)	(locationName as StaticDrop).Boss = value;
                    if (locationName is ContainerItem) (locationName as ContainerItem).Container = value;
                    if (locationName is QuestItem) (locationName as QuestItem).Quest = value;
                    if (locationName is CraftedItem) (locationName as CraftedItem).SpellName = value;
                    break;

                case "z":       // Zone
                    string zonename = GetZoneName(value);
                    ItemLocation locationZone = item.LocationInfo[0];
                    if (locationZone is StaticDrop) (locationZone as StaticDrop).Area = zonename;
                    else if (locationZone is ContainerItem) (locationZone as ContainerItem).Area = zonename;
                    else if (locationZone is QuestItem) (locationZone as QuestItem).Area = zonename;
                    else if (locationZone is CraftedItem) (locationZone as CraftedItem).Skill = value;
                    else if (locationZone is WorldDrop) (locationZone as WorldDrop).Location = zonename;
                    break;

                case "c": //Zone again, used for quests
                    string continentname = GetZoneName(value);
                    ItemLocation locationContinent = item.LocationInfo[0];
                    if (locationContinent is StaticDrop) (locationContinent as StaticDrop).Area = continentname;
                    else if (locationContinent is ContainerItem) (locationContinent as ContainerItem).Area = continentname;
                    else if (locationContinent is QuestItem) (locationContinent as QuestItem).Area = continentname;
                    break;

                case "c2": //Don't care about continent
                    break;

                case "dd":      // Dungeon Difficulty 
                    // -1 = Normal Dungeon,  -2 = Heroic Dungeon
                    //  1 = Normal Raid (10), 2 = Normal Raid (25)
                    //  3 = Heroic Raid (10), 4 = Heroic Raid (25)
                    //hasdd = true;
                    //ddheroic = (value == "-2" || value == "3" || value == "4");
                    //ddarea = (value == "1" || value == "3" ) ? " (10)" :
                    //	( (value == "2" || value == "4") ? " (25)" : string.Empty  );
                    break;

                case "s":
                    if (item.LocationInfo[0] is CraftedItem)
                    {
                        string profession = "";
                        switch (Properties.GeneralSettings.Default.Locale)
                        {
                            case "fr":
                                switch (value)
                                {
                                    case "171": profession = "Alchimie"; break;
                                    case "164": profession = "Forge"; break;
                                    case "333": profession = "Enchantement"; break;
                                    case "202": profession = "Ingénierie"; break;
                                    case "182": profession = "Herboristerie"; break;
                                    case "773": profession = "Calligraphie"; break;
                                    case "755": profession = "Joaillerie"; break;
                                    case "165": profession = "Travail du cuir"; break;
                                    case "186": profession = "Minage"; break;
                                    case "393": profession = "Dépeçage"; break;
                                    case "197": profession = "Couture"; break;

                                    default:
                                        "".ToString();
                                        break;
                                }
                                break;

                            default:
                        switch (value)
                        {
                            case "171": profession = "Alchemy"; break;
                            case "164": profession = "Blacksmithing"; break;
                            case "333": profession = "Enchanting"; break;
                            case "202": profession = "Engineering"; break;
                            case "182": profession = "Herbalism"; break;
                            case "773": profession = "Inscription"; break;
                            case "755": profession = "Jewelcrafting"; break;
                            case "165": profession = "Leatherworking"; break;
                            case "186": profession = "Mining"; break;
                            case "393": profession = "Skinning"; break;
                            case "197": profession = "Tailoring"; break;

                            default:
                                "".ToString();
                                break;
                        }
                                break;
                        }
                        if (!string.IsNullOrEmpty(profession)) (item.LocationInfo[0] as CraftedItem).Skill = profession;
                    }
                    "".ToString();
                    break;

                case "q":
                    "".ToString();
                    break;

                case "p": //PvP
                    LocationFactory.Add(item.Id.ToString(), PvpItem.Construct());
                    (item.LocationInfo[0] as PvpItem).Points = 0;
                    (item.LocationInfo[0] as PvpItem).PointType = "PvP";
                    "".ToString();
                    break;
                #endregion

                default:
                    if (!_unhandledKeys.Contains(key))
                        _unhandledKeys.Add(key);
                    break;
            }
            return false;
        }

        private static string GetZoneName(string zoneId)
        {
            switch (Properties.GeneralSettings.Default.Locale)
            {
                #region French Translations
                case "fr": {
                    switch (zoneId) {
                        case "65": return "Désolation des dragons";
                        case "66": return "Zul'Drak";
                        case "67": return "Les pics Foudroyés";
                        case "206": return "Donjon d'Utgarde";
                        case "210": return "La Couronne de glace";
                        case "394": return "Les Grisonnes";
                        case "495": return "Fjord Hurlant";
                        case "1196": return "Cime d'Utgarde";
                        case "2817": return "Forêt du Chant de cristal";
                        case "2917": return "Hall of Legends"; // Can't find the translation.
                        case "2918": return "Champion's Hall"; // Can't find the translation.
                        case "3456": return "Naxxramas";
                        case "3477": return "Azjol-Nérub";
                        case "3537": return "Toundra Boréenne";
                        case "3711": return "Bassin de Sholazar";
                        case "4100": return "L'Épuration de Stratholme";
                        case "4120": return "Le Nexus";
                        case "4196": return "Donjon de Drak'Tharon";
                        case "4197": return "Joug-d'hiver";
                        case "4228": return "L'Oculus";
                        case "4264": return "Les salles de Pierre";
                        case "4272": return "Les salles de Foudre";
                        case "4298": return "l'enclave Écarlate";
                        case "4375": return "Gundrak";
                        case "4395": return "Dalaran";
                        case "4415": return "Le fort Pourpre";
                        case "4493": return "Le sanctum Obsidien";
                        case "4494": return "Ahn'kahet";
                        case "4500": return "L'Œil de l'éternité";
                        case "4603": return "Caveau d'Archavon";
                        case "3520": return "Vallée d'Ombrelune";
                        case "4075": return "Plateau du Puits de soleil";
                        case "3959": return "Temple noir";
                        case "3606": return "Sommet d'Hyjal";
                        case "3607": return "Caverne du sanctuaire du Serpent";
                        case "3618": return "Repaire de Gruul";
                        case "3836": return "Le repaire de Magtheridon";
                        case "2562": return "Karazhan";
                        case "3842": return "L'Oeil";
                        case "3805": return "Zul'Aman";
                        case "4273": return "Ulduar";
                        default: return "Inconnue - " + zoneId;
                    }
                }
                #endregion
                default: {
                    switch (zoneId)
                    {
                        #region Old World
                        case "-364": return "Darkmoon Faire";
                        case "12": return "Elwynn Forest";
                        case "38": return "Loch Modan";
                        case "40": return "Westfall";
                        case "133": return "Gnomeregan";
                        case "209": return "Shadowfang Keep";
                        case "491": return "Razorfen Kraul";
                        case "717": return "The Stockade";
                        case "718": return "Wailing Caverns";
                        case "719": return "Blackfathom Deeps";
                        case "722": return "Razorfen Downs";
                        case "796": return "Scarlet Monastery";
                        case "978": return "Zul'Farrak";
                        case "1337": return "Uldaman";
                        case "1417": return "Sunken Temple";
                        case "1519": return "Stormwind City";
                        case "1581": return "The Deadmines";
                        case "1583": return "Blackrock Spire";
                        case "1584": return "Blackrock Depths";
                        case "2017": return "Stratholme";
                        case "2057": return "Scholomance";
                        case "2100": return "Maraudon";
                        case "2159": return "Onyxia's Lair";
                        case "2437": return "Ragefire Chasm";
                        case "2557": return "Dire Maul";
                        case "2597": return "Alterac Valley";
                        case "2677": return "Blackwing Lair";
                        case "2918": return "Champion's Hall";
                        #endregion
                        #region TBC
                        case "2366": return "The Black Morass";
                        case "2367": return "Old Hillsbrad Foothills";
                        case "2562": return "Karazhan";
                        case "3520": return "Shadowmoon Valley";
                        case "3523": return "Netherstorm";
                        case "3562": return "Hellfire Ramparts";
                        case "3606": return "Hyjal Summit";
                        case "3607": return "Serpentshrine Cavern";
                        case "3618": return "Gruul's Lair";
                        case "3703": return "Shattrath City";
                        case "3713": return "The Blood Furnace";
                        case "3714": return "The Shattered Halls";
                        case "3715": return "The Steamvault";
                        case "3716": return "The Underbog";
                        case "3717": return "The Slave Pens";
                        case "3789": return "Shadow Labyrinth";
                        case "3790": return "Auchenai Crypts";
                        case "3791": return "Sethekk Halls";
                        case "3792": return "Mana-Tombs";
                        case "3805": return "Zul'Aman";
                        case "3836": return "Magtheridon's Lair";
                        case "3842": return "The Eye";
                        case "3846": return "The Arcatraz";
                        case "3847": return "The Botanica";
                        case "3849": return "The Mechanar";
                        case "3959": return "Black Temple";
                        case "4075": return "Sunwell Plateau";
                        case "4080": return "Isle of Quel'Danas";
                        case "4095": return "Magisters' Terrace";
                        #endregion
                        #region WotLK
                        case "65": return "Dragonblight";
                        case "66": return "Zul'Drak";
                        case "67": return "The Storm Peaks";
                        case "206": return "Utgarde Keep";
                        case "210": return "Icecrown";
                        case "394": return "Grizzly Hills";
                        case "495": return "Howling Fjord";
                        case "1196": return "Utgarde Pinnacle";
                        case "2817": return "Crystalsong Forest";
                        case "2917": return "Hall of Legends";
                        case "3456": return "Naxxramas";
                        case "3477": return "Azjol-Nerub";
                        case "3537": return "Borean Tundra";
                        case "3711": return "Sholazar Basin";
                        case "4100": return "The Culling of Stratholme";
                        case "4120": return "The Nexus";
                        case "4196": return "Drak'Tharon Keep";
                        case "4197": return "Wintergrasp";
                        case "4228": return "The Oculus";
                        case "4264": return "Halls of Stone";
                        case "4272": return "Halls of Lightning";
                        case "4273": return "Ulduar";
                        case "4298": return "The Scarlet Enclave";
                        case "4375": return "Gundrak";
                        case "4395": return "Dalaran";
                        case "4415": return "The Violet Hold";
                        case "4493": return "The Obsidian Sanctum";
                        case "4494": return "Ahn'kahet: The Old Kingdom";
                        case "4500": return "The Eye of Eternity";
                        case "4603": return "Vault of Archavon";
                        case "4722": return "Trial of the Crusader";
                        case "4723": return "Trial of the Champion";
                        case "4809": return "Forge of Souls";
                        case "4812": return "Icecrown Citadel";
                        case "4813": return "Pit of Saron";
                        case "4820": return "Halls of Reflection";
                        case "4987": return "Ruby Sanctum";
                        #endregion
                        default: return "Unknown - " + zoneId;
                    }
                }
            }
        }

        private static ItemSlot GetSocketType(string socket)
        {
            switch (socket)
            {
                case "1":
                    return ItemSlot.Meta;
                case "2":
                    return ItemSlot.Red;
                case "4":
                    return ItemSlot.Yellow;
                case "6":
                    return ItemSlot.Orange;
                case "8":
                    return ItemSlot.Blue;
                case "10":
                    return ItemSlot.Purple;
                case "12":
                    return ItemSlot.Green;
                case "14":
                    return ItemSlot.Prismatic;
                default:
                    throw( new Exception("Unknown Slot Type :" + socket));
            }
        }

        private static Stats GetSocketBonus(string socketbonus)
        {
            Stats stats = new Stats();
            switch (socketbonus)
            {
                #region Spell Power
                case "2900": stats.SpellPower += 4; break;
                case "2872":
                case "2889": 
                case "3198": 
                case "3596":
                case "3752": stats.SpellPower += 5; break;
                case  "428":
                case "2770": 
                case "3602": stats.SpellPower += 7; break;
                case  "430": 
                case  "440": 
                case "2314": 
                case "3753": stats.SpellPower += 9; break;
                #endregion
                #region Attack Power
                case "3114": stats.AttackPower += 4; break;
                case "2936": stats.AttackPower += 8; break;
                case "1587": 
                case "3356":
                case "3764": stats.AttackPower += 12; break; 
                case "3877":
                case "1589": stats.AttackPower += 16; break;
                case "1597": stats.AttackPower += 32; break;
                #endregion
                #region Stamina
                case "2895": stats.Stamina += 4; break;
                case "2868": 
                case "2882": stats.Stamina += 6; break;
                case "1886": 
                case "3307": stats.Stamina += 9; break;
                case "3354": 
                case "3305": 
                case "3766": stats.Stamina += 12; break;
                #endregion
                #region Mp5
                case "2367":
                case "2865": 
                case "3306": stats.Mp5 += 2; break;
                case "2370": 
                case "2854": stats.Mp5 += 3; break;
                case "2371": stats.Mp5 += 4; break;
                #endregion
                #region Hit Rating
                case "2873": 
                case "2908": stats.HitRating += 4; break;
                case "3351": stats.HitRating += 6; break;
                case "2767": 
                case "2844": stats.HitRating += 8; break;
                #endregion
                #region Crit Rating
                case "2887":
                case "3204": stats.CritRating += 3; break;
                case "2864": 
                case "2874": 
                case "2951": 
                case "2952": 
                case "3263": stats.CritRating += 4; break;
                case "3301": 
                case "3316": stats.CritRating += 6; break;
                case "2771": 
                case "2787": 
                case "2843": 
                case "3314": stats.CritRating += 8; break;
                #endregion
                #region Spirit
                case "2890": stats.Spirit += 4; break;
                case "3311": stats.Spirit += 6; break;
                case "2842": 
                case "3352": stats.Spirit += 8; break;
                #endregion
                #region Intellect
                case "2869": stats.Intellect += 4; break;
                case "3310": stats.Intellect += 6; break;
                case "3353": stats.Intellect += 8; break;
                #endregion
                #region Dodge Rating
                case "2871": stats.DodgeRating += 4; break;
                case "3358": stats.DodgeRating += 6; break;
                case "3304": stats.DodgeRating += 8; break;
                #endregion
                #region Agility
                case "3149": stats.Agility += 2; break;
                case "2877": stats.Agility += 4; break;
                case "3355": stats.Agility += 6; break;
                case "3313": stats.Agility += 8; break;
                #endregion
                #region Resilience
                case "2878": stats.Resilience += 4; break;
                case "3600": stats.Resilience += 6; break;
                case "3821": stats.Resilience += 8; break;
                #endregion
                #region Strength
                case "2892": stats.Strength += 4; break;
                case "2927": stats.Strength += 4; break;
                case "3312": stats.Strength += 8; break;
                case "3357": stats.Strength += 6; break;
                #endregion
                #region Block Rating
                case "2972": stats.BlockRating += 4; break;
                case "3361": stats.BlockRating += 6; break;
                #endregion
                #region Block Value
                case "2888": stats.BlockValue += 6; break;
                case "3363": stats.BlockValue += 9; break;
                #endregion
                #region Defense Rating
                case "2932": stats.DefenseRating += 4; break;
                case "3751":
                case "3857": stats.DefenseRating += 6; break;
                case "3302": stats.DefenseRating += 8; break;
                #endregion
                #region Haste Rating
                case "3267": 
                case "3308": stats.HasteRating += 4; break;
                case "3309": stats.HasteRating += 6; break;
                case "2963": 
                case "3303": stats.HasteRating += 8; break;
                #endregion
                #region Expertise Rating
                case "3094": stats.ExpertiseRating += 4; break;
                case "3362": stats.ExpertiseRating += 6; break;
                case "3778": stats.ExpertiseRating += 8; break;
                #endregion
                #region Parry Rating
                case "3359": stats.ParryRating += 4; break;
                case "3871": stats.ParryRating += 6; break;
                case "3360": stats.ParryRating += 8; break;
                #endregion
                #region ArP Rating
                case "3765":
                case "3880": stats.ArmorPenetrationRating += 4; break;
                case "3882": stats.ArmorPenetrationRating += 8; break;
                #endregion
                default:
                    if (!_unhandledSocketBonus.Contains(socketbonus))
                        _unhandledSocketBonus.Add(socketbonus);
                    break;
            }
            return stats;
        }

        private static ItemType GetItemType(string classSubclass)
        {
            switch (classSubclass)
            {
                case "4.1":
                    return ItemType.Cloth;

                case "4.2":
                    return ItemType.Leather;

                case "4.3":
                    return ItemType.Mail;

                case "4.4":
                    return ItemType.Plate;

                case "2.15":
                    return ItemType.Dagger;

                case "2.13":
                    return ItemType.FistWeapon;

                case "2.1":
                    return ItemType.TwoHandAxe;
                
                case "2.0":
                    return ItemType.OneHandAxe;

                case "2.5":
                    return ItemType.TwoHandMace;

                case "2.4":
                    return ItemType.OneHandMace;

                case "2.8":
                    return ItemType.TwoHandSword;
    
                case "2.7":
                    return ItemType.OneHandSword;

                case "2.6":
                    return ItemType.Polearm;

                case "2.10":
                    return ItemType.Staff;

                case "4.6":
                    return ItemType.Shield;

                case "2.2":
                    return ItemType.Bow;

                case "2.18":
                    return ItemType.Crossbow;

                case "2.3":
                    return ItemType.Gun;

                case "2.19":
                    return ItemType.Wand;

                case "2.16":
                    return ItemType.Thrown;

                case "4.8":
                    return ItemType.Idol;

                case "4.7":
                    return ItemType.Libram;

                case "4.9":
                    return ItemType.Totem;

                case "6.2":
                    return ItemType.Arrow;

                case "6.3":
                    return ItemType.Bullet;

                case "11.2":
                    return ItemType.Quiver;

                case "11.3":
                    return ItemType.AmmoPouch;

                case "4.10":
                    return ItemType.Sigil;

                default:
                    return ItemType.None;
            }
        }

        private static ItemSlot GetItemSlot(int slotId)
        {
            switch (slotId)
            {
                case 1:
                    return ItemSlot.Head;

                case 2:
                    return ItemSlot.Neck;

                case 3:
                    return ItemSlot.Shoulders;

                case 16:
                    return ItemSlot.Back;

                case 5:
                case 20:
                    return ItemSlot.Chest;

                case 4:
                    return ItemSlot.Shirt;

                case 19:
                    return ItemSlot.Tabard;

                case 9:
                    return ItemSlot.Wrist;

                case 10:
                    return ItemSlot.Hands;

                case 6:
                    return ItemSlot.Waist;

                case 7:
                    return ItemSlot.Legs;

                case 8:
                    return ItemSlot.Feet;

                case 11:
                    return ItemSlot.Finger;

                case 12:
                    return ItemSlot.Trinket;

                case 13:
                    return ItemSlot.OneHand;

                case 17:
                    return ItemSlot.TwoHand;

                case 21:
                    return ItemSlot.MainHand;

                case 14:
                case 22:
                case 23:
                    return ItemSlot.OffHand;

                case 15:
                case 25:
                case 26:
                case 28:
                    return ItemSlot.Ranged;

                case 24:
                    return ItemSlot.Projectile;

                case 18:
                case 27:
                    return ItemSlot.ProjectileBag;

                default:
                    return ItemSlot.None;
            }
        }

        private static string[] GetItemFactionVendorInfo(string repReqdId, string repReqdLevel) {
            string[] retVal = new string[] { "Unknown Faction", "Unknown Vendor", "Unknown Zone", "Unknown Level" };

            switch (repReqdId) {
                case "1037": retVal[0] = "Alliance Vanguard"; retVal[1] = ""; retVal[2] = ""; break;
                case "1106": retVal[0] = "Argent Crusade"; retVal[1] = ""; retVal[2] = ""; break;
                case  "529": retVal[0] = "Argent Dawn"; retVal[1] = ""; retVal[2] = ""; break;
                case "1012": retVal[0] = "Ashtongue Deathsworn"; retVal[1] = ""; retVal[2] = ""; break;
                case   "87": retVal[0] = "Bloodsail Buccaneers"; retVal[1] = ""; retVal[2] = ""; break;
                case   "21": retVal[0] = "Booty Bay"; retVal[1] = ""; retVal[2] = ""; break;
                case  "910": retVal[0] = "Brood of Nozdormu"; retVal[1] = ""; retVal[2] = ""; break;
                case  "609": retVal[0] = "Cenarion Circle"; retVal[1] = ""; retVal[2] = ""; break;
                case  "942": retVal[0] = "Cenarion Expedition"; retVal[1] = ""; retVal[2] = ""; break;
                case  "909": retVal[0] = "Darkmoon Faire"; retVal[1] = ""; retVal[2] = ""; break;
                case  "530": retVal[0] = "Darkspear Trolls"; retVal[1] = ""; retVal[2] = ""; break;
                case   "69": retVal[0] = "Darnassus"; retVal[1] = ""; retVal[2] = ""; break;
                case  "577": retVal[0] = "Everlook"; retVal[1] = ""; retVal[2] = ""; break;
                case  "930": retVal[0] = "Exodar"; retVal[1] = ""; retVal[2] = ""; break;
                case "1068": retVal[0] = "Explorers' League"; retVal[1] = ""; retVal[2] = ""; break;
                case "1104": retVal[0] = "Frenzyheart Tribe"; retVal[1] = ""; retVal[2] = ""; break;
                case  "729": retVal[0] = "Frostwolf Clan"; retVal[1] = ""; retVal[2] = ""; break;
                case  "369": retVal[0] = "Gadgetzan"; retVal[1] = ""; retVal[2] = ""; break;
                case   "92": retVal[0] = "Gelkis Clan Centaur"; retVal[1] = ""; retVal[2] = ""; break;
                case   "54": retVal[0] = "Gnomeregan Exiles"; retVal[1] = ""; retVal[2] = ""; break;
                case  "946": retVal[0] = "Honor Hold"; retVal[1] = ""; retVal[2] = ""; break;
                case "1052": retVal[0] = "Horde Expedition"; retVal[1] = ""; retVal[2] = ""; break;
                case  "749": retVal[0] = "Hydraxian Waterlords"; retVal[1] = ""; retVal[2] = ""; break;
                case   "47": retVal[0] = "Ironforge"; retVal[1] = ""; retVal[2] = ""; break;
                case  "989": retVal[0] = "Keepers of Time"; retVal[1] = ""; retVal[2] = ""; break;
                case "1090": retVal[0] = "Kirin Tor"; retVal[1] = ""; retVal[2] = ""; break;
                case "1098": retVal[0] = "Knights of the Ebon Blade"; retVal[1] = ""; retVal[2] = ""; break;
                case  "978": retVal[0] = "Kurenai"; retVal[1] = ""; retVal[2] = ""; break;
                case "1011": retVal[0] = "Lower City"; retVal[1] = ""; retVal[2] = ""; break;
                case   "93": retVal[0] = "Magram Clan Centaur"; retVal[1] = ""; retVal[2] = ""; break;
                case "1015": retVal[0] = "Netherwing"; retVal[1] = ""; retVal[2] = ""; break;
                case "1038": retVal[0] = "Ogri'la"; retVal[1] = ""; retVal[2] = ""; break;
                case   "76": retVal[0] = "Orgrimmar"; retVal[1] = ""; retVal[2] = ""; break;
                case  "470": retVal[0] = "Ratchet"; retVal[1] = ""; retVal[2] = ""; break;
                case  "349": retVal[0] = "Ravenholdt"; retVal[1] = ""; retVal[2] = ""; break;
                case "1031": retVal[0] = "Sha'tari Skyguard"; retVal[1] = ""; retVal[2] = ""; break;
                case "1077": retVal[0] = "Shattered Sun Offensive"; retVal[1] = ""; retVal[2] = ""; break;
                case  "809": retVal[0] = "Shen'dralar"; retVal[1] = ""; retVal[2] = ""; break;
                case  "911": retVal[0] = "Silvermoon City"; retVal[1] = ""; retVal[2] = ""; break;
                case  "890": retVal[0] = "Silverwing Sentinels"; retVal[1] = ""; retVal[2] = ""; break;
                case  "970": retVal[0] = "Sporeggar"; retVal[1] = ""; retVal[2] = ""; break;
                case  "730": retVal[0] = "Stormpike Guard"; retVal[1] = ""; retVal[2] = ""; break;
                case   "72": retVal[0] = "Stormwind"; retVal[1] = ""; retVal[2] = ""; break;
                case   "70": retVal[0] = "Syndicate"; retVal[1] = ""; retVal[2] = ""; break;
                case  "932": retVal[0] = "The Aldor"; retVal[1] = ""; retVal[2] = ""; break;
                case "1156": retVal[0] = "The Ashen Verdict"; retVal[1] = ""; retVal[2] = ""; break;
                case  "933": retVal[0] = "The Consortium"; retVal[1] = ""; retVal[2] = ""; break;
                case  "510": retVal[0] = "The Defilers"; retVal[1] = ""; retVal[2] = ""; break;
                case "1126": retVal[0] = "The Frostborn"; retVal[1] = ""; retVal[2] = ""; break;
                case "1067": retVal[0] = "The Hand of Vengeance"; retVal[1] = ""; retVal[2] = ""; break;
                case "1073": retVal[0] = "The Kalu'ak"; retVal[1] = ""; retVal[2] = ""; break;
                case  "509": retVal[0] = "The League of Arathor"; retVal[1] = ""; retVal[2] = ""; break;
                case  "941": retVal[0] = "The Mag'har"; retVal[1] = ""; retVal[2] = ""; break;
                case "1105": retVal[0] = "The Oracles"; retVal[1] = ""; retVal[2] = ""; break;
                case  "990": retVal[0] = "The Scale of the Sands"; retVal[1] = ""; retVal[2] = ""; break;
                case  "934": retVal[0] = "The Scryers"; retVal[1] = ""; retVal[2] = ""; break;
                case  "935": retVal[0] = "The Sha'tar"; retVal[1] = ""; retVal[2] = ""; break;
                case "1094": retVal[0] = "The Silver Covenant"; retVal[1] = ""; retVal[2] = ""; break;
                case "1119": retVal[0] = "The Sons of Hodir"; retVal[1] = ""; retVal[2] = ""; break;
                case "1124": retVal[0] = "The Sunreavers"; retVal[1] = ""; retVal[2] = ""; break;
                case "1064": retVal[0] = "The Taunka"; retVal[1] = ""; retVal[2] = ""; break;
                case  "967": retVal[0] = "The Violet Eye"; retVal[1] = ""; retVal[2] = ""; break;
                case "1091": retVal[0] = "The Wyrmrest Accord"; retVal[1] = ""; retVal[2] = ""; break;
                case   "59": retVal[0] = "Thorium Brotherhood"; retVal[1] = ""; retVal[2] = ""; break;
                case  "947": retVal[0] = "Thrallmar"; retVal[1] = ""; retVal[2] = ""; break;
                case   "81": retVal[0] = "Thunder Bluff"; retVal[1] = ""; retVal[2] = ""; break;
                case  "576": retVal[0] = "Timbermaw Hold"; retVal[1] = ""; retVal[2] = ""; break;
                case  "922": retVal[0] = "Tranquillien"; retVal[1] = ""; retVal[2] = ""; break;
                case   "68": retVal[0] = "Undercity"; retVal[1] = ""; retVal[2] = ""; break;
                case "1050": retVal[0] = "Valiance Expedition"; retVal[1] = ""; retVal[2] = ""; break;
                case "1085": retVal[0] = "Warsong Offensive"; retVal[1] = ""; retVal[2] = ""; break;
                case  "889": retVal[0] = "Warsong Outriders"; retVal[1] = ""; retVal[2] = ""; break;
                case  "589": retVal[0] = "Wintersaber Trainers"; retVal[1] = ""; retVal[2] = ""; break;
                case  "270": retVal[0] = "Zandalar Tribe"; retVal[1] = ""; retVal[2] = ""; break;
                default: break;
            }
            switch (repReqdLevel) {
                case "4": retVal[3] = "Friendly"; break;
                case "5": retVal[3] = "Honored"; break;
                case "6": retVal[3] = "Revered"; break;
                case "7": retVal[3] = "Exalted"; break;
                default: break;
            }

            if (retVal[0] == "") { retVal[0] = "Unknown Faction"; }
            if (retVal[1] == "") { retVal[1] = "Unknown Vendor"; }
            if (retVal[2] == "") { retVal[2] = "Unknown Zone"; }
            if (retVal[3] == "") { retVal[3] = "0"; }

            return retVal;
        }

        public delegate bool UpgradeCancelCheck();

        public static void LoadUpgradesFromWowhead(Character character, CharacterSlot slot, UpgradeCancelCheck cancel )
        {
            if (!string.IsNullOrEmpty(character.Name))
            {
                WebRequestWrapper.ResetFatalErrorIndicator();
                List<ComparisonCalculationBase> gemCalculations = new List<ComparisonCalculationBase>();
                foreach (Item item in ItemCache.AllItems)
                {
                    if (item.Slot == ItemSlot.Blue || item.Slot == ItemSlot.Green || item.Slot == ItemSlot.Meta
                         || item.Slot == ItemSlot.Orange || item.Slot == ItemSlot.Prismatic || item.Slot == ItemSlot.Purple
                         || item.Slot == ItemSlot.Red || item.Slot == ItemSlot.Yellow)
                    {
                        gemCalculations.Add(Calculations.GetItemCalculations(item, character, item.Slot == ItemSlot.Meta ? CharacterSlot.Metas : CharacterSlot.Gems));
                    }
                }

                ComparisonCalculationBase idealRed = null, idealBlue = null, idealYellow = null, idealMeta = null;
                foreach (ComparisonCalculationBase calc in gemCalculations)
                {
                    if (Item.GemMatchesSlot(calc.Item, ItemSlot.Meta) && (idealMeta == null || idealMeta.OverallPoints < calc.OverallPoints))
                        idealMeta = calc;
                    if (Item.GemMatchesSlot(calc.Item, ItemSlot.Red) && (idealRed == null || idealRed.OverallPoints < calc.OverallPoints))
                        idealRed = calc;
                    if (Item.GemMatchesSlot(calc.Item, ItemSlot.Blue) && (idealBlue == null || idealBlue.OverallPoints < calc.OverallPoints))
                        idealBlue = calc;
                    if (Item.GemMatchesSlot(calc.Item, ItemSlot.Yellow) && (idealYellow == null || idealYellow.OverallPoints < calc.OverallPoints))
                        idealYellow = calc;
                }
                Dictionary<ItemSlot, int> idealGems = new Dictionary<ItemSlot, int>();
                idealGems.Add(ItemSlot.Meta, idealMeta == null ? 0 : idealMeta.Item.Id);
                idealGems.Add(ItemSlot.Red, idealRed == null ? 0 : idealRed.Item.Id);
                idealGems.Add(ItemSlot.Blue, idealBlue == null ? 0 : idealBlue.Item.Id);
                idealGems.Add(ItemSlot.Yellow, idealYellow == null ? 0 : idealYellow.Item.Id);
                idealGems.Add(ItemSlot.None, 0);

                #region status queuing

                if (slot != CharacterSlot.None)
                {
                    StatusMessaging.UpdateStatus(slot.ToString(), "Queued");
                }
                else
                {
                StatusMessaging.UpdateStatus(CharacterSlot.Head.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Neck.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Shoulders.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Back.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Chest.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Wrist.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Hands.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Waist.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Legs.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Feet.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Finger1.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Finger2.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Trinket1.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Trinket2.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.MainHand.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.OffHand.ToString(), "Queued");
                StatusMessaging.UpdateStatus(CharacterSlot.Ranged.ToString(), "Queued");
                }

                #endregion

                if (slot != CharacterSlot.None)
                {
                    LoadUpgradesForSlot(character, slot, idealGems, cancel);
                }
                else
                {
                    LoadUpgradesForSlot(character, CharacterSlot.Head, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Neck, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Shoulders, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Back, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Chest, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Wrist, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Hands, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Waist, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Legs, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Feet, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Finger1, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Finger2, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Trinket1, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Trinket2, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.MainHand, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.OffHand, idealGems, cancel);
                    LoadUpgradesForSlot(character, CharacterSlot.Ranged, idealGems, cancel);
                }
            }
            else
            {
                System.Windows.Forms.MessageBox.Show("You need to have a character loaded for Rawr to find Wowhead upgrades.");
            }
        }

        public static void ImportItemsFromWowhead(string filter) 
        {
            WebRequestWrapper.ResetFatalErrorIndicator();

            string docUpgradeSearch = null;
            try
            {
                StatusMessaging.UpdateStatus("ImportWowheadFilter", "Downloading Item List");
                WebRequestWrapper wrw = new WebRequestWrapper();
                docUpgradeSearch = wrw.DownloadUpgradesWowhead(filter);
                if (docUpgradeSearch != null)
                {
                    // at this stage have an HTML doc that has upgrades in a <div class="listview-void"> block
                    // need to get the itemID list out and then load them and add to cache
                    int startpos = docUpgradeSearch.IndexOf("<div class=\"listview-void\">");
                    if (startpos > 1)
                    {
                        int endpos = docUpgradeSearch.IndexOf("</div>", startpos);
                        XmlDocument doc = new XmlDocument();
                        doc.InnerXml = docUpgradeSearch.Substring(startpos, endpos - startpos + 6);
                        XmlNodeList nodeList = doc.SelectNodes("//a/@href");

                        Regex toMatch = new Regex("(\\d{5})");
                        Match match;

                        for (int i = 0; i < nodeList.Count; i++)
                        {
                            StatusMessaging.UpdateStatus("ImportWowheadFilter",
                                string.Format("Downloading definition {0} of {1} items", i, nodeList.Count));
                            //string id = nodeList[i].Value.Substring(7);
                            // This new code will let it find the item id without worrying
                            // about wowhead messing with the specifics of the string
                            match = toMatch.Match(nodeList[i].Value);
                            string id = match.Value;
                            {
                                Item item = GetItem(id, true);
                                if (item != null)
                                {
                                    ItemCache.AddItem(item, false);
                                }
                            }
                        }
                    }
                }
                else
                {
                    StatusMessaging.ReportError("ImportWowheadFilter", null, "No response returned from Wowhead");
                }
            }
            catch (Exception ex)
            {
                StatusMessaging.ReportError("ImportWowheadFilter", ex, "Error interpreting the data returned from Wowhead");
            }
        }

        private static void LoadUpgradesForSlot(Character character, CharacterSlot slot, Dictionary<ItemSlot, int> idealGems, UpgradeCancelCheck cancel )
        {
            if (cancel != null && cancel())
                return;

            string docUpgradeSearch = null;
            try
            {
                StatusMessaging.UpdateStatus(slot.ToString(), "Downloading Upgrade List");
                ItemInstance itemToUpgrade = character[slot];
                if ((object)itemToUpgrade != null)
                {
                    WebRequestWrapper wrw = new WebRequestWrapper();
                    string minLevel = "minle=" + itemToUpgrade.Item.ItemLevel.ToString() + ";";
                    string filter = getWowheadSlotFilter(slot) + minLevel + getWowheadClassFilter(character.Class) + 
                                    getWowheadWeightFilter(character); 
                    docUpgradeSearch = wrw.DownloadUpgradesWowhead(filter);
                    ComparisonCalculationBase currentCalculation = Calculations.GetItemCalculations(itemToUpgrade, character, slot);
                    if (docUpgradeSearch != null)
                    {
                        if (slot.ToString().Equals("Ranged"))
                            Console.WriteLine("Ranged");

                        int startpos = docUpgradeSearch.IndexOf("Listview({") + 9; // Start verschieben um Länge von 'Listview('
                        docUpgradeSearch = docUpgradeSearch.Substring(startpos);

                        int endpos = docUpgradeSearch.IndexOf("});") + 1; // Ende verschieben um Länge von '}'
                        docUpgradeSearch = docUpgradeSearch.Substring(0, endpos);

                        docUpgradeSearch = docUpgradeSearch.Replace("\\", ""); // An dieser Stelle zwar schon brauchbarer JSON Object Code, aber wir holen uns nur das Item Array
                        
                        startpos = docUpgradeSearch.IndexOf("\"data\":[{");

                        if(startpos > 0)
                        {
                            docUpgradeSearch = docUpgradeSearch.Substring(startpos + 7); // Start verschieben um Länge von 'Listview('

                            endpos = docUpgradeSearch.IndexOf("}],") + 2; // Ende verschieben um Länge von '}'
                            docUpgradeSearch = docUpgradeSearch.Substring(0, endpos);

                            if (slot.ToString().Equals("Ranged"))
                                Console.WriteLine(docUpgradeSearch);

                            JArray json = JArray.Parse(docUpgradeSearch);

                            int i = 0;
                            foreach (JObject item in json)
                            {
                                if (cancel != null && cancel())
                                    break;

                                StatusMessaging.UpdateStatus(slot.ToString(), string.Format("Downloading definition {0} of {1} possible upgrades", i, json.Count));
                                string id = (string)item["id"];
                                if (!ItemCache.Instance.ContainsItemId(int.Parse(id)))
                                {
                                    Item idealItem = GetItem(id, true);
                                    if (idealItem != null)
                                    {
                                        ItemInstance idealGemmedItem = new ItemInstance(int.Parse(id), idealGems[idealItem.SocketColor1], idealGems[idealItem.SocketColor2], idealGems[idealItem.SocketColor3], itemToUpgrade.EnchantId);

                                        Item newItem = ItemCache.AddItem(idealItem, false);

                                        // This is calling OnItemsChanged and ItemCache.Add further down the call stack so if we add it to the cache first, 
                                        // then do the compare and remove it if we don't want it, we can avoid that constant event trigger
                                        ComparisonCalculationBase upgradeCalculation = Calculations.GetItemCalculations(idealGemmedItem, character, slot);

                                        if (upgradeCalculation.OverallPoints < (currentCalculation.OverallPoints * .8f))
                                            ItemCache.DeleteItem(newItem, false);
                                    }
                                }

                                i++;
                            }
                        }
                    }
                    else
                    {
                        StatusMessaging.ReportError(slot.ToString(), null, "No response returned from Wowhead");
                    }
                }
                StatusMessaging.UpdateStatusFinished(slot.ToString());
            }
            catch (Exception ex)
            {
                StatusMessaging.ReportError(slot.ToString(), ex, "Error interpreting the data returned from Wowhead");
            }
        }

        public static String GetWowheadWeightedReportURL(Character character)
        {
            return "https://db.rising-gods.de/?items&filter=minrl=" + character.Level + ";" + getWowheadClassFilter(character.Class) + getWowheadWeightFilter(character);
        }

        private static string getWowheadClassFilter(CharacterClass className)
        {
            switch (className)
            {
                case CharacterClass.DeathKnight :
                    return "ub=6;";
                case CharacterClass.Druid :
                    return "ub=11;";
                case CharacterClass.Hunter :
                    return "ub=3;";
                case CharacterClass.Mage :
                    return "ub=8;";
                case CharacterClass.Paladin :
                    return "ub=2;";
                case CharacterClass.Priest :
                    return "ub=5;";
                case CharacterClass.Rogue :
                    return "ub=4;";
                case CharacterClass.Shaman :
                    return "ub=7;";
                case CharacterClass.Warlock :
                    return "ub=9;";
                case CharacterClass.Warrior :
                    return "ub=1;";
            }
            return string.Empty;
        }

        private static string getWowheadSlotFilter(CharacterSlot slot)
        {
            switch (slot)
            {
                case CharacterSlot.Back :
                    return "sl=16;";
                case CharacterSlot.Chest:
                    return "sl=5;";
                case CharacterSlot.Feet:
                    return "sl=8;";
                case CharacterSlot.Finger1:
                case CharacterSlot.Finger2:
                    return "sl=11;";
                case CharacterSlot.Hands:
                    return "sl=10;";
                case CharacterSlot.Head:
                    return "sl=1;";
                case CharacterSlot.Legs:
                    return "sl=7;";
                case CharacterSlot.MainHand:
                    return "sl=21:13:17;";
                case CharacterSlot.Neck:
                    return "sl=2;";
                case CharacterSlot.OffHand:
                    return "sl=13:14:22:23;";
                case CharacterSlot.Ranged:
                    return "sl=15:28:25;";
                case CharacterSlot.Shoulders:
                    return "sl=3;";
                case CharacterSlot.Trinket1:
                case CharacterSlot.Trinket2:
                    return "sl=12;";
                case CharacterSlot.Waist:
                    return "sl=6;";
                case CharacterSlot.Wrist:
                    return "sl=9;";
            }
            return string.Empty;
        }

        private static string getWowheadWeightFilter(Character character)
        {
            StringBuilder wt = new StringBuilder("wt=");
            StringBuilder wtv = new StringBuilder(";wtv=");
            if (character.CurrentModel == "Enhance") // force weapon dps ep value 6 to fix caster weapon display issue
            {
                wt.Append("134:");
                wtv.Append("6:");
            }
            ComparisonCalculationBase[] statValues = CalculationsBase.GetRelativeStatValues(character);
            Array.Sort(statValues, StatValueSorter);
            foreach (ComparisonCalculationBase ccb in statValues)
            {
                string stat = getWowHeadStatID(ccb.Name);
                if (!stat.Equals(string.Empty))
                {
                    wt.Append(stat);
                    wtv.Append(ccb.OverallPoints.ToString("F2", System.Globalization.CultureInfo.InvariantCulture));
                    wt.Append(":");
                    wtv.Append(":");
                }
            }
            if (wt.Equals("wt="))
                return string.Empty;
            else
                return wt.ToString().Substring(0, wt.Length - 1) + wtv.ToString().Substring(0, wtv.Length - 1);   
        }

        private static string getWowHeadStatID(string Name)
        {
            switch (Name)
            {
                case " Strength":  return "20";
                case " Agility":   return "21";
                case " Stamina":   return "22";
                case " Intellect": return "23";
                case " Spirit":    return "24";

                case " Health":    return "115";
                case " Mana":      return "116";
                case " Health per 5 sec": return "60";
                case " Mana per 5 sec":   return "61";

                case " Armor":          return "41";
                case " Defense Rating": return "42";
                case " Block Value":    return "43";
                case " Block Rating":   return "44";
                case " Dodge Rating":   return "45";
                case " Parry Rating":   return "46";
                case " Bonus Armor":    return "109";
                case " Resilience":     return "79";

                case " Attack Power":     return "77";
                case " Spell Power":      return "123";
                case " Expertise Rating": return "117";
                case " Hit Rating":       return "119";
                case " Crit Rating":      return "96";
                case " Haste Rating":     return "103";
                case " Melee Crit":       return "84";

                case " Feral Attack Power":  return "97";
                case " Spell Crit Rating":   return "49";
                case " Spell Arcane Damage": return "52";
                case " Spell Fire Damage":   return "53";
                case " Spell Nature Damage": return "56";
                case " Spell Shadow Damage": return "57";
                case " Armor Penetration Rating": return "114";
            }
            return string.Empty;
        }

        private static int StatValueSorter(ComparisonCalculationBase x, ComparisonCalculationBase y)
        {
            if (x.OverallPoints > y.OverallPoints)
                return -1;
            else if (x.OverallPoints < y.OverallPoints)
                return 1;
            else
                return 0;
        }
    
    }

}
